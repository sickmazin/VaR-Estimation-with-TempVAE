Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_113609
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_113609

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 12
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_113609
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 177.9309 | NLL: 167.6965 | KL: 113.7157
Epoch 0020 | Beta: 0.19 | Loss: 176.0463 | NLL: 156.4016 | KL: 103.3932
Epoch 0030 | Beta: 0.29 | Loss: 166.5851 | NLL: 139.0156 | KL: 95.0673
Epoch 0040 | Beta: 0.39 | Loss: 169.8916 | NLL: 134.8203 | KL: 89.9264
Epoch 0050 | Beta: 0.49 | Loss: 174.5319 | NLL: 131.5312 | KL: 87.7564
Epoch 0060 | Beta: 0.59 | Loss: 180.3442 | NLL: 128.0201 | KL: 88.6848
Epoch 0070 | Beta: 0.69 | Loss: 185.7688 | NLL: 125.7176 | KL: 87.0307
Epoch 0080 | Beta: 0.79 | Loss: 190.6182 | NLL: 124.0130 | KL: 84.3104
Epoch 0090 | Beta: 0.89 | Loss: 195.3572 | NLL: 122.2581 | KL: 82.1338
Epoch 0100 | Beta: 0.99 | Loss: 200.5820 | NLL: 120.3962 | KL: 80.9958
Epoch 0110 | Beta: 1.00 | Loss: 199.6526 | NLL: 116.8455 | KL: 82.8071
Epoch 0120 | Beta: 1.00 | Loss: 193.8665 | NLL: 108.3127 | KL: 85.5539
Epoch 0130 | Beta: 1.00 | Loss: 189.0738 | NLL: 97.6445 | KL: 91.4293
Epoch 0140 | Beta: 1.00 | Loss: 184.9506 | NLL: 93.0013 | KL: 91.9493
Epoch 0150 | Beta: 1.00 | Loss: 183.2191 | NLL: 90.1018 | KL: 93.1173
Epoch 0160 | Beta: 1.00 | Loss: 181.1245 | NLL: 86.9053 | KL: 94.2192
Epoch 0170 | Beta: 1.00 | Loss: 181.1323 | NLL: 86.0915 | KL: 95.0408
Epoch 0180 | Beta: 1.00 | Loss: 180.3852 | NLL: 85.8747 | KL: 94.5105
Epoch 0190 | Beta: 1.00 | Loss: 181.0596 | NLL: 85.2516 | KL: 95.8081
Epoch 0200 | Beta: 1.00 | Loss: 180.7170 | NLL: 83.6724 | KL: 97.0446
Epoch 0210 | Beta: 1.00 | Loss: 181.6323 | NLL: 84.8983 | KL: 96.7340
Epoch 0220 | Beta: 1.00 | Loss: 180.3492 | NLL: 82.8588 | KL: 97.4904
Epoch 0230 | Beta: 1.00 | Loss: 178.5647 | NLL: 81.4189 | KL: 97.1459
Epoch 0240 | Beta: 1.00 | Loss: 177.5858 | NLL: 80.5970 | KL: 96.9888
Epoch 0250 | Beta: 1.00 | Loss: 180.5750 | NLL: 81.5185 | KL: 99.0564
Epoch 0260 | Beta: 1.00 | Loss: 177.2682 | NLL: 79.9806 | KL: 97.2876
Epoch 0270 | Beta: 1.00 | Loss: 178.7874 | NLL: 80.9843 | KL: 97.8032
Epoch 0280 | Beta: 1.00 | Loss: 177.0697 | NLL: 79.1741 | KL: 97.8956
Epoch 0290 | Beta: 1.00 | Loss: 178.9216 | NLL: 79.3523 | KL: 99.5693
Epoch 0300 | Beta: 1.00 | Loss: 178.1515 | NLL: 78.5297 | KL: 99.6218
Epoch 0310 | Beta: 1.00 | Loss: 178.9088 | NLL: 78.8582 | KL: 100.0506
Epoch 0320 | Beta: 1.00 | Loss: 178.0754 | NLL: 78.0481 | KL: 100.0273
Epoch 0330 | Beta: 1.00 | Loss: 180.3317 | NLL: 79.5972 | KL: 100.7345
Epoch 0340 | Beta: 1.00 | Loss: 179.6492 | NLL: 79.2000 | KL: 100.4492
Epoch 0350 | Beta: 1.00 | Loss: 178.7757 | NLL: 78.9829 | KL: 99.7928
Epoch 0360 | Beta: 1.00 | Loss: 178.6801 | NLL: 77.4122 | KL: 101.2680
Epoch 0370 | Beta: 1.00 | Loss: 178.7566 | NLL: 77.7627 | KL: 100.9939
Epoch 0380 | Beta: 1.00 | Loss: 184.4389 | NLL: 78.0671 | KL: 106.3718
Epoch 0390 | Beta: 1.00 | Loss: 178.8910 | NLL: 77.5669 | KL: 101.3241
Epoch 0400 | Beta: 1.00 | Loss: 178.9969 | NLL: 77.4455 | KL: 101.5514
Epoch 0410 | Beta: 1.00 | Loss: 176.5574 | NLL: 74.0094 | KL: 102.5480
Epoch 0420 | Beta: 1.00 | Loss: 180.6632 | NLL: 78.0285 | KL: 102.6348
Epoch 0430 | Beta: 1.00 | Loss: 176.8460 | NLL: 75.2331 | KL: 101.6129
Epoch 0440 | Beta: 1.00 | Loss: 179.8729 | NLL: 77.2257 | KL: 102.6472
Epoch 0450 | Beta: 1.00 | Loss: 182.3567 | NLL: 78.5121 | KL: 103.8447
Epoch 0460 | Beta: 1.00 | Loss: 180.1738 | NLL: 76.5560 | KL: 103.6178
Epoch 0470 | Beta: 1.00 | Loss: 177.8574 | NLL: 74.0513 | KL: 103.8060
Epoch 0480 | Beta: 1.00 | Loss: 176.3303 | NLL: 73.2094 | KL: 103.1210
Epoch 0490 | Beta: 1.00 | Loss: 179.1908 | NLL: 75.4804 | KL: 103.7104
Epoch 0500 | Beta: 1.00 | Loss: 179.8191 | NLL: 76.3658 | KL: 103.4533
Epoch 0510 | Beta: 1.00 | Loss: 179.7293 | NLL: 76.7981 | KL: 102.9311
Epoch 0520 | Beta: 1.00 | Loss: 180.5569 | NLL: 74.8702 | KL: 105.6868
Epoch 0530 | Beta: 1.00 | Loss: 178.9758 | NLL: 76.8124 | KL: 102.1633
Epoch 0540 | Beta: 1.00 | Loss: 178.6054 | NLL: 75.8348 | KL: 102.7706
Epoch 0550 | Beta: 1.00 | Loss: 181.8892 | NLL: 77.9428 | KL: 103.9464
Epoch 0560 | Beta: 1.00 | Loss: 178.2270 | NLL: 73.3913 | KL: 104.8357
Epoch 0570 | Beta: 1.00 | Loss: 181.8755 | NLL: 76.7748 | KL: 105.1007
Epoch 0580 | Beta: 1.00 | Loss: 182.4862 | NLL: 77.9412 | KL: 104.5449
Epoch 0590 | Beta: 1.00 | Loss: 179.1298 | NLL: 74.7716 | KL: 104.3582
Epoch 0600 | Beta: 1.00 | Loss: 179.3252 | NLL: 75.1587 | KL: 104.1666
Epoch 0610 | Beta: 1.00 | Loss: 178.5993 | NLL: 74.8644 | KL: 103.7349
Epoch 0620 | Beta: 1.00 | Loss: 179.5165 | NLL: 75.7048 | KL: 103.8117
Epoch 0630 | Beta: 1.00 | Loss: 178.7373 | NLL: 75.0987 | KL: 103.6386
Epoch 0640 | Beta: 1.00 | Loss: 179.6817 | NLL: 76.9848 | KL: 102.6970
Epoch 0650 | Beta: 1.00 | Loss: 180.1042 | NLL: 75.3440 | KL: 104.7602
Epoch 0660 | Beta: 1.00 | Loss: 179.6625 | NLL: 74.9284 | KL: 104.7341
Epoch 0670 | Beta: 1.00 | Loss: 175.5988 | NLL: 71.7155 | KL: 103.8833
Epoch 0680 | Beta: 1.00 | Loss: 180.0370 | NLL: 75.5577 | KL: 104.4793
Epoch 0690 | Beta: 1.00 | Loss: 178.3534 | NLL: 74.0779 | KL: 104.2755
Epoch 0700 | Beta: 1.00 | Loss: 179.1561 | NLL: 74.4724 | KL: 104.6838
Epoch 0710 | Beta: 1.00 | Loss: 179.9010 | NLL: 76.0263 | KL: 103.8747
Epoch 0720 | Beta: 1.00 | Loss: 177.1713 | NLL: 73.4040 | KL: 103.7673
Epoch 0730 | Beta: 1.00 | Loss: 178.9864 | NLL: 74.9169 | KL: 104.0696
Epoch 0740 | Beta: 1.00 | Loss: 180.7528 | NLL: 75.2819 | KL: 105.4709
Epoch 0750 | Beta: 1.00 | Loss: 176.9576 | NLL: 73.4545 | KL: 103.5030
Epoch 0760 | Beta: 1.00 | Loss: 178.0539 | NLL: 74.2611 | KL: 103.7928
Epoch 0770 | Beta: 1.00 | Loss: 180.9955 | NLL: 76.9271 | KL: 104.0684
Epoch 0780 | Beta: 1.00 | Loss: 181.6110 | NLL: 75.6300 | KL: 105.9810
Epoch 0790 | Beta: 1.00 | Loss: 179.0266 | NLL: 74.5940 | KL: 104.4326
Epoch 0800 | Beta: 1.00 | Loss: 178.0952 | NLL: 72.3654 | KL: 105.7297
Epoch 0810 | Beta: 1.00 | Loss: 178.5813 | NLL: 73.8444 | KL: 104.7369
Epoch 0820 | Beta: 1.00 | Loss: 178.0733 | NLL: 72.8809 | KL: 105.1925
Epoch 0830 | Beta: 1.00 | Loss: 178.1374 | NLL: 74.7209 | KL: 103.4164
Epoch 0840 | Beta: 1.00 | Loss: 178.4164 | NLL: 72.6657 | KL: 105.7506
Epoch 0850 | Beta: 1.00 | Loss: 177.4135 | NLL: 73.6509 | KL: 103.7626
Epoch 0860 | Beta: 1.00 | Loss: 178.1124 | NLL: 73.8298 | KL: 104.2826
Epoch 0870 | Beta: 1.00 | Loss: 178.6958 | NLL: 74.4116 | KL: 104.2841
Epoch 0880 | Beta: 1.00 | Loss: 178.6705 | NLL: 74.6681 | KL: 104.0024
Epoch 0890 | Beta: 1.00 | Loss: 179.2495 | NLL: 74.4596 | KL: 104.7899
Epoch 0900 | Beta: 1.00 | Loss: 178.2425 | NLL: 73.4349 | KL: 104.8076
Epoch 0910 | Beta: 1.00 | Loss: 180.7534 | NLL: 75.5989 | KL: 105.1545
Epoch 0920 | Beta: 1.00 | Loss: 177.8436 | NLL: 72.8653 | KL: 104.9783
Epoch 0930 | Beta: 1.00 | Loss: 177.6153 | NLL: 73.4167 | KL: 104.1986
Epoch 0940 | Beta: 1.00 | Loss: 177.5256 | NLL: 72.5585 | KL: 104.9671
Epoch 0950 | Beta: 1.00 | Loss: 182.6847 | NLL: 77.8554 | KL: 104.8293
Epoch 0960 | Beta: 1.00 | Loss: 179.4173 | NLL: 75.9899 | KL: 103.4274
Epoch 0970 | Beta: 1.00 | Loss: 179.6360 | NLL: 73.5832 | KL: 106.0528
Epoch 0980 | Beta: 1.00 | Loss: 177.9405 | NLL: 74.2528 | KL: 103.6876
Epoch 0990 | Beta: 1.00 | Loss: 179.5655 | NLL: 74.0444 | KL: 105.5210
Epoch 1000 | Beta: 1.00 | Loss: 179.1942 | NLL: 73.3862 | KL: 105.8080
Skipping Correlation Analysis: No active units.

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 30
Frequenza Osservata: 0.0273 (Target: 0.0500)
LR Statistic: 14.1780 | P-Value: 0.0002
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1041, n01=27, n10=27, n11=3
LR Independence: 3.7630 (p-value: 0.0524)
LR Conditional Coverage (CC): 17.9409 | P-Value CC: 0.0001
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_113609/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_123022
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_123022

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 13
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_123022
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 172.6834 | NLL: 159.4704 | KL: 146.8118
Epoch 0020 | Beta: 0.19 | Loss: 181.9628 | NLL: 158.8272 | KL: 121.7664
Epoch 0030 | Beta: 0.29 | Loss: 189.1340 | NLL: 157.0552 | KL: 110.6164
Epoch 0040 | Beta: 0.39 | Loss: 183.3396 | NLL: 139.1294 | KL: 113.3595
Epoch 0050 | Beta: 0.49 | Loss: 188.2014 | NLL: 134.9799 | KL: 108.6154
Epoch 0060 | Beta: 0.59 | Loss: 190.3936 | NLL: 134.7581 | KL: 94.2975
Epoch 0070 | Beta: 0.69 | Loss: 190.7498 | NLL: 134.1596 | KL: 82.0147
Epoch 0080 | Beta: 0.79 | Loss: 196.4969 | NLL: 133.3829 | KL: 79.8912
Epoch 0090 | Beta: 0.89 | Loss: 202.7588 | NLL: 133.5432 | KL: 77.7704
Epoch 0100 | Beta: 0.99 | Loss: 209.1511 | NLL: 134.1570 | KL: 75.7516
Epoch 0110 | Beta: 1.00 | Loss: 207.3516 | NLL: 134.2846 | KL: 73.0670
Epoch 0120 | Beta: 1.00 | Loss: 207.6218 | NLL: 133.4047 | KL: 74.2171
Epoch 0130 | Beta: 1.00 | Loss: 204.8321 | NLL: 133.2203 | KL: 71.6118
Epoch 0140 | Beta: 1.00 | Loss: 204.3344 | NLL: 132.9043 | KL: 71.4301
Epoch 0150 | Beta: 1.00 | Loss: 203.4536 | NLL: 131.8788 | KL: 71.5748
Epoch 0160 | Beta: 1.00 | Loss: 202.6323 | NLL: 131.7911 | KL: 70.8412
Epoch 0170 | Beta: 1.00 | Loss: 202.2699 | NLL: 131.1417 | KL: 71.1282
Epoch 0180 | Beta: 1.00 | Loss: 201.6819 | NLL: 130.2202 | KL: 71.4618
Epoch 0190 | Beta: 1.00 | Loss: 200.4783 | NLL: 129.2777 | KL: 71.2006
Epoch 0200 | Beta: 1.00 | Loss: 199.7615 | NLL: 128.2757 | KL: 71.4858
Epoch 0210 | Beta: 1.00 | Loss: 201.0501 | NLL: 127.4638 | KL: 73.5863
Epoch 0220 | Beta: 1.00 | Loss: 198.1981 | NLL: 125.9292 | KL: 72.2689
Epoch 0230 | Beta: 1.00 | Loss: 196.3846 | NLL: 123.6838 | KL: 72.7008
Epoch 0240 | Beta: 1.00 | Loss: 195.9699 | NLL: 121.2551 | KL: 74.7148
Epoch 0250 | Beta: 1.00 | Loss: 193.7802 | NLL: 117.8389 | KL: 75.9413
Epoch 0260 | Beta: 1.00 | Loss: 192.9684 | NLL: 112.9549 | KL: 80.0134
Epoch 0270 | Beta: 1.00 | Loss: 187.8429 | NLL: 106.7205 | KL: 81.1224
Epoch 0280 | Beta: 1.00 | Loss: 184.0874 | NLL: 99.1642 | KL: 84.9232
Epoch 0290 | Beta: 1.00 | Loss: 180.0390 | NLL: 93.5159 | KL: 86.5232
Epoch 0300 | Beta: 1.00 | Loss: 177.4588 | NLL: 89.4022 | KL: 88.0566
Epoch 0310 | Beta: 1.00 | Loss: 178.2321 | NLL: 89.2943 | KL: 88.9378
Epoch 0320 | Beta: 1.00 | Loss: 177.2669 | NLL: 88.0639 | KL: 89.2031
Epoch 0330 | Beta: 1.00 | Loss: 182.7521 | NLL: 87.8537 | KL: 94.8984
Epoch 0340 | Beta: 1.00 | Loss: 179.5144 | NLL: 89.0234 | KL: 90.4910
Epoch 0350 | Beta: 1.00 | Loss: 178.3197 | NLL: 85.8893 | KL: 92.4304
Epoch 0360 | Beta: 1.00 | Loss: 178.3974 | NLL: 85.4119 | KL: 92.9855
Epoch 0370 | Beta: 1.00 | Loss: 178.4031 | NLL: 86.0041 | KL: 92.3990
Epoch 0380 | Beta: 1.00 | Loss: 177.2834 | NLL: 84.9423 | KL: 92.3411
Epoch 0390 | Beta: 1.00 | Loss: 176.0402 | NLL: 84.0711 | KL: 91.9691
Epoch 0400 | Beta: 1.00 | Loss: 177.8192 | NLL: 85.2640 | KL: 92.5551
Epoch 0410 | Beta: 1.00 | Loss: 178.2142 | NLL: 84.4750 | KL: 93.7392
Epoch 0420 | Beta: 1.00 | Loss: 175.5564 | NLL: 82.6764 | KL: 92.8801
Epoch 0430 | Beta: 1.00 | Loss: 178.8963 | NLL: 86.5765 | KL: 92.3198
Epoch 0440 | Beta: 1.00 | Loss: 178.5414 | NLL: 85.0436 | KL: 93.4978
Epoch 0450 | Beta: 1.00 | Loss: 179.4464 | NLL: 85.4334 | KL: 94.0130
Epoch 0460 | Beta: 1.00 | Loss: 179.1775 | NLL: 85.3431 | KL: 93.8344
Epoch 0470 | Beta: 1.00 | Loss: 177.1379 | NLL: 82.1676 | KL: 94.9702
Epoch 0480 | Beta: 1.00 | Loss: 183.3193 | NLL: 88.0715 | KL: 95.2478
Epoch 0490 | Beta: 1.00 | Loss: 178.0621 | NLL: 83.0321 | KL: 95.0299
Epoch 0500 | Beta: 1.00 | Loss: 180.7850 | NLL: 84.6484 | KL: 96.1366
Epoch 0510 | Beta: 1.00 | Loss: 179.5475 | NLL: 84.7694 | KL: 94.7781
Epoch 0520 | Beta: 1.00 | Loss: 178.4187 | NLL: 83.1284 | KL: 95.2903
Epoch 0530 | Beta: 1.00 | Loss: 180.2660 | NLL: 84.4395 | KL: 95.8265
Epoch 0540 | Beta: 1.00 | Loss: 180.9552 | NLL: 85.8342 | KL: 95.1210
Epoch 0550 | Beta: 1.00 | Loss: 179.2579 | NLL: 82.0906 | KL: 97.1673
Epoch 0560 | Beta: 1.00 | Loss: 177.6635 | NLL: 80.8720 | KL: 96.7915
Epoch 0570 | Beta: 1.00 | Loss: 176.8382 | NLL: 79.7828 | KL: 97.0554
Epoch 0580 | Beta: 1.00 | Loss: 177.1808 | NLL: 80.9448 | KL: 96.2360
Epoch 0590 | Beta: 1.00 | Loss: 178.6759 | NLL: 82.3201 | KL: 96.3558
Epoch 0600 | Beta: 1.00 | Loss: 179.8755 | NLL: 81.6086 | KL: 98.2669
Epoch 0610 | Beta: 1.00 | Loss: 177.0254 | NLL: 79.9460 | KL: 97.0794
Epoch 0620 | Beta: 1.00 | Loss: 178.3507 | NLL: 80.2869 | KL: 98.0637
Epoch 0630 | Beta: 1.00 | Loss: 178.6796 | NLL: 79.6766 | KL: 99.0031
Epoch 0640 | Beta: 1.00 | Loss: 178.0291 | NLL: 79.2575 | KL: 98.7716
Epoch 0650 | Beta: 1.00 | Loss: 175.4012 | NLL: 77.1408 | KL: 98.2605
Epoch 0660 | Beta: 1.00 | Loss: 177.0931 | NLL: 79.4026 | KL: 97.6905
Epoch 0670 | Beta: 1.00 | Loss: 177.2758 | NLL: 79.8500 | KL: 97.4258
Epoch 0680 | Beta: 1.00 | Loss: 178.5072 | NLL: 79.7666 | KL: 98.7406
Epoch 0690 | Beta: 1.00 | Loss: 176.3883 | NLL: 79.0144 | KL: 97.3740
Epoch 0700 | Beta: 1.00 | Loss: 177.7131 | NLL: 78.9712 | KL: 98.7419
Epoch 0710 | Beta: 1.00 | Loss: 177.1719 | NLL: 78.9839 | KL: 98.1880
Epoch 0720 | Beta: 1.00 | Loss: 179.1712 | NLL: 81.5480 | KL: 97.6232
Epoch 0730 | Beta: 1.00 | Loss: 178.8191 | NLL: 80.1659 | KL: 98.6533
Epoch 0740 | Beta: 1.00 | Loss: 177.5695 | NLL: 78.7458 | KL: 98.8238
Epoch 0750 | Beta: 1.00 | Loss: 175.4981 | NLL: 75.5545 | KL: 99.9436
Epoch 0760 | Beta: 1.00 | Loss: 176.3109 | NLL: 77.1284 | KL: 99.1825
Epoch 0770 | Beta: 1.00 | Loss: 182.7285 | NLL: 84.0934 | KL: 98.6351
Epoch 0780 | Beta: 1.00 | Loss: 174.5402 | NLL: 74.9097 | KL: 99.6305
Epoch 0790 | Beta: 1.00 | Loss: 179.3295 | NLL: 78.9324 | KL: 100.3972
Epoch 0800 | Beta: 1.00 | Loss: 176.1641 | NLL: 75.9543 | KL: 100.2099
Epoch 0810 | Beta: 1.00 | Loss: 178.1404 | NLL: 80.0607 | KL: 98.0797
Epoch 0820 | Beta: 1.00 | Loss: 179.6059 | NLL: 79.1403 | KL: 100.4656
Epoch 0830 | Beta: 1.00 | Loss: 178.0627 | NLL: 77.6957 | KL: 100.3670
Epoch 0840 | Beta: 1.00 | Loss: 179.1072 | NLL: 77.6199 | KL: 101.4873
Epoch 0850 | Beta: 1.00 | Loss: 175.0776 | NLL: 76.6775 | KL: 98.4001
Epoch 0860 | Beta: 1.00 | Loss: 180.4624 | NLL: 79.8065 | KL: 100.6559
Epoch 0870 | Beta: 1.00 | Loss: 178.0738 | NLL: 77.6906 | KL: 100.3832
Epoch 0880 | Beta: 1.00 | Loss: 177.7039 | NLL: 76.3123 | KL: 101.3915
Epoch 0890 | Beta: 1.00 | Loss: 176.5585 | NLL: 75.1029 | KL: 101.4556
Epoch 0900 | Beta: 1.00 | Loss: 178.7219 | NLL: 76.9673 | KL: 101.7546
Epoch 0910 | Beta: 1.00 | Loss: 178.7421 | NLL: 76.9715 | KL: 101.7706
Epoch 0920 | Beta: 1.00 | Loss: 177.1695 | NLL: 74.6149 | KL: 102.5546
Epoch 0930 | Beta: 1.00 | Loss: 180.2681 | NLL: 78.6318 | KL: 101.6363
Epoch 0940 | Beta: 1.00 | Loss: 180.9404 | NLL: 77.9893 | KL: 102.9511
Epoch 0950 | Beta: 1.00 | Loss: 177.8988 | NLL: 75.7322 | KL: 102.1666
Epoch 0960 | Beta: 1.00 | Loss: 177.4000 | NLL: 76.0119 | KL: 101.3881
Epoch 0970 | Beta: 1.00 | Loss: 176.6328 | NLL: 75.4007 | KL: 101.2322
Epoch 0980 | Beta: 1.00 | Loss: 181.1709 | NLL: 79.3407 | KL: 101.8302
Epoch 0990 | Beta: 1.00 | Loss: 176.2025 | NLL: 75.3470 | KL: 100.8554
Epoch 1000 | Beta: 1.00 | Loss: 182.0026 | NLL: 79.1921 | KL: 102.8105
Correlation Heatmap saved to paper_plots\run_20260103_123022/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 27
Frequenza Osservata: 0.0246 (Target: 0.0500)
LR Statistic: 18.2700 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1046, n01=25, n10=25, n11=2
LR Independence: 1.8784 (p-value: 0.1705)
LR Conditional Coverage (CC): 20.1483 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_123022/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_132711
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_132711

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 14
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_132711
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 165.5657 | NLL: 158.7348 | KL: 75.8982
Epoch 0020 | Beta: 0.19 | Loss: 158.1696 | NLL: 142.7253 | KL: 81.2857
Epoch 0030 | Beta: 0.29 | Loss: 154.8168 | NLL: 131.7094 | KL: 79.6808
Epoch 0040 | Beta: 0.39 | Loss: 149.7108 | NLL: 114.4961 | KL: 90.2942
Epoch 0050 | Beta: 0.49 | Loss: 147.8997 | NLL: 100.8850 | KL: 95.9486
Epoch 0060 | Beta: 0.59 | Loss: 149.8602 | NLL: 93.7206 | KL: 95.1519
Epoch 0070 | Beta: 0.69 | Loss: 155.0573 | NLL: 89.3805 | KL: 95.1838
Epoch 0080 | Beta: 0.79 | Loss: 162.3417 | NLL: 88.3087 | KL: 93.7127
Epoch 0090 | Beta: 0.89 | Loss: 170.3552 | NLL: 89.1008 | KL: 91.2971
Epoch 0100 | Beta: 0.99 | Loss: 176.7690 | NLL: 87.8038 | KL: 89.8638
Epoch 0110 | Beta: 1.00 | Loss: 177.0008 | NLL: 86.5407 | KL: 90.4602
Epoch 0120 | Beta: 1.00 | Loss: 173.8702 | NLL: 84.3387 | KL: 89.5315
Epoch 0130 | Beta: 1.00 | Loss: 178.3898 | NLL: 88.5802 | KL: 89.8097
Epoch 0140 | Beta: 1.00 | Loss: 173.7885 | NLL: 84.0668 | KL: 89.7217
Epoch 0150 | Beta: 1.00 | Loss: 174.1447 | NLL: 84.5851 | KL: 89.5596
Epoch 0160 | Beta: 1.00 | Loss: 172.0588 | NLL: 83.2493 | KL: 88.8095
Epoch 0170 | Beta: 1.00 | Loss: 173.0736 | NLL: 83.3462 | KL: 89.7274
Epoch 0180 | Beta: 1.00 | Loss: 172.9701 | NLL: 82.2002 | KL: 90.7700
Epoch 0190 | Beta: 1.00 | Loss: 172.5027 | NLL: 82.5727 | KL: 89.9300
Epoch 0200 | Beta: 1.00 | Loss: 171.1902 | NLL: 81.4704 | KL: 89.7197
Epoch 0210 | Beta: 1.00 | Loss: 170.4201 | NLL: 79.8994 | KL: 90.5207
Epoch 0220 | Beta: 1.00 | Loss: 171.1446 | NLL: 80.3633 | KL: 90.7813
Epoch 0230 | Beta: 1.00 | Loss: 169.2839 | NLL: 78.1589 | KL: 91.1250
Epoch 0240 | Beta: 1.00 | Loss: 170.1022 | NLL: 79.2429 | KL: 90.8594
Epoch 0250 | Beta: 1.00 | Loss: 169.8893 | NLL: 79.7224 | KL: 90.1669
Epoch 0260 | Beta: 1.00 | Loss: 169.3082 | NLL: 78.4833 | KL: 90.8249
Epoch 0270 | Beta: 1.00 | Loss: 168.8156 | NLL: 78.4235 | KL: 90.3921
Epoch 0280 | Beta: 1.00 | Loss: 170.1386 | NLL: 79.0372 | KL: 91.1014
Epoch 0290 | Beta: 1.00 | Loss: 171.5191 | NLL: 80.7444 | KL: 90.7748
Epoch 0300 | Beta: 1.00 | Loss: 168.4810 | NLL: 77.5206 | KL: 90.9604
Epoch 0310 | Beta: 1.00 | Loss: 167.5328 | NLL: 77.1058 | KL: 90.4270
Epoch 0320 | Beta: 1.00 | Loss: 166.6763 | NLL: 75.9392 | KL: 90.7370
Epoch 0330 | Beta: 1.00 | Loss: 169.3529 | NLL: 77.6960 | KL: 91.6569
Epoch 0340 | Beta: 1.00 | Loss: 167.7874 | NLL: 75.8162 | KL: 91.9712
Epoch 0350 | Beta: 1.00 | Loss: 168.9517 | NLL: 77.3299 | KL: 91.6218
Epoch 0360 | Beta: 1.00 | Loss: 169.6278 | NLL: 78.6696 | KL: 90.9582
Epoch 0370 | Beta: 1.00 | Loss: 168.9333 | NLL: 78.6987 | KL: 90.2346
Epoch 0380 | Beta: 1.00 | Loss: 167.2995 | NLL: 76.1972 | KL: 91.1023
Epoch 0390 | Beta: 1.00 | Loss: 166.6910 | NLL: 75.5633 | KL: 91.1277
Epoch 0400 | Beta: 1.00 | Loss: 166.9223 | NLL: 75.6415 | KL: 91.2809
Epoch 0410 | Beta: 1.00 | Loss: 168.4407 | NLL: 77.7022 | KL: 90.7385
Epoch 0420 | Beta: 1.00 | Loss: 169.9949 | NLL: 79.8713 | KL: 90.1236
Epoch 0430 | Beta: 1.00 | Loss: 168.1368 | NLL: 78.1037 | KL: 90.0330
Epoch 0440 | Beta: 1.00 | Loss: 165.8555 | NLL: 74.8606 | KL: 90.9949
Epoch 0450 | Beta: 1.00 | Loss: 171.0914 | NLL: 80.6856 | KL: 90.4057
Epoch 0460 | Beta: 1.00 | Loss: 166.4823 | NLL: 75.2938 | KL: 91.1885
Epoch 0470 | Beta: 1.00 | Loss: 167.0216 | NLL: 76.8413 | KL: 90.1803
Epoch 0480 | Beta: 1.00 | Loss: 167.6414 | NLL: 75.9902 | KL: 91.6513
Epoch 0490 | Beta: 1.00 | Loss: 169.7320 | NLL: 78.6001 | KL: 91.1319
Epoch 0500 | Beta: 1.00 | Loss: 168.0690 | NLL: 77.3652 | KL: 90.7038
Epoch 0510 | Beta: 1.00 | Loss: 166.9814 | NLL: 75.8839 | KL: 91.0975
Epoch 0520 | Beta: 1.00 | Loss: 167.5831 | NLL: 76.4196 | KL: 91.1635
Epoch 0530 | Beta: 1.00 | Loss: 168.0199 | NLL: 77.7569 | KL: 90.2630
Epoch 0540 | Beta: 1.00 | Loss: 167.5684 | NLL: 76.5375 | KL: 91.0309
Epoch 0550 | Beta: 1.00 | Loss: 169.1187 | NLL: 77.2351 | KL: 91.8836
Epoch 0560 | Beta: 1.00 | Loss: 168.1363 | NLL: 76.4658 | KL: 91.6705
Epoch 0570 | Beta: 1.00 | Loss: 168.9090 | NLL: 78.4788 | KL: 90.4302
Epoch 0580 | Beta: 1.00 | Loss: 166.9841 | NLL: 76.4497 | KL: 90.5344
Epoch 0590 | Beta: 1.00 | Loss: 168.0861 | NLL: 77.1331 | KL: 90.9529
Epoch 0600 | Beta: 1.00 | Loss: 167.9518 | NLL: 77.3399 | KL: 90.6118
Epoch 0610 | Beta: 1.00 | Loss: 168.3538 | NLL: 77.2635 | KL: 91.0903
Epoch 0620 | Beta: 1.00 | Loss: 168.8785 | NLL: 78.2857 | KL: 90.5928
Epoch 0630 | Beta: 1.00 | Loss: 166.4640 | NLL: 76.1964 | KL: 90.2677
Epoch 0640 | Beta: 1.00 | Loss: 165.6424 | NLL: 75.1162 | KL: 90.5262
Epoch 0650 | Beta: 1.00 | Loss: 165.8729 | NLL: 74.8718 | KL: 91.0010
Epoch 0660 | Beta: 1.00 | Loss: 164.7502 | NLL: 72.6776 | KL: 92.0726
Epoch 0670 | Beta: 1.00 | Loss: 166.0503 | NLL: 75.4124 | KL: 90.6379
Epoch 0680 | Beta: 1.00 | Loss: 165.4209 | NLL: 74.8136 | KL: 90.6073
Epoch 0690 | Beta: 1.00 | Loss: 165.7477 | NLL: 75.3955 | KL: 90.3522
Epoch 0700 | Beta: 1.00 | Loss: 167.7121 | NLL: 78.2417 | KL: 89.4704
Epoch 0710 | Beta: 1.00 | Loss: 167.3674 | NLL: 76.5342 | KL: 90.8331
Epoch 0720 | Beta: 1.00 | Loss: 164.2115 | NLL: 73.7248 | KL: 90.4867
Epoch 0730 | Beta: 1.00 | Loss: 166.5629 | NLL: 76.5632 | KL: 89.9996
Epoch 0740 | Beta: 1.00 | Loss: 165.0082 | NLL: 74.1360 | KL: 90.8723
Epoch 0750 | Beta: 1.00 | Loss: 166.0572 | NLL: 74.8179 | KL: 91.2393
Epoch 0760 | Beta: 1.00 | Loss: 168.1028 | NLL: 76.9128 | KL: 91.1900
Epoch 0770 | Beta: 1.00 | Loss: 167.8310 | NLL: 76.0607 | KL: 91.7703
Epoch 0780 | Beta: 1.00 | Loss: 167.8294 | NLL: 77.4496 | KL: 90.3798
Epoch 0790 | Beta: 1.00 | Loss: 167.5698 | NLL: 77.1679 | KL: 90.4018
Epoch 0800 | Beta: 1.00 | Loss: 166.5600 | NLL: 74.5059 | KL: 92.0542
Epoch 0810 | Beta: 1.00 | Loss: 165.7474 | NLL: 74.8554 | KL: 90.8919
Epoch 0820 | Beta: 1.00 | Loss: 163.9511 | NLL: 72.7502 | KL: 91.2010
Epoch 0830 | Beta: 1.00 | Loss: 163.7429 | NLL: 73.7345 | KL: 90.0085
Epoch 0840 | Beta: 1.00 | Loss: 165.7537 | NLL: 74.6777 | KL: 91.0760
Epoch 0850 | Beta: 1.00 | Loss: 164.8703 | NLL: 74.7093 | KL: 90.1610
Epoch 0860 | Beta: 1.00 | Loss: 165.5861 | NLL: 75.3831 | KL: 90.2030
Epoch 0870 | Beta: 1.00 | Loss: 163.4853 | NLL: 72.2937 | KL: 91.1915
Epoch 0880 | Beta: 1.00 | Loss: 163.8351 | NLL: 72.9706 | KL: 90.8645
Epoch 0890 | Beta: 1.00 | Loss: 161.5618 | NLL: 71.1422 | KL: 90.4196
Epoch 0900 | Beta: 1.00 | Loss: 164.1603 | NLL: 74.7358 | KL: 89.4245
Epoch 0910 | Beta: 1.00 | Loss: 163.7950 | NLL: 74.0248 | KL: 89.7702
Epoch 0920 | Beta: 1.00 | Loss: 161.8743 | NLL: 72.0235 | KL: 89.8509
Epoch 0930 | Beta: 1.00 | Loss: 163.5666 | NLL: 73.5380 | KL: 90.0286
Epoch 0940 | Beta: 1.00 | Loss: 161.8973 | NLL: 72.1109 | KL: 89.7864
Epoch 0950 | Beta: 1.00 | Loss: 163.9415 | NLL: 73.9668 | KL: 89.9747
Epoch 0960 | Beta: 1.00 | Loss: 162.2697 | NLL: 72.1290 | KL: 90.1407
Epoch 0970 | Beta: 1.00 | Loss: 162.3007 | NLL: 71.9635 | KL: 90.3373
Epoch 0980 | Beta: 1.00 | Loss: 164.5618 | NLL: 73.5560 | KL: 91.0058
Epoch 0990 | Beta: 1.00 | Loss: 162.4158 | NLL: 72.9500 | KL: 89.4657
Epoch 1000 | Beta: 1.00 | Loss: 165.8249 | NLL: 75.5329 | KL: 90.2919
Correlation Heatmap saved to paper_plots\run_20260103_132711/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 20
Frequenza Osservata: 0.0182 (Target: 0.0500)
LR Statistic: 30.6295 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1059, n01=19, n10=19, n11=1
LR Independence: 0.7902 (p-value: 0.3741)
LR Conditional Coverage (CC): 31.4196 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_132711/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_142804
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_142804

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 15
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_142804
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 162.1695 | NLL: 156.9863 | KL: 57.5908
Epoch 0020 | Beta: 0.19 | Loss: 142.9456 | NLL: 130.6923 | KL: 64.4914
Epoch 0030 | Beta: 0.29 | Loss: 129.7475 | NLL: 107.0762 | KL: 78.1770
Epoch 0040 | Beta: 0.39 | Loss: 122.9645 | NLL: 90.6564 | KL: 82.8413
Epoch 0050 | Beta: 0.49 | Loss: 124.4837 | NLL: 83.7685 | KL: 83.0923
Epoch 0060 | Beta: 0.59 | Loss: 132.4921 | NLL: 84.3608 | KL: 81.5783
Epoch 0070 | Beta: 0.69 | Loss: 138.2745 | NLL: 83.1489 | KL: 79.8922
Epoch 0080 | Beta: 0.79 | Loss: 144.3998 | NLL: 82.4110 | KL: 78.4669
Epoch 0090 | Beta: 0.89 | Loss: 153.6258 | NLL: 86.0799 | KL: 75.8943
Epoch 0100 | Beta: 0.99 | Loss: 158.1253 | NLL: 85.5376 | KL: 73.3209
Epoch 0110 | Beta: 1.00 | Loss: 160.1220 | NLL: 87.2206 | KL: 72.9014
Epoch 0120 | Beta: 1.00 | Loss: 157.9152 | NLL: 84.7734 | KL: 73.1418
Epoch 0130 | Beta: 1.00 | Loss: 157.8173 | NLL: 84.1505 | KL: 73.6668
Epoch 0140 | Beta: 1.00 | Loss: 156.8830 | NLL: 82.9985 | KL: 73.8845
Epoch 0150 | Beta: 1.00 | Loss: 158.0737 | NLL: 84.8638 | KL: 73.2098
Epoch 0160 | Beta: 1.00 | Loss: 155.2471 | NLL: 81.7819 | KL: 73.4652
Epoch 0170 | Beta: 1.00 | Loss: 155.8600 | NLL: 81.4686 | KL: 74.3913
Epoch 0180 | Beta: 1.00 | Loss: 155.0014 | NLL: 80.0167 | KL: 74.9848
Epoch 0190 | Beta: 1.00 | Loss: 156.0839 | NLL: 81.3951 | KL: 74.6888
Epoch 0200 | Beta: 1.00 | Loss: 154.9074 | NLL: 80.1538 | KL: 74.7535
Epoch 0210 | Beta: 1.00 | Loss: 155.1390 | NLL: 80.2683 | KL: 74.8708
Epoch 0220 | Beta: 1.00 | Loss: 152.8760 | NLL: 77.0402 | KL: 75.8359
Epoch 0230 | Beta: 1.00 | Loss: 152.9150 | NLL: 76.0699 | KL: 76.8451
Epoch 0240 | Beta: 1.00 | Loss: 153.9096 | NLL: 77.6385 | KL: 76.2711
Epoch 0250 | Beta: 1.00 | Loss: 154.9732 | NLL: 79.0632 | KL: 75.9100
Epoch 0260 | Beta: 1.00 | Loss: 151.9106 | NLL: 75.6132 | KL: 76.2974
Epoch 0270 | Beta: 1.00 | Loss: 151.3422 | NLL: 75.3170 | KL: 76.0253
Epoch 0280 | Beta: 1.00 | Loss: 148.8374 | NLL: 72.5250 | KL: 76.3125
Epoch 0290 | Beta: 1.00 | Loss: 151.7322 | NLL: 75.0223 | KL: 76.7099
Epoch 0300 | Beta: 1.00 | Loss: 152.7498 | NLL: 76.6251 | KL: 76.1246
Epoch 0310 | Beta: 1.00 | Loss: 152.5395 | NLL: 76.2019 | KL: 76.3375
Epoch 0320 | Beta: 1.00 | Loss: 153.0294 | NLL: 75.7260 | KL: 77.3034
Epoch 0330 | Beta: 1.00 | Loss: 153.0823 | NLL: 76.9507 | KL: 76.1316
Epoch 0340 | Beta: 1.00 | Loss: 151.3752 | NLL: 74.6692 | KL: 76.7059
Epoch 0350 | Beta: 1.00 | Loss: 149.9159 | NLL: 72.3653 | KL: 77.5506
Epoch 0360 | Beta: 1.00 | Loss: 152.0264 | NLL: 74.8603 | KL: 77.1661
Epoch 0370 | Beta: 1.00 | Loss: 154.2202 | NLL: 76.4698 | KL: 77.7504
Epoch 0380 | Beta: 1.00 | Loss: 167.0903 | NLL: 90.6293 | KL: 76.4610
Epoch 0390 | Beta: 1.00 | Loss: 153.6953 | NLL: 77.6765 | KL: 76.0188
Epoch 0400 | Beta: 1.00 | Loss: 149.6720 | NLL: 72.2853 | KL: 77.3867
Epoch 0410 | Beta: 1.00 | Loss: 151.4087 | NLL: 74.6136 | KL: 76.7951
Epoch 0420 | Beta: 1.00 | Loss: 151.9316 | NLL: 76.1630 | KL: 75.7685
Epoch 0430 | Beta: 1.00 | Loss: 149.9904 | NLL: 73.2103 | KL: 76.7801
Epoch 0440 | Beta: 1.00 | Loss: 148.4688 | NLL: 70.8421 | KL: 77.6266
Epoch 0450 | Beta: 1.00 | Loss: 148.1503 | NLL: 70.2589 | KL: 77.8914
Epoch 0460 | Beta: 1.00 | Loss: 151.2029 | NLL: 73.3074 | KL: 77.8955
Epoch 0470 | Beta: 1.00 | Loss: 151.7742 | NLL: 75.4363 | KL: 76.3379
Epoch 0480 | Beta: 1.00 | Loss: 153.4854 | NLL: 75.1333 | KL: 78.3521
Epoch 0490 | Beta: 1.00 | Loss: 148.7387 | NLL: 71.5607 | KL: 77.1780
Epoch 0500 | Beta: 1.00 | Loss: 150.1547 | NLL: 71.5507 | KL: 78.6040
Epoch 0510 | Beta: 1.00 | Loss: 148.8024 | NLL: 70.9412 | KL: 77.8612
Epoch 0520 | Beta: 1.00 | Loss: 151.6333 | NLL: 73.7977 | KL: 77.8356
Epoch 0530 | Beta: 1.00 | Loss: 157.3161 | NLL: 77.9451 | KL: 79.3711
Epoch 0540 | Beta: 1.00 | Loss: 150.7857 | NLL: 72.6987 | KL: 78.0870
Epoch 0550 | Beta: 1.00 | Loss: 149.8782 | NLL: 71.8849 | KL: 77.9934
Epoch 0560 | Beta: 1.00 | Loss: 149.6026 | NLL: 70.2858 | KL: 79.3167
Epoch 0570 | Beta: 1.00 | Loss: 148.9857 | NLL: 70.0085 | KL: 78.9771
Epoch 0580 | Beta: 1.00 | Loss: 150.4162 | NLL: 71.6074 | KL: 78.8088
Epoch 0590 | Beta: 1.00 | Loss: 153.6348 | NLL: 75.1901 | KL: 78.4447
Epoch 0600 | Beta: 1.00 | Loss: 151.1701 | NLL: 72.9869 | KL: 78.1832
Epoch 0610 | Beta: 1.00 | Loss: 150.0575 | NLL: 72.3824 | KL: 77.6751
Epoch 0620 | Beta: 1.00 | Loss: 149.4414 | NLL: 70.6746 | KL: 78.7668
Epoch 0630 | Beta: 1.00 | Loss: 150.8263 | NLL: 72.4036 | KL: 78.4227
Epoch 0640 | Beta: 1.00 | Loss: 149.9624 | NLL: 71.0503 | KL: 78.9122
Epoch 0650 | Beta: 1.00 | Loss: 148.5854 | NLL: 70.2641 | KL: 78.3213
Epoch 0660 | Beta: 1.00 | Loss: 150.2251 | NLL: 71.0757 | KL: 79.1494
Epoch 0670 | Beta: 1.00 | Loss: 150.0183 | NLL: 72.2154 | KL: 77.8029
Epoch 0680 | Beta: 1.00 | Loss: 149.0325 | NLL: 69.1158 | KL: 79.9167
Epoch 0690 | Beta: 1.00 | Loss: 148.4791 | NLL: 69.2716 | KL: 79.2075
Epoch 0700 | Beta: 1.00 | Loss: 150.9463 | NLL: 72.7706 | KL: 78.1757
Epoch 0710 | Beta: 1.00 | Loss: 151.9399 | NLL: 73.5853 | KL: 78.3546
Epoch 0720 | Beta: 1.00 | Loss: 151.0518 | NLL: 72.1418 | KL: 78.9100
Epoch 0730 | Beta: 1.00 | Loss: 151.8773 | NLL: 73.5661 | KL: 78.3112
Epoch 0740 | Beta: 1.00 | Loss: 149.3490 | NLL: 70.1203 | KL: 79.2286
Epoch 0750 | Beta: 1.00 | Loss: 150.2232 | NLL: 71.0629 | KL: 79.1603
Epoch 0760 | Beta: 1.00 | Loss: 150.2078 | NLL: 70.2568 | KL: 79.9510
Epoch 0770 | Beta: 1.00 | Loss: 148.3427 | NLL: 68.9656 | KL: 79.3771
Epoch 0780 | Beta: 1.00 | Loss: 150.0495 | NLL: 71.0305 | KL: 79.0191
Epoch 0790 | Beta: 1.00 | Loss: 150.0547 | NLL: 70.9963 | KL: 79.0584
Epoch 0800 | Beta: 1.00 | Loss: 148.2841 | NLL: 68.4303 | KL: 79.8538
Epoch 0810 | Beta: 1.00 | Loss: 149.1995 | NLL: 68.7415 | KL: 80.4579
Epoch 0820 | Beta: 1.00 | Loss: 149.1492 | NLL: 68.0224 | KL: 81.1268
Epoch 0830 | Beta: 1.00 | Loss: 151.5219 | NLL: 72.4024 | KL: 79.1195
Epoch 0840 | Beta: 1.00 | Loss: 146.7997 | NLL: 68.1382 | KL: 78.6615
Epoch 0850 | Beta: 1.00 | Loss: 148.9756 | NLL: 70.3780 | KL: 78.5976
Epoch 0860 | Beta: 1.00 | Loss: 147.9246 | NLL: 68.5722 | KL: 79.3524
Epoch 0870 | Beta: 1.00 | Loss: 149.5871 | NLL: 70.1136 | KL: 79.4735
Epoch 0880 | Beta: 1.00 | Loss: 146.3385 | NLL: 67.0643 | KL: 79.2742
Epoch 0890 | Beta: 1.00 | Loss: 148.3487 | NLL: 68.7762 | KL: 79.5726
Epoch 0900 | Beta: 1.00 | Loss: 151.3492 | NLL: 72.2299 | KL: 79.1193
Epoch 0910 | Beta: 1.00 | Loss: 145.3222 | NLL: 66.0043 | KL: 79.3179
Epoch 0920 | Beta: 1.00 | Loss: 147.2088 | NLL: 68.2477 | KL: 78.9610
Epoch 0930 | Beta: 1.00 | Loss: 148.3149 | NLL: 67.9749 | KL: 80.3399
Epoch 0940 | Beta: 1.00 | Loss: 148.1897 | NLL: 69.4887 | KL: 78.7011
Epoch 0950 | Beta: 1.00 | Loss: 148.9284 | NLL: 70.1494 | KL: 78.7790
Epoch 0960 | Beta: 1.00 | Loss: 148.2357 | NLL: 67.9185 | KL: 80.3171
Epoch 0970 | Beta: 1.00 | Loss: 150.5980 | NLL: 71.8570 | KL: 78.7410
Epoch 0980 | Beta: 1.00 | Loss: 147.8926 | NLL: 66.9610 | KL: 80.9316
Epoch 0990 | Beta: 1.00 | Loss: 147.5194 | NLL: 66.9969 | KL: 80.5226
Epoch 1000 | Beta: 1.00 | Loss: 152.8699 | NLL: 72.6442 | KL: 80.2257
Correlation Heatmap saved to paper_plots\run_20260103_142804/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 16
Frequenza Osservata: 0.0146 (Target: 0.0500)
LR Statistic: 39.8526 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1067, n01=15, n10=15, n11=1
LR Independence: 1.4548 (p-value: 0.2278)
LR Conditional Coverage (CC): 41.3075 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_142804/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_152815
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_152815

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_152815
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 165.8678 | NLL: 159.0435 | KL: 75.8257
Epoch 0020 | Beta: 0.19 | Loss: 163.7422 | NLL: 149.6789 | KL: 74.0174
Epoch 0030 | Beta: 0.29 | Loss: 159.2162 | NLL: 138.6520 | KL: 70.9110
Epoch 0040 | Beta: 0.39 | Loss: 161.9219 | NLL: 134.7908 | KL: 69.5670
Epoch 0050 | Beta: 0.49 | Loss: 165.2629 | NLL: 131.9259 | KL: 68.0347
Epoch 0060 | Beta: 0.59 | Loss: 167.8953 | NLL: 127.5270 | KL: 68.4208
Epoch 0070 | Beta: 0.69 | Loss: 169.9143 | NLL: 120.5762 | KL: 71.5044
Epoch 0080 | Beta: 0.79 | Loss: 172.0743 | NLL: 114.2032 | KL: 73.2546
Epoch 0090 | Beta: 0.89 | Loss: 174.6665 | NLL: 107.7868 | KL: 75.1458
Epoch 0100 | Beta: 0.99 | Loss: 175.3235 | NLL: 98.7932 | KL: 77.3033
Epoch 0110 | Beta: 1.00 | Loss: 170.8557 | NLL: 91.0156 | KL: 79.8400
Epoch 0120 | Beta: 1.00 | Loss: 169.4077 | NLL: 88.5231 | KL: 80.8846
Epoch 0130 | Beta: 1.00 | Loss: 166.6688 | NLL: 85.0734 | KL: 81.5954
Epoch 0140 | Beta: 1.00 | Loss: 166.3510 | NLL: 84.5314 | KL: 81.8197
Epoch 0150 | Beta: 1.00 | Loss: 166.9487 | NLL: 83.6630 | KL: 83.2857
Epoch 0160 | Beta: 1.00 | Loss: 166.5473 | NLL: 82.6519 | KL: 83.8954
Epoch 0170 | Beta: 1.00 | Loss: 167.5858 | NLL: 83.9040 | KL: 83.6818
Epoch 0180 | Beta: 1.00 | Loss: 166.8370 | NLL: 81.9051 | KL: 84.9319
Epoch 0190 | Beta: 1.00 | Loss: 165.3842 | NLL: 79.8887 | KL: 85.4956
Epoch 0200 | Beta: 1.00 | Loss: 166.3947 | NLL: 80.2795 | KL: 86.1152
Epoch 0210 | Beta: 1.00 | Loss: 165.8862 | NLL: 79.7781 | KL: 86.1081
Epoch 0220 | Beta: 1.00 | Loss: 164.9246 | NLL: 77.7057 | KL: 87.2189
Epoch 0230 | Beta: 1.00 | Loss: 166.2975 | NLL: 79.5247 | KL: 86.7728
Epoch 0240 | Beta: 1.00 | Loss: 165.7470 | NLL: 78.5180 | KL: 87.2289

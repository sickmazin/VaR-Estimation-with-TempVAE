Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_142804
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_142804

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 15
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_142804
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 162.1695 | NLL: 156.9863 | KL: 57.5908
Epoch 0020 | Beta: 0.19 | Loss: 142.9456 | NLL: 130.6923 | KL: 64.4914
Epoch 0030 | Beta: 0.29 | Loss: 129.7475 | NLL: 107.0762 | KL: 78.1770
Epoch 0040 | Beta: 0.39 | Loss: 122.9645 | NLL: 90.6564 | KL: 82.8413
Epoch 0050 | Beta: 0.49 | Loss: 124.4837 | NLL: 83.7685 | KL: 83.0923
Epoch 0060 | Beta: 0.59 | Loss: 132.4921 | NLL: 84.3608 | KL: 81.5783
Epoch 0070 | Beta: 0.69 | Loss: 138.2745 | NLL: 83.1489 | KL: 79.8922
Epoch 0080 | Beta: 0.79 | Loss: 144.3998 | NLL: 82.4110 | KL: 78.4669
Epoch 0090 | Beta: 0.89 | Loss: 153.6258 | NLL: 86.0799 | KL: 75.8943
Epoch 0100 | Beta: 0.99 | Loss: 158.1253 | NLL: 85.5376 | KL: 73.3209
Epoch 0110 | Beta: 1.00 | Loss: 160.1220 | NLL: 87.2206 | KL: 72.9014
Epoch 0120 | Beta: 1.00 | Loss: 157.9152 | NLL: 84.7734 | KL: 73.1418
Epoch 0130 | Beta: 1.00 | Loss: 157.8173 | NLL: 84.1505 | KL: 73.6668
Epoch 0140 | Beta: 1.00 | Loss: 156.8830 | NLL: 82.9985 | KL: 73.8845
Epoch 0150 | Beta: 1.00 | Loss: 158.0737 | NLL: 84.8638 | KL: 73.2098
Epoch 0160 | Beta: 1.00 | Loss: 155.2471 | NLL: 81.7819 | KL: 73.4652
Epoch 0170 | Beta: 1.00 | Loss: 155.8600 | NLL: 81.4686 | KL: 74.3913
Epoch 0180 | Beta: 1.00 | Loss: 155.0014 | NLL: 80.0167 | KL: 74.9848
Epoch 0190 | Beta: 1.00 | Loss: 156.0839 | NLL: 81.3951 | KL: 74.6888
Epoch 0200 | Beta: 1.00 | Loss: 154.9074 | NLL: 80.1538 | KL: 74.7535
Epoch 0210 | Beta: 1.00 | Loss: 155.1390 | NLL: 80.2683 | KL: 74.8708
Epoch 0220 | Beta: 1.00 | Loss: 152.8760 | NLL: 77.0402 | KL: 75.8359
Epoch 0230 | Beta: 1.00 | Loss: 152.9150 | NLL: 76.0699 | KL: 76.8451
Epoch 0240 | Beta: 1.00 | Loss: 153.9096 | NLL: 77.6385 | KL: 76.2711
Epoch 0250 | Beta: 1.00 | Loss: 154.9732 | NLL: 79.0632 | KL: 75.9100
Epoch 0260 | Beta: 1.00 | Loss: 151.9106 | NLL: 75.6132 | KL: 76.2974
Epoch 0270 | Beta: 1.00 | Loss: 151.3422 | NLL: 75.3170 | KL: 76.0253
Epoch 0280 | Beta: 1.00 | Loss: 148.8374 | NLL: 72.5250 | KL: 76.3125
Epoch 0290 | Beta: 1.00 | Loss: 151.7322 | NLL: 75.0223 | KL: 76.7099
Epoch 0300 | Beta: 1.00 | Loss: 152.7498 | NLL: 76.6251 | KL: 76.1246
Epoch 0310 | Beta: 1.00 | Loss: 152.5395 | NLL: 76.2019 | KL: 76.3375
Epoch 0320 | Beta: 1.00 | Loss: 153.0294 | NLL: 75.7260 | KL: 77.3034
Epoch 0330 | Beta: 1.00 | Loss: 153.0823 | NLL: 76.9507 | KL: 76.1316
Epoch 0340 | Beta: 1.00 | Loss: 151.3752 | NLL: 74.6692 | KL: 76.7059
Epoch 0350 | Beta: 1.00 | Loss: 149.9159 | NLL: 72.3653 | KL: 77.5506
Epoch 0360 | Beta: 1.00 | Loss: 152.0264 | NLL: 74.8603 | KL: 77.1661
Epoch 0370 | Beta: 1.00 | Loss: 154.2202 | NLL: 76.4698 | KL: 77.7504
Epoch 0380 | Beta: 1.00 | Loss: 167.0903 | NLL: 90.6293 | KL: 76.4610
Epoch 0390 | Beta: 1.00 | Loss: 153.6953 | NLL: 77.6765 | KL: 76.0188
Epoch 0400 | Beta: 1.00 | Loss: 149.6720 | NLL: 72.2853 | KL: 77.3867
Epoch 0410 | Beta: 1.00 | Loss: 151.4087 | NLL: 74.6136 | KL: 76.7951
Epoch 0420 | Beta: 1.00 | Loss: 151.9316 | NLL: 76.1630 | KL: 75.7685
Epoch 0430 | Beta: 1.00 | Loss: 149.9904 | NLL: 73.2103 | KL: 76.7801
Epoch 0440 | Beta: 1.00 | Loss: 148.4688 | NLL: 70.8421 | KL: 77.6266
Epoch 0450 | Beta: 1.00 | Loss: 148.1503 | NLL: 70.2589 | KL: 77.8914
Epoch 0460 | Beta: 1.00 | Loss: 151.2029 | NLL: 73.3074 | KL: 77.8955
Epoch 0470 | Beta: 1.00 | Loss: 151.7742 | NLL: 75.4363 | KL: 76.3379
Epoch 0480 | Beta: 1.00 | Loss: 153.4854 | NLL: 75.1333 | KL: 78.3521
Epoch 0490 | Beta: 1.00 | Loss: 148.7387 | NLL: 71.5607 | KL: 77.1780
Epoch 0500 | Beta: 1.00 | Loss: 150.1547 | NLL: 71.5507 | KL: 78.6040
Epoch 0510 | Beta: 1.00 | Loss: 148.8024 | NLL: 70.9412 | KL: 77.8612
Epoch 0520 | Beta: 1.00 | Loss: 151.6333 | NLL: 73.7977 | KL: 77.8356
Epoch 0530 | Beta: 1.00 | Loss: 157.3161 | NLL: 77.9451 | KL: 79.3711
Epoch 0540 | Beta: 1.00 | Loss: 150.7857 | NLL: 72.6987 | KL: 78.0870
Epoch 0550 | Beta: 1.00 | Loss: 149.8782 | NLL: 71.8849 | KL: 77.9934
Epoch 0560 | Beta: 1.00 | Loss: 149.6026 | NLL: 70.2858 | KL: 79.3167
Epoch 0570 | Beta: 1.00 | Loss: 148.9857 | NLL: 70.0085 | KL: 78.9771
Epoch 0580 | Beta: 1.00 | Loss: 150.4162 | NLL: 71.6074 | KL: 78.8088
Epoch 0590 | Beta: 1.00 | Loss: 153.6348 | NLL: 75.1901 | KL: 78.4447
Epoch 0600 | Beta: 1.00 | Loss: 151.1701 | NLL: 72.9869 | KL: 78.1832
Epoch 0610 | Beta: 1.00 | Loss: 150.0575 | NLL: 72.3824 | KL: 77.6751
Epoch 0620 | Beta: 1.00 | Loss: 149.4414 | NLL: 70.6746 | KL: 78.7668
Epoch 0630 | Beta: 1.00 | Loss: 150.8263 | NLL: 72.4036 | KL: 78.4227
Epoch 0640 | Beta: 1.00 | Loss: 149.9624 | NLL: 71.0503 | KL: 78.9122
Epoch 0650 | Beta: 1.00 | Loss: 148.5854 | NLL: 70.2641 | KL: 78.3213
Epoch 0660 | Beta: 1.00 | Loss: 150.2251 | NLL: 71.0757 | KL: 79.1494
Epoch 0670 | Beta: 1.00 | Loss: 150.0183 | NLL: 72.2154 | KL: 77.8029
Epoch 0680 | Beta: 1.00 | Loss: 149.0325 | NLL: 69.1158 | KL: 79.9167
Epoch 0690 | Beta: 1.00 | Loss: 148.4791 | NLL: 69.2716 | KL: 79.2075
Epoch 0700 | Beta: 1.00 | Loss: 150.9463 | NLL: 72.7706 | KL: 78.1757
Epoch 0710 | Beta: 1.00 | Loss: 151.9399 | NLL: 73.5853 | KL: 78.3546
Epoch 0720 | Beta: 1.00 | Loss: 151.0518 | NLL: 72.1418 | KL: 78.9100
Epoch 0730 | Beta: 1.00 | Loss: 151.8773 | NLL: 73.5661 | KL: 78.3112
Epoch 0740 | Beta: 1.00 | Loss: 149.3490 | NLL: 70.1203 | KL: 79.2286
Epoch 0750 | Beta: 1.00 | Loss: 150.2232 | NLL: 71.0629 | KL: 79.1603
Epoch 0760 | Beta: 1.00 | Loss: 150.2078 | NLL: 70.2568 | KL: 79.9510
Epoch 0770 | Beta: 1.00 | Loss: 148.3427 | NLL: 68.9656 | KL: 79.3771
Epoch 0780 | Beta: 1.00 | Loss: 150.0495 | NLL: 71.0305 | KL: 79.0191
Epoch 0790 | Beta: 1.00 | Loss: 150.0547 | NLL: 70.9963 | KL: 79.0584
Epoch 0800 | Beta: 1.00 | Loss: 148.2841 | NLL: 68.4303 | KL: 79.8538
Epoch 0810 | Beta: 1.00 | Loss: 149.1995 | NLL: 68.7415 | KL: 80.4579
Epoch 0820 | Beta: 1.00 | Loss: 149.1492 | NLL: 68.0224 | KL: 81.1268
Epoch 0830 | Beta: 1.00 | Loss: 151.5219 | NLL: 72.4024 | KL: 79.1195
Epoch 0840 | Beta: 1.00 | Loss: 146.7997 | NLL: 68.1382 | KL: 78.6615
Epoch 0850 | Beta: 1.00 | Loss: 148.9756 | NLL: 70.3780 | KL: 78.5976
Epoch 0860 | Beta: 1.00 | Loss: 147.9246 | NLL: 68.5722 | KL: 79.3524
Epoch 0870 | Beta: 1.00 | Loss: 149.5871 | NLL: 70.1136 | KL: 79.4735
Epoch 0880 | Beta: 1.00 | Loss: 146.3385 | NLL: 67.0643 | KL: 79.2742
Epoch 0890 | Beta: 1.00 | Loss: 148.3487 | NLL: 68.7762 | KL: 79.5726
Epoch 0900 | Beta: 1.00 | Loss: 151.3492 | NLL: 72.2299 | KL: 79.1193
Epoch 0910 | Beta: 1.00 | Loss: 145.3222 | NLL: 66.0043 | KL: 79.3179
Epoch 0920 | Beta: 1.00 | Loss: 147.2088 | NLL: 68.2477 | KL: 78.9610
Epoch 0930 | Beta: 1.00 | Loss: 148.3149 | NLL: 67.9749 | KL: 80.3399
Epoch 0940 | Beta: 1.00 | Loss: 148.1897 | NLL: 69.4887 | KL: 78.7011
Epoch 0950 | Beta: 1.00 | Loss: 148.9284 | NLL: 70.1494 | KL: 78.7790
Epoch 0960 | Beta: 1.00 | Loss: 148.2357 | NLL: 67.9185 | KL: 80.3171
Epoch 0970 | Beta: 1.00 | Loss: 150.5980 | NLL: 71.8570 | KL: 78.7410
Epoch 0980 | Beta: 1.00 | Loss: 147.8926 | NLL: 66.9610 | KL: 80.9316
Epoch 0990 | Beta: 1.00 | Loss: 147.5194 | NLL: 66.9969 | KL: 80.5226
Epoch 1000 | Beta: 1.00 | Loss: 152.8699 | NLL: 72.6442 | KL: 80.2257
Correlation Heatmap saved to paper_plots\run_20260103_142804/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 16
Frequenza Osservata: 0.0146 (Target: 0.0500)
LR Statistic: 39.8526 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1067, n01=15, n10=15, n11=1
LR Independence: 1.4548 (p-value: 0.2278)
LR Conditional Coverage (CC): 41.3075 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_142804/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_152815
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_152815

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_152815
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 165.8678 | NLL: 159.0435 | KL: 75.8257
Epoch 0020 | Beta: 0.19 | Loss: 163.7422 | NLL: 149.6789 | KL: 74.0174
Epoch 0030 | Beta: 0.29 | Loss: 159.2162 | NLL: 138.6520 | KL: 70.9110
Epoch 0040 | Beta: 0.39 | Loss: 161.9219 | NLL: 134.7908 | KL: 69.5670
Epoch 0050 | Beta: 0.49 | Loss: 165.2629 | NLL: 131.9259 | KL: 68.0347
Epoch 0060 | Beta: 0.59 | Loss: 167.8953 | NLL: 127.5270 | KL: 68.4208
Epoch 0070 | Beta: 0.69 | Loss: 169.9143 | NLL: 120.5762 | KL: 71.5044
Epoch 0080 | Beta: 0.79 | Loss: 172.0743 | NLL: 114.2032 | KL: 73.2546
Epoch 0090 | Beta: 0.89 | Loss: 174.6665 | NLL: 107.7868 | KL: 75.1458
Epoch 0100 | Beta: 0.99 | Loss: 175.3235 | NLL: 98.7932 | KL: 77.3033
Epoch 0110 | Beta: 1.00 | Loss: 170.8557 | NLL: 91.0156 | KL: 79.8400
Epoch 0120 | Beta: 1.00 | Loss: 169.4077 | NLL: 88.5231 | KL: 80.8846
Epoch 0130 | Beta: 1.00 | Loss: 166.6688 | NLL: 85.0734 | KL: 81.5954
Epoch 0140 | Beta: 1.00 | Loss: 166.3510 | NLL: 84.5314 | KL: 81.8197
Epoch 0150 | Beta: 1.00 | Loss: 166.9487 | NLL: 83.6630 | KL: 83.2857
Epoch 0160 | Beta: 1.00 | Loss: 166.5473 | NLL: 82.6519 | KL: 83.8954
Epoch 0170 | Beta: 1.00 | Loss: 167.5858 | NLL: 83.9040 | KL: 83.6818
Epoch 0180 | Beta: 1.00 | Loss: 166.8370 | NLL: 81.9051 | KL: 84.9319
Epoch 0190 | Beta: 1.00 | Loss: 165.3842 | NLL: 79.8887 | KL: 85.4956
Epoch 0200 | Beta: 1.00 | Loss: 166.3947 | NLL: 80.2795 | KL: 86.1152
Epoch 0210 | Beta: 1.00 | Loss: 165.8862 | NLL: 79.7781 | KL: 86.1081
Epoch 0220 | Beta: 1.00 | Loss: 164.9246 | NLL: 77.7057 | KL: 87.2189
Epoch 0230 | Beta: 1.00 | Loss: 166.2975 | NLL: 79.5247 | KL: 86.7728
Epoch 0240 | Beta: 1.00 | Loss: 165.7470 | NLL: 78.5180 | KL: 87.2289

CONFIG = {
    'seq_length': 21,         # Finestra temporale M
    'latent_dim': 10,         # K=10 dimensioni latenti
    'hidden_dim': 16,         # H=32
    'batch_size': 256,
    'epochs': 1000,
    'annealing_epochs': 100,
    'learning_rate': 1e-3,
    'l2_reg': 0.01,
    'data_path': 'dataset/log_returns.csv',
    'plot_dir': 'paper_plots',
    'device': 'cuda' if torch.cuda.is_available() else 'cpu',
    'seed': 42,
    'train_split': 0.66,
    'dropout_rate': 0.1      # Dropout 10% (Paper calibration)
}


>>> Risultati di questa esecuzione in: paper_plots\run_20260102_192928
>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 130.6726 | NLL: 118.9905 | KL: 129.8008
Epoch 0020 | Beta: 0.19 | Loss: 131.2827 | NLL: 111.9527 | KL: 101.7366
Epoch 0030 | Beta: 0.29 | Loss: 136.8324 | NLL: 111.7511 | KL: 86.4871
Epoch 0040 | Beta: 0.39 | Loss: 140.8975 | NLL: 110.2115 | KL: 78.6821
Epoch 0050 | Beta: 0.49 | Loss: 141.8857 | NLL: 103.5191 | KL: 78.2992
Epoch 0060 | Beta: 0.59 | Loss: 145.2293 | NLL: 100.5147 | KL: 75.7874
Epoch 0070 | Beta: 0.69 | Loss: 150.0365 | NLL: 98.9091 | KL: 74.0977
Epoch 0080 | Beta: 0.79 | Loss: 155.4791 | NLL: 98.4703 | KL: 72.1631
Epoch 0090 | Beta: 0.89 | Loss: 161.0518 | NLL: 98.3808 | KL: 70.4169
Epoch 0100 | Beta: 0.99 | Loss: 166.9121 | NLL: 98.0835 | KL: 69.5238
Epoch 0110 | Beta: 1.00 | Loss: 166.1338 | NLL: 97.5601 | KL: 68.5737
Epoch 0120 | Beta: 1.00 | Loss: 165.0137 | NLL: 97.3016 | KL: 67.7120
Epoch 0130 | Beta: 1.00 | Loss: 165.0499 | NLL: 97.0722 | KL: 67.9776
Epoch 0140 | Beta: 1.00 | Loss: 164.6373 | NLL: 96.9132 | KL: 67.7241
Epoch 0150 | Beta: 1.00 | Loss: 164.2203 | NLL: 96.5537 | KL: 67.6666
Epoch 0160 | Beta: 1.00 | Loss: 162.4504 | NLL: 95.5688 | KL: 66.8816
Epoch 0170 | Beta: 1.00 | Loss: 162.3491 | NLL: 95.0944 | KL: 67.2546
Epoch 0180 | Beta: 1.00 | Loss: 161.8294 | NLL: 94.9152 | KL: 66.9142
Epoch 0190 | Beta: 1.00 | Loss: 160.6273 | NLL: 93.5723 | KL: 67.0550
Epoch 0200 | Beta: 1.00 | Loss: 160.2645 | NLL: 93.0951 | KL: 67.1694
Epoch 0210 | Beta: 1.00 | Loss: 159.0964 | NLL: 92.2575 | KL: 66.8389
Epoch 0220 | Beta: 1.00 | Loss: 158.3615 | NLL: 91.8646 | KL: 66.4969
Epoch 0230 | Beta: 1.00 | Loss: 157.8039 | NLL: 90.9731 | KL: 66.8308
Epoch 0240 | Beta: 1.00 | Loss: 157.0848 | NLL: 89.8827 | KL: 67.2021
Epoch 0250 | Beta: 1.00 | Loss: 157.3547 | NLL: 89.2614 | KL: 68.0933
Epoch 0260 | Beta: 1.00 | Loss: 155.6581 | NLL: 88.1670 | KL: 67.4911
Epoch 0270 | Beta: 1.00 | Loss: 154.8201 | NLL: 86.3652 | KL: 68.4550
Epoch 0280 | Beta: 1.00 | Loss: 153.8593 | NLL: 84.4473 | KL: 69.4120
Epoch 0290 | Beta: 1.00 | Loss: 152.4889 | NLL: 81.5149 | KL: 70.9739
Epoch 0300 | Beta: 1.00 | Loss: 150.7604 | NLL: 79.4923 | KL: 71.2681
Epoch 0310 | Beta: 1.00 | Loss: 149.4524 | NLL: 75.8511 | KL: 73.6013
Epoch 0320 | Beta: 1.00 | Loss: 148.0572 | NLL: 73.8845 | KL: 74.1727
Epoch 0330 | Beta: 1.00 | Loss: 146.2948 | NLL: 69.9142 | KL: 76.3806
Epoch 0340 | Beta: 1.00 | Loss: 145.1081 | NLL: 68.0646 | KL: 77.0434
Epoch 0350 | Beta: 1.00 | Loss: 144.8895 | NLL: 67.3803 | KL: 77.5092
Epoch 0360 | Beta: 1.00 | Loss: 144.3646 | NLL: 66.2538 | KL: 78.1108
Epoch 0370 | Beta: 1.00 | Loss: 143.6792 | NLL: 65.0843 | KL: 78.5949
Epoch 0380 | Beta: 1.00 | Loss: 143.9409 | NLL: 63.8101 | KL: 80.1308
Epoch 0390 | Beta: 1.00 | Loss: 143.5365 | NLL: 63.6740 | KL: 79.8625
Epoch 0400 | Beta: 1.00 | Loss: 143.0096 | NLL: 62.5927 | KL: 80.4169
Epoch 0410 | Beta: 1.00 | Loss: 144.0387 | NLL: 63.1435 | KL: 80.8952
Epoch 0420 | Beta: 1.00 | Loss: 143.2093 | NLL: 62.1771 | KL: 81.0322
Epoch 0430 | Beta: 1.00 | Loss: 143.8488 | NLL: 62.2706 | KL: 81.5782
Epoch 0440 | Beta: 1.00 | Loss: 142.6772 | NLL: 61.2210 | KL: 81.4562
Epoch 0450 | Beta: 1.00 | Loss: 144.1258 | NLL: 61.2975 | KL: 82.8282
Epoch 0460 | Beta: 1.00 | Loss: 145.2939 | NLL: 63.0707 | KL: 82.2232
Epoch 0470 | Beta: 1.00 | Loss: 143.1118 | NLL: 60.1061 | KL: 83.0057
Epoch 0480 | Beta: 1.00 | Loss: 143.6291 | NLL: 60.4241 | KL: 83.2050
Epoch 0490 | Beta: 1.00 | Loss: 143.8285 | NLL: 60.3762 | KL: 83.4523
Epoch 0500 | Beta: 1.00 | Loss: 143.1323 | NLL: 58.8827 | KL: 84.2496
Epoch 0510 | Beta: 1.00 | Loss: 143.5006 | NLL: 58.7778 | KL: 84.7228
Epoch 0520 | Beta: 1.00 | Loss: 145.0764 | NLL: 60.5598 | KL: 84.5166
Epoch 0530 | Beta: 1.00 | Loss: 144.9443 | NLL: 60.2952 | KL: 84.6491
Epoch 0540 | Beta: 1.00 | Loss: 144.3966 | NLL: 59.0704 | KL: 85.3262
Epoch 0550 | Beta: 1.00 | Loss: 144.8574 | NLL: 59.9837 | KL: 84.8737
Epoch 0560 | Beta: 1.00 | Loss: 146.0382 | NLL: 60.9557 | KL: 85.0825
Epoch 0570 | Beta: 1.00 | Loss: 145.4403 | NLL: 59.2176 | KL: 86.2227
Epoch 0580 | Beta: 1.00 | Loss: 144.8358 | NLL: 59.4449 | KL: 85.3909
Epoch 0590 | Beta: 1.00 | Loss: 144.6817 | NLL: 58.0869 | KL: 86.5948
Epoch 0600 | Beta: 1.00 | Loss: 144.8293 | NLL: 58.7004 | KL: 86.1289
Epoch 0610 | Beta: 1.00 | Loss: 145.1934 | NLL: 59.2042 | KL: 85.9892
Epoch 0620 | Beta: 1.00 | Loss: 146.5709 | NLL: 60.1028 | KL: 86.4681
Epoch 0630 | Beta: 1.00 | Loss: 145.3593 | NLL: 58.5601 | KL: 86.7992
Epoch 0640 | Beta: 1.00 | Loss: 143.3328 | NLL: 55.9177 | KL: 87.4151
Epoch 0650 | Beta: 1.00 | Loss: 146.5614 | NLL: 58.9383 | KL: 87.6232
Epoch 0660 | Beta: 1.00 | Loss: 144.4314 | NLL: 57.7075 | KL: 86.7239
Epoch 0670 | Beta: 1.00 | Loss: 147.2378 | NLL: 59.6622 | KL: 87.5757
Epoch 0680 | Beta: 1.00 | Loss: 145.6384 | NLL: 57.7859 | KL: 87.8525
Epoch 0690 | Beta: 1.00 | Loss: 146.2613 | NLL: 58.4801 | KL: 87.7812
Epoch 0700 | Beta: 1.00 | Loss: 144.8889 | NLL: 56.5714 | KL: 88.3175
Epoch 0710 | Beta: 1.00 | Loss: 145.7467 | NLL: 58.1755 | KL: 87.5712
Epoch 0720 | Beta: 1.00 | Loss: 144.5798 | NLL: 56.2793 | KL: 88.3006
Epoch 0730 | Beta: 1.00 | Loss: 146.2112 | NLL: 57.4446 | KL: 88.7666
Epoch 0740 | Beta: 1.00 | Loss: 144.5004 | NLL: 56.1265 | KL: 88.3739
Epoch 0750 | Beta: 1.00 | Loss: 145.1716 | NLL: 56.5132 | KL: 88.6584
Epoch 0760 | Beta: 1.00 | Loss: 145.6840 | NLL: 56.3979 | KL: 89.2861
Epoch 0770 | Beta: 1.00 | Loss: 146.0764 | NLL: 56.4650 | KL: 89.6114
Epoch 0780 | Beta: 1.00 | Loss: 146.8633 | NLL: 57.5613 | KL: 89.3020
Epoch 0790 | Beta: 1.00 | Loss: 147.1904 | NLL: 57.1566 | KL: 90.0339
Epoch 0800 | Beta: 1.00 | Loss: 143.2170 | NLL: 53.8906 | KL: 89.3264
Epoch 0810 | Beta: 1.00 | Loss: 145.6652 | NLL: 55.2644 | KL: 90.4009
Epoch 0820 | Beta: 1.00 | Loss: 147.0922 | NLL: 57.0713 | KL: 90.0209
Epoch 0830 | Beta: 1.00 | Loss: 146.2310 | NLL: 55.8005 | KL: 90.4305
Epoch 0840 | Beta: 1.00 | Loss: 145.0160 | NLL: 54.3889 | KL: 90.6271
Epoch 0850 | Beta: 1.00 | Loss: 146.5596 | NLL: 55.5187 | KL: 91.0409
Epoch 0860 | Beta: 1.00 | Loss: 147.0589 | NLL: 55.2655 | KL: 91.7934
Epoch 0870 | Beta: 1.00 | Loss: 147.0780 | NLL: 56.3160 | KL: 90.7620
Epoch 0880 | Beta: 1.00 | Loss: 147.0040 | NLL: 56.0050 | KL: 90.9990
Epoch 0890 | Beta: 1.00 | Loss: 146.2022 | NLL: 55.4232 | KL: 90.7789
Epoch 0900 | Beta: 1.00 | Loss: 146.9704 | NLL: 56.1738 | KL: 90.7966
Epoch 0910 | Beta: 1.00 | Loss: 145.5011 | NLL: 53.4467 | KL: 92.0544
Epoch 0920 | Beta: 1.00 | Loss: 148.1588 | NLL: 56.4088 | KL: 91.7500
Epoch 0930 | Beta: 1.00 | Loss: 147.9417 | NLL: 55.1259 | KL: 92.8158
Epoch 0940 | Beta: 1.00 | Loss: 147.2376 | NLL: 55.4718 | KL: 91.7658
Epoch 0950 | Beta: 1.00 | Loss: 147.3108 | NLL: 55.5862 | KL: 91.7246
Epoch 0960 | Beta: 1.00 | Loss: 147.6305 | NLL: 55.7715 | KL: 91.8590
Epoch 0970 | Beta: 1.00 | Loss: 146.0504 | NLL: 54.4721 | KL: 91.5783
Epoch 0980 | Beta: 1.00 | Loss: 146.8260 | NLL: 54.8069 | KL: 92.0192
Epoch 0990 | Beta: 1.00 | Loss: 146.1314 | NLL: 53.8281 | KL: 92.3033
Epoch 1000 | Beta: 1.00 | Loss: 147.8449 | NLL: 55.8860 | KL: 91.9589
Correlation Heatmap saved to paper_plots\run_20260102_192928/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1258
Violazioni Attese: 62.9
Violazioni Osservate: 39
Frequenza Osservata: 0.0310 (Target: 0.0500)
LR Statistic: 10.9920 | P-Value: 0.0009
RISULTATO: RIGETTO H0. Il modello NON Ã¨ calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1183, n01=35, n10=35, n11=4
LR Independence: 4.4144 (p-value: 0.0356)
LR Conditional Coverage (CC): 15.4064 | P-Value CC: 0.0005
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260102_192928/var_regimes_plot.png'

>>> Analysis Complete.

Process finished with exit code 0

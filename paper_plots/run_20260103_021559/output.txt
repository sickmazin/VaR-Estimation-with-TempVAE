Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_021559
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_021559

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 25
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_021559
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 153.5188 | NLL: 140.9191 | KL: 139.9964
Epoch 0020 | Beta: 0.19 | Loss: 154.9858 | NLL: 132.4430 | KL: 118.6462
Epoch 0030 | Beta: 0.29 | Loss: 158.8654 | NLL: 127.6114 | KL: 107.7723
Epoch 0040 | Beta: 0.39 | Loss: 161.2448 | NLL: 121.7622 | KL: 101.2373
Epoch 0050 | Beta: 0.49 | Loss: 167.2119 | NLL: 119.8139 | KL: 96.7307
Epoch 0060 | Beta: 0.59 | Loss: 173.4048 | NLL: 118.1822 | KL: 93.5975
Epoch 0070 | Beta: 0.69 | Loss: 180.5339 | NLL: 117.2677 | KL: 91.6901
Epoch 0080 | Beta: 0.79 | Loss: 187.3244 | NLL: 116.7894 | KL: 89.2848
Epoch 0090 | Beta: 0.89 | Loss: 194.7368 | NLL: 116.2923 | KL: 88.1399
Epoch 0100 | Beta: 0.99 | Loss: 201.8880 | NLL: 115.7551 | KL: 87.0029
Epoch 0110 | Beta: 1.00 | Loss: 200.8031 | NLL: 115.4743 | KL: 85.3288
Epoch 0120 | Beta: 1.00 | Loss: 199.4484 | NLL: 114.5781 | KL: 84.8703
Epoch 0130 | Beta: 1.00 | Loss: 198.8389 | NLL: 114.0495 | KL: 84.7895
Epoch 0140 | Beta: 1.00 | Loss: 196.7814 | NLL: 112.9360 | KL: 83.8454
Epoch 0150 | Beta: 1.00 | Loss: 195.9775 | NLL: 111.7560 | KL: 84.2216
Epoch 0160 | Beta: 1.00 | Loss: 194.6156 | NLL: 110.4189 | KL: 84.1967
Epoch 0170 | Beta: 1.00 | Loss: 193.8366 | NLL: 109.2043 | KL: 84.6323
Epoch 0180 | Beta: 1.00 | Loss: 192.0675 | NLL: 107.3092 | KL: 84.7583
Epoch 0190 | Beta: 1.00 | Loss: 189.9430 | NLL: 104.9940 | KL: 84.9490
Epoch 0200 | Beta: 1.00 | Loss: 188.2972 | NLL: 102.1096 | KL: 86.1876
Epoch 0210 | Beta: 1.00 | Loss: 186.7451 | NLL: 98.8561 | KL: 87.8890
Epoch 0220 | Beta: 1.00 | Loss: 183.7630 | NLL: 93.9919 | KL: 89.7711
Epoch 0230 | Beta: 1.00 | Loss: 178.9752 | NLL: 87.9168 | KL: 91.0583
Epoch 0240 | Beta: 1.00 | Loss: 177.0070 | NLL: 83.1330 | KL: 93.8741
Epoch 0250 | Beta: 1.00 | Loss: 173.5926 | NLL: 78.8779 | KL: 94.7147
Epoch 0260 | Beta: 1.00 | Loss: 170.5852 | NLL: 74.6937 | KL: 95.8915
Epoch 0270 | Beta: 1.00 | Loss: 167.9321 | NLL: 71.1369 | KL: 96.7952
Epoch 0280 | Beta: 1.00 | Loss: 164.7296 | NLL: 66.6477 | KL: 98.0818
Epoch 0290 | Beta: 1.00 | Loss: 167.8000 | NLL: 69.0605 | KL: 98.7395
Epoch 0300 | Beta: 1.00 | Loss: 161.7438 | NLL: 62.6275 | KL: 99.1163
Epoch 0310 | Beta: 1.00 | Loss: 165.9113 | NLL: 66.1173 | KL: 99.7940
Epoch 0320 | Beta: 1.00 | Loss: 159.7276 | NLL: 60.5917 | KL: 99.1359
Epoch 0330 | Beta: 1.00 | Loss: 156.2847 | NLL: 56.9882 | KL: 99.2965
Epoch 0340 | Beta: 1.00 | Loss: 156.3191 | NLL: 55.4813 | KL: 100.8378
Epoch 0350 | Beta: 1.00 | Loss: 153.1754 | NLL: 53.2525 | KL: 99.9229
Epoch 0360 | Beta: 1.00 | Loss: 152.0247 | NLL: 51.3683 | KL: 100.6564
Epoch 0370 | Beta: 1.00 | Loss: 152.7868 | NLL: 52.0852 | KL: 100.7017
Epoch 0380 | Beta: 1.00 | Loss: 150.3959 | NLL: 50.0339 | KL: 100.3621
Epoch 0390 | Beta: 1.00 | Loss: 150.5191 | NLL: 48.8697 | KL: 101.6494
Epoch 0400 | Beta: 1.00 | Loss: 148.4867 | NLL: 48.3432 | KL: 100.1435
Epoch 0410 | Beta: 1.00 | Loss: 146.0644 | NLL: 45.0577 | KL: 101.0066
Epoch 0420 | Beta: 1.00 | Loss: 155.8333 | NLL: 55.0079 | KL: 100.8254
Epoch 0430 | Beta: 1.00 | Loss: 146.6445 | NLL: 45.8621 | KL: 100.7824
Epoch 0440 | Beta: 1.00 | Loss: 142.4093 | NLL: 42.5933 | KL: 99.8160
Epoch 0450 | Beta: 1.00 | Loss: 142.6292 | NLL: 42.0527 | KL: 100.5765
Epoch 0460 | Beta: 1.00 | Loss: 141.3118 | NLL: 40.0581 | KL: 101.2537
Epoch 0470 | Beta: 1.00 | Loss: 148.3592 | NLL: 47.2532 | KL: 101.1060
Epoch 0480 | Beta: 1.00 | Loss: 138.4875 | NLL: 39.2014 | KL: 99.2860
Epoch 0490 | Beta: 1.00 | Loss: 141.9422 | NLL: 41.4603 | KL: 100.4819
Epoch 0500 | Beta: 1.00 | Loss: 141.8663 | NLL: 42.2366 | KL: 99.6296
Epoch 0510 | Beta: 1.00 | Loss: 138.4859 | NLL: 37.9880 | KL: 100.4979
Epoch 0520 | Beta: 1.00 | Loss: 135.9569 | NLL: 36.2542 | KL: 99.7028
Epoch 0530 | Beta: 1.00 | Loss: 141.0925 | NLL: 43.1008 | KL: 97.9917
Epoch 0540 | Beta: 1.00 | Loss: 137.4677 | NLL: 39.0174 | KL: 98.4503
Epoch 0550 | Beta: 1.00 | Loss: 139.1565 | NLL: 41.0101 | KL: 98.1463
Epoch 0560 | Beta: 1.00 | Loss: 139.2974 | NLL: 39.2545 | KL: 100.0429
Epoch 0570 | Beta: 1.00 | Loss: 138.3521 | NLL: 40.3647 | KL: 97.9874
Epoch 0580 | Beta: 1.00 | Loss: 138.7625 | NLL: 40.9828 | KL: 97.7797
Epoch 0590 | Beta: 1.00 | Loss: 134.6644 | NLL: 36.3981 | KL: 98.2662
Epoch 0600 | Beta: 1.00 | Loss: 133.5938 | NLL: 36.4032 | KL: 97.1906
Epoch 0610 | Beta: 1.00 | Loss: 134.5915 | NLL: 37.3160 | KL: 97.2754
Epoch 0620 | Beta: 1.00 | Loss: 134.9649 | NLL: 38.1136 | KL: 96.8514
Epoch 0630 | Beta: 1.00 | Loss: 132.0973 | NLL: 35.0503 | KL: 97.0469
Epoch 0640 | Beta: 1.00 | Loss: 133.6444 | NLL: 34.8623 | KL: 98.7820
Epoch 0650 | Beta: 1.00 | Loss: 137.2428 | NLL: 39.9185 | KL: 97.3243
Epoch 0660 | Beta: 1.00 | Loss: 132.5627 | NLL: 35.2648 | KL: 97.2979
Epoch 0670 | Beta: 1.00 | Loss: 133.8711 | NLL: 37.2356 | KL: 96.6355
Epoch 0680 | Beta: 1.00 | Loss: 131.2458 | NLL: 34.5158 | KL: 96.7300
Epoch 0690 | Beta: 1.00 | Loss: 131.7610 | NLL: 35.3431 | KL: 96.4179
Epoch 0700 | Beta: 1.00 | Loss: 133.6881 | NLL: 35.8066 | KL: 97.8816
Epoch 0710 | Beta: 1.00 | Loss: 131.5747 | NLL: 35.1186 | KL: 96.4561
Epoch 0720 | Beta: 1.00 | Loss: 131.8726 | NLL: 35.2554 | KL: 96.6172
Epoch 0730 | Beta: 1.00 | Loss: 130.4634 | NLL: 32.9051 | KL: 97.5583
Epoch 0740 | Beta: 1.00 | Loss: 131.8679 | NLL: 35.5765 | KL: 96.2914
Epoch 0750 | Beta: 1.00 | Loss: 132.2914 | NLL: 35.5098 | KL: 96.7816
Epoch 0760 | Beta: 1.00 | Loss: 129.3571 | NLL: 34.5836 | KL: 94.7734
Epoch 0770 | Beta: 1.00 | Loss: 137.4131 | NLL: 41.9217 | KL: 95.4914
Epoch 0780 | Beta: 1.00 | Loss: 129.5473 | NLL: 33.9901 | KL: 95.5572
Epoch 0790 | Beta: 1.00 | Loss: 143.9869 | NLL: 48.7677 | KL: 95.2193
Epoch 0800 | Beta: 1.00 | Loss: 127.4770 | NLL: 32.5291 | KL: 94.9479
Epoch 0810 | Beta: 1.00 | Loss: 130.9994 | NLL: 36.3485 | KL: 94.6509
Epoch 0820 | Beta: 1.00 | Loss: 129.8379 | NLL: 33.9877 | KL: 95.8503
Epoch 0830 | Beta: 1.00 | Loss: 127.4339 | NLL: 32.9586 | KL: 94.4753
Epoch 0840 | Beta: 1.00 | Loss: 130.3826 | NLL: 33.9412 | KL: 96.4414
Epoch 0850 | Beta: 1.00 | Loss: 126.5584 | NLL: 31.5531 | KL: 95.0053
Epoch 0860 | Beta: 1.00 | Loss: 128.2229 | NLL: 32.1328 | KL: 96.0900
Epoch 0870 | Beta: 1.00 | Loss: 126.1629 | NLL: 31.6572 | KL: 94.5058
Epoch 0880 | Beta: 1.00 | Loss: 126.7128 | NLL: 32.2249 | KL: 94.4880
Epoch 0890 | Beta: 1.00 | Loss: 129.3041 | NLL: 35.4037 | KL: 93.9003
Epoch 0900 | Beta: 1.00 | Loss: 129.6708 | NLL: 35.1928 | KL: 94.4780
Epoch 0910 | Beta: 1.00 | Loss: 125.7291 | NLL: 32.5504 | KL: 93.1787
Epoch 0920 | Beta: 1.00 | Loss: 125.7865 | NLL: 31.2554 | KL: 94.5310
Epoch 0930 | Beta: 1.00 | Loss: 135.7876 | NLL: 42.6104 | KL: 93.1772
Epoch 0940 | Beta: 1.00 | Loss: 126.1414 | NLL: 33.1913 | KL: 92.9501
Epoch 0950 | Beta: 1.00 | Loss: 133.0674 | NLL: 39.1899 | KL: 93.8775
Epoch 0960 | Beta: 1.00 | Loss: 125.9790 | NLL: 32.9712 | KL: 93.0078
Epoch 0970 | Beta: 1.00 | Loss: 130.1939 | NLL: 37.0024 | KL: 93.1915
Epoch 0980 | Beta: 1.00 | Loss: 128.8867 | NLL: 35.3470 | KL: 93.5397
Epoch 0990 | Beta: 1.00 | Loss: 125.0044 | NLL: 31.4090 | KL: 93.5954
Epoch 1000 | Beta: 1.00 | Loss: 129.4209 | NLL: 35.4369 | KL: 93.9839
Correlation Heatmap saved to paper_plots\run_20260103_021559/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1104
Violazioni Attese: 55.2
Violazioni Osservate: 31
Frequenza Osservata: 0.0281 (Target: 0.0500)
LR Statistic: 13.1816 | P-Value: 0.0003
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1044, n01=28, n10=28, n11=3
LR Independence: 3.4736 (p-value: 0.0624)
LR Conditional Coverage (CC): 16.6552 | P-Value CC: 0.0002
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_021559/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_030229
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_030229

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 26
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_030229
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 152.6260 | NLL: 145.3034 | KL: 81.3622
Epoch 0020 | Beta: 0.19 | Loss: 149.1778 | NLL: 137.1393 | KL: 63.3608
Epoch 0030 | Beta: 0.29 | Loss: 152.5357 | NLL: 134.6050 | KL: 61.8298
Epoch 0040 | Beta: 0.39 | Loss: 148.2402 | NLL: 123.5411 | KL: 63.3309
Epoch 0050 | Beta: 0.49 | Loss: 150.0899 | NLL: 119.5623 | KL: 62.3013
Epoch 0060 | Beta: 0.59 | Loss: 153.3413 | NLL: 117.3871 | KL: 60.9394
Epoch 0070 | Beta: 0.69 | Loss: 156.5285 | NLL: 114.8899 | KL: 60.3458
Epoch 0080 | Beta: 0.79 | Loss: 160.1574 | NLL: 112.4736 | KL: 60.3593
Epoch 0090 | Beta: 0.89 | Loss: 163.8407 | NLL: 110.0362 | KL: 60.4545
Epoch 0100 | Beta: 0.99 | Loss: 167.9743 | NLL: 107.6174 | KL: 60.9665
Epoch 0110 | Beta: 1.00 | Loss: 165.2353 | NLL: 102.9067 | KL: 62.3286
Epoch 0120 | Beta: 1.00 | Loss: 161.1375 | NLL: 96.1962 | KL: 64.9413
Epoch 0130 | Beta: 1.00 | Loss: 156.3486 | NLL: 88.9185 | KL: 67.4301
Epoch 0140 | Beta: 1.00 | Loss: 151.5115 | NLL: 81.4377 | KL: 70.0738
Epoch 0150 | Beta: 1.00 | Loss: 146.6898 | NLL: 75.3501 | KL: 71.3397
Epoch 0160 | Beta: 1.00 | Loss: 142.9279 | NLL: 69.4781 | KL: 73.4498
Epoch 0170 | Beta: 1.00 | Loss: 140.5561 | NLL: 66.8484 | KL: 73.7077
Epoch 0180 | Beta: 1.00 | Loss: 136.2429 | NLL: 62.5831 | KL: 73.6598
Epoch 0190 | Beta: 1.00 | Loss: 134.9552 | NLL: 61.1013 | KL: 73.8539
Epoch 0200 | Beta: 1.00 | Loss: 132.9307 | NLL: 57.3204 | KL: 75.6104
Epoch 0210 | Beta: 1.00 | Loss: 129.7519 | NLL: 54.6983 | KL: 75.0536
Epoch 0220 | Beta: 1.00 | Loss: 128.8835 | NLL: 53.2047 | KL: 75.6788
Epoch 0230 | Beta: 1.00 | Loss: 128.0952 | NLL: 52.2455 | KL: 75.8497
Epoch 0240 | Beta: 1.00 | Loss: 127.2092 | NLL: 51.5916 | KL: 75.6177
Epoch 0250 | Beta: 1.00 | Loss: 125.1181 | NLL: 48.6823 | KL: 76.4358
Epoch 0260 | Beta: 1.00 | Loss: 123.0256 | NLL: 47.1835 | KL: 75.8421
Epoch 0270 | Beta: 1.00 | Loss: 122.5689 | NLL: 46.3650 | KL: 76.2039
Epoch 0280 | Beta: 1.00 | Loss: 121.8223 | NLL: 46.2603 | KL: 75.5621
Epoch 0290 | Beta: 1.00 | Loss: 120.8544 | NLL: 44.2590 | KL: 76.5954
Epoch 0300 | Beta: 1.00 | Loss: 118.5075 | NLL: 41.7953 | KL: 76.7122
Epoch 0310 | Beta: 1.00 | Loss: 119.8706 | NLL: 43.6310 | KL: 76.2395
Epoch 0320 | Beta: 1.00 | Loss: 117.2454 | NLL: 40.9765 | KL: 76.2689
Epoch 0330 | Beta: 1.00 | Loss: 115.6518 | NLL: 39.0622 | KL: 76.5896
Epoch 0340 | Beta: 1.00 | Loss: 115.5864 | NLL: 38.3545 | KL: 77.2319
Epoch 0350 | Beta: 1.00 | Loss: 116.3989 | NLL: 40.9512 | KL: 75.4477
Epoch 0360 | Beta: 1.00 | Loss: 113.1510 | NLL: 37.3332 | KL: 75.8178
Epoch 0370 | Beta: 1.00 | Loss: 111.6681 | NLL: 35.6630 | KL: 76.0051
Epoch 0380 | Beta: 1.00 | Loss: 112.6860 | NLL: 36.9903 | KL: 75.6957
Epoch 0390 | Beta: 1.00 | Loss: 111.1692 | NLL: 35.3069 | KL: 75.8623
Epoch 0400 | Beta: 1.00 | Loss: 109.1354 | NLL: 33.7327 | KL: 75.4027
Epoch 0410 | Beta: 1.00 | Loss: 110.2746 | NLL: 32.9202 | KL: 77.3544
Epoch 0420 | Beta: 1.00 | Loss: 110.2135 | NLL: 34.4138 | KL: 75.7997
Epoch 0430 | Beta: 1.00 | Loss: 108.7303 | NLL: 32.0631 | KL: 76.6671
Epoch 0440 | Beta: 1.00 | Loss: 108.2794 | NLL: 33.3262 | KL: 74.9533
Epoch 0450 | Beta: 1.00 | Loss: 106.1714 | NLL: 29.9636 | KL: 76.2077
Epoch 0460 | Beta: 1.00 | Loss: 107.1321 | NLL: 32.6668 | KL: 74.4654
Epoch 0470 | Beta: 1.00 | Loss: 107.8627 | NLL: 33.5690 | KL: 74.2937
Epoch 0480 | Beta: 1.00 | Loss: 105.3701 | NLL: 31.1368 | KL: 74.2333
Epoch 0490 | Beta: 1.00 | Loss: 105.9137 | NLL: 29.0913 | KL: 76.8225
Epoch 0500 | Beta: 1.00 | Loss: 105.7249 | NLL: 30.5718 | KL: 75.1531
Epoch 0510 | Beta: 1.00 | Loss: 104.2744 | NLL: 30.5746 | KL: 73.6998
Epoch 0520 | Beta: 1.00 | Loss: 104.3646 | NLL: 30.6824 | KL: 73.6822
Epoch 0530 | Beta: 1.00 | Loss: 102.6739 | NLL: 28.3456 | KL: 74.3283
Epoch 0540 | Beta: 1.00 | Loss: 102.6295 | NLL: 29.1617 | KL: 73.4679
Epoch 0550 | Beta: 1.00 | Loss: 104.6827 | NLL: 30.6036 | KL: 74.0791
Epoch 0560 | Beta: 1.00 | Loss: 104.4029 | NLL: 30.9032 | KL: 73.4997
Epoch 0570 | Beta: 1.00 | Loss: 101.6396 | NLL: 27.7558 | KL: 73.8838
Epoch 0580 | Beta: 1.00 | Loss: 102.7650 | NLL: 28.9629 | KL: 73.8020
Epoch 0590 | Beta: 1.00 | Loss: 101.3109 | NLL: 27.8609 | KL: 73.4501
Epoch 0600 | Beta: 1.00 | Loss: 104.0550 | NLL: 30.6893 | KL: 73.3657
Epoch 0610 | Beta: 1.00 | Loss: 104.2796 | NLL: 31.5414 | KL: 72.7382
Epoch 0620 | Beta: 1.00 | Loss: 100.4860 | NLL: 26.5079 | KL: 73.9781
Epoch 0630 | Beta: 1.00 | Loss: 101.2158 | NLL: 26.7547 | KL: 74.4611
Epoch 0640 | Beta: 1.00 | Loss: 103.7484 | NLL: 30.8742 | KL: 72.8742
Epoch 0650 | Beta: 1.00 | Loss: 102.9320 | NLL: 29.8027 | KL: 73.1292
Epoch 0660 | Beta: 1.00 | Loss: 100.5620 | NLL: 26.3056 | KL: 74.2563
Epoch 0670 | Beta: 1.00 | Loss: 100.2283 | NLL: 27.1368 | KL: 73.0915
Epoch 0680 | Beta: 1.00 | Loss: 100.0097 | NLL: 27.1656 | KL: 72.8441
Epoch 0690 | Beta: 1.00 | Loss: 101.0808 | NLL: 27.5883 | KL: 73.4926
Epoch 0700 | Beta: 1.00 | Loss: 99.8648 | NLL: 24.5109 | KL: 75.3539
Epoch 0710 | Beta: 1.00 | Loss: 106.1969 | NLL: 33.2929 | KL: 72.9040
Epoch 0720 | Beta: 1.00 | Loss: 98.8064 | NLL: 27.2658 | KL: 71.5407
Epoch 0730 | Beta: 1.00 | Loss: 100.8492 | NLL: 27.6813 | KL: 73.1679
Epoch 0740 | Beta: 1.00 | Loss: 97.8120 | NLL: 25.8704 | KL: 71.9416
Epoch 0750 | Beta: 1.00 | Loss: 100.7772 | NLL: 28.0484 | KL: 72.7288
Epoch 0760 | Beta: 1.00 | Loss: 103.9010 | NLL: 30.6123 | KL: 73.2887
Epoch 0770 | Beta: 1.00 | Loss: 99.5006 | NLL: 25.9144 | KL: 73.5862
Epoch 0780 | Beta: 1.00 | Loss: 97.6673 | NLL: 25.1175 | KL: 72.5498
Epoch 0790 | Beta: 1.00 | Loss: 97.6778 | NLL: 25.1312 | KL: 72.5466
Epoch 0800 | Beta: 1.00 | Loss: 97.7164 | NLL: 24.3442 | KL: 73.3722
Epoch 0810 | Beta: 1.00 | Loss: 99.5573 | NLL: 26.4703 | KL: 73.0870
Epoch 0820 | Beta: 1.00 | Loss: 97.7094 | NLL: 24.6410 | KL: 73.0684
Epoch 0830 | Beta: 1.00 | Loss: 98.9205 | NLL: 27.2308 | KL: 71.6897
Epoch 0840 | Beta: 1.00 | Loss: 98.0396 | NLL: 25.0194 | KL: 73.0203
Epoch 0850 | Beta: 1.00 | Loss: 97.8857 | NLL: 25.8196 | KL: 72.0662
Epoch 0860 | Beta: 1.00 | Loss: 97.8676 | NLL: 24.4571 | KL: 73.4104
Epoch 0870 | Beta: 1.00 | Loss: 96.1490 | NLL: 23.7397 | KL: 72.4092
Epoch 0880 | Beta: 1.00 | Loss: 100.2884 | NLL: 27.5488 | KL: 72.7396
Epoch 0890 | Beta: 1.00 | Loss: 124.4641 | NLL: 50.6953 | KL: 73.7688
Epoch 0900 | Beta: 1.00 | Loss: 97.3222 | NLL: 25.1557 | KL: 72.1665
Epoch 0910 | Beta: 1.00 | Loss: 97.0031 | NLL: 25.3797 | KL: 71.6234
Epoch 0920 | Beta: 1.00 | Loss: 101.4818 | NLL: 27.2911 | KL: 74.1907
Epoch 0930 | Beta: 1.00 | Loss: 95.7800 | NLL: 24.6811 | KL: 71.0989
Epoch 0940 | Beta: 1.00 | Loss: 98.3055 | NLL: 26.9664 | KL: 71.3391
Epoch 0950 | Beta: 1.00 | Loss: 98.3073 | NLL: 27.1858 | KL: 71.1215
Epoch 0960 | Beta: 1.00 | Loss: 96.5818 | NLL: 25.2872 | KL: 71.2946
Epoch 0970 | Beta: 1.00 | Loss: 97.2550 | NLL: 23.7109 | KL: 73.5441
Epoch 0980 | Beta: 1.00 | Loss: 95.3004 | NLL: 23.4336 | KL: 71.8668
Epoch 0990 | Beta: 1.00 | Loss: 96.6969 | NLL: 25.0796 | KL: 71.6173
Epoch 1000 | Beta: 1.00 | Loss: 95.8167 | NLL: 23.2296 | KL: 72.5872
Correlation Heatmap saved to paper_plots\run_20260103_030229/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1103
Violazioni Attese: 55.2
Violazioni Osservate: 44
Frequenza Osservata: 0.0399 (Target: 0.0500)
LR Statistic: 2.5419 | P-Value: 0.1109
RISULTATO: NON RIGETTO H0. Il modello è statisticamente Valido.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1017, n01=41, n10=41, n11=3
LR Independence: 0.7997 (p-value: 0.3712)
LR Conditional Coverage (CC): 3.3416 | P-Value CC: 0.1881
RISULTATO: NON RIGETTO H0. Il modello è Valido Condizionalmente.
Grafico regimi salvato in 'paper_plots\run_20260103_030229/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_035145
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_035145

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 27
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_035145
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 150.4660 | NLL: 146.3443 | KL: 45.7964
Epoch 0020 | Beta: 0.19 | Loss: 144.5383 | NLL: 136.4578 | KL: 42.5287
Epoch 0030 | Beta: 0.29 | Loss: 138.9724 | NLL: 127.3785 | KL: 39.9792
Epoch 0040 | Beta: 0.39 | Loss: 138.3972 | NLL: 123.6472 | KL: 37.8207
Epoch 0050 | Beta: 0.49 | Loss: 139.1605 | NLL: 120.4728 | KL: 38.1382
Epoch 0060 | Beta: 0.59 | Loss: 139.7806 | NLL: 117.0995 | KL: 38.4426
Epoch 0070 | Beta: 0.69 | Loss: 140.5604 | NLL: 113.0512 | KL: 39.8684
Epoch 0080 | Beta: 0.79 | Loss: 139.8780 | NLL: 107.0432 | KL: 41.5631
Epoch 0090 | Beta: 0.89 | Loss: 139.2541 | NLL: 99.8868 | KL: 44.2329
Epoch 0100 | Beta: 0.99 | Loss: 139.0079 | NLL: 93.1075 | KL: 46.3640
Epoch 0110 | Beta: 1.00 | Loss: 133.8256 | NLL: 85.0910 | KL: 48.7346
Epoch 0120 | Beta: 1.00 | Loss: 127.7872 | NLL: 77.4500 | KL: 50.3373
Epoch 0130 | Beta: 1.00 | Loss: 123.0025 | NLL: 71.2170 | KL: 51.7856
Epoch 0140 | Beta: 1.00 | Loss: 119.7574 | NLL: 66.0721 | KL: 53.6853
Epoch 0150 | Beta: 1.00 | Loss: 117.2572 | NLL: 63.3352 | KL: 53.9220
Epoch 0160 | Beta: 1.00 | Loss: 115.1188 | NLL: 61.0849 | KL: 54.0340
Epoch 0170 | Beta: 1.00 | Loss: 113.6804 | NLL: 58.5048 | KL: 55.1757
Epoch 0180 | Beta: 1.00 | Loss: 110.1453 | NLL: 55.2303 | KL: 54.9150
Epoch 0190 | Beta: 1.00 | Loss: 111.8422 | NLL: 56.8993 | KL: 54.9429
Epoch 0200 | Beta: 1.00 | Loss: 108.0945 | NLL: 54.1838 | KL: 53.9107
Epoch 0210 | Beta: 1.00 | Loss: 108.0161 | NLL: 53.2632 | KL: 54.7529
Epoch 0220 | Beta: 1.00 | Loss: 106.2325 | NLL: 52.3091 | KL: 53.9234
Epoch 0230 | Beta: 1.00 | Loss: 102.7466 | NLL: 48.7938 | KL: 53.9528
Epoch 0240 | Beta: 1.00 | Loss: 103.3643 | NLL: 48.7454 | KL: 54.6189
Epoch 0250 | Beta: 1.00 | Loss: 103.6932 | NLL: 49.4202 | KL: 54.2731
Epoch 0260 | Beta: 1.00 | Loss: 100.0184 | NLL: 45.0369 | KL: 54.9815
Epoch 0270 | Beta: 1.00 | Loss: 99.0808 | NLL: 44.0887 | KL: 54.9921
Epoch 0280 | Beta: 1.00 | Loss: 99.6653 | NLL: 45.2772 | KL: 54.3880
Epoch 0290 | Beta: 1.00 | Loss: 96.6421 | NLL: 42.9922 | KL: 53.6498
Epoch 0300 | Beta: 1.00 | Loss: 95.9405 | NLL: 42.4980 | KL: 53.4425
Epoch 0310 | Beta: 1.00 | Loss: 94.4300 | NLL: 40.2278 | KL: 54.2022
Epoch 0320 | Beta: 1.00 | Loss: 93.8928 | NLL: 40.2432 | KL: 53.6496
Epoch 0330 | Beta: 1.00 | Loss: 93.1416 | NLL: 39.0711 | KL: 54.0705
Epoch 0340 | Beta: 1.00 | Loss: 94.1898 | NLL: 40.7043 | KL: 53.4854
Epoch 0350 | Beta: 1.00 | Loss: 92.5814 | NLL: 38.8438 | KL: 53.7377
Epoch 0360 | Beta: 1.00 | Loss: 91.0215 | NLL: 37.5749 | KL: 53.4465
Epoch 0370 | Beta: 1.00 | Loss: 92.0457 | NLL: 38.6616 | KL: 53.3841
Epoch 0380 | Beta: 1.00 | Loss: 88.4351 | NLL: 35.6602 | KL: 52.7749
Epoch 0390 | Beta: 1.00 | Loss: 89.5311 | NLL: 35.7035 | KL: 53.8276
Epoch 0400 | Beta: 1.00 | Loss: 89.4575 | NLL: 37.1435 | KL: 52.3140
Epoch 0410 | Beta: 1.00 | Loss: 88.1904 | NLL: 35.4081 | KL: 52.7823
Epoch 0420 | Beta: 1.00 | Loss: 93.0125 | NLL: 40.6020 | KL: 52.4104
Epoch 0430 | Beta: 1.00 | Loss: 88.7255 | NLL: 34.8231 | KL: 53.9024
Epoch 0440 | Beta: 1.00 | Loss: 87.5852 | NLL: 35.9627 | KL: 51.6225
Epoch 0450 | Beta: 1.00 | Loss: 87.7464 | NLL: 34.4474 | KL: 53.2990
Epoch 0460 | Beta: 1.00 | Loss: 105.8388 | NLL: 53.0634 | KL: 52.7754
Epoch 0470 | Beta: 1.00 | Loss: 84.3145 | NLL: 31.4490 | KL: 52.8655
Epoch 0480 | Beta: 1.00 | Loss: 87.4217 | NLL: 32.5026 | KL: 54.9191
Epoch 0490 | Beta: 1.00 | Loss: 83.7981 | NLL: 30.9828 | KL: 52.8153
Epoch 0500 | Beta: 1.00 | Loss: 85.1556 | NLL: 31.1601 | KL: 53.9955
Epoch 0510 | Beta: 1.00 | Loss: 83.0308 | NLL: 30.9663 | KL: 52.0645
Epoch 0520 | Beta: 1.00 | Loss: 82.6892 | NLL: 30.1885 | KL: 52.5006
Epoch 0530 | Beta: 1.00 | Loss: 82.3241 | NLL: 30.5402 | KL: 51.7839
Epoch 0540 | Beta: 1.00 | Loss: 83.8410 | NLL: 29.6498 | KL: 54.1912
Epoch 0550 | Beta: 1.00 | Loss: 84.2610 | NLL: 32.0398 | KL: 52.2212
Epoch 0560 | Beta: 1.00 | Loss: 83.3497 | NLL: 30.8297 | KL: 52.5200
Epoch 0570 | Beta: 1.00 | Loss: 83.0557 | NLL: 31.9729 | KL: 51.0828
Epoch 0580 | Beta: 1.00 | Loss: 92.9981 | NLL: 40.6600 | KL: 52.3381
Epoch 0590 | Beta: 1.00 | Loss: 82.6520 | NLL: 31.3475 | KL: 51.3045
Epoch 0600 | Beta: 1.00 | Loss: 80.9300 | NLL: 28.0909 | KL: 52.8390
Epoch 0610 | Beta: 1.00 | Loss: 80.3414 | NLL: 29.6555 | KL: 50.6859
Epoch 0620 | Beta: 1.00 | Loss: 80.1688 | NLL: 29.7986 | KL: 50.3702
Epoch 0630 | Beta: 1.00 | Loss: 81.4451 | NLL: 30.2639 | KL: 51.1811
Epoch 0640 | Beta: 1.00 | Loss: 84.0719 | NLL: 32.8528 | KL: 51.2191
Epoch 0650 | Beta: 1.00 | Loss: 82.3381 | NLL: 29.8192 | KL: 52.5189
Epoch 0660 | Beta: 1.00 | Loss: 83.3652 | NLL: 32.1535 | KL: 51.2117
Epoch 0670 | Beta: 1.00 | Loss: 80.2517 | NLL: 28.0848 | KL: 52.1669
Epoch 0680 | Beta: 1.00 | Loss: 80.8324 | NLL: 30.2497 | KL: 50.5827
Epoch 0690 | Beta: 1.00 | Loss: 80.7742 | NLL: 30.4406 | KL: 50.3336
Epoch 0700 | Beta: 1.00 | Loss: 78.0919 | NLL: 26.3238 | KL: 51.7681
Epoch 0710 | Beta: 1.00 | Loss: 78.6478 | NLL: 28.0234 | KL: 50.6244
Epoch 0720 | Beta: 1.00 | Loss: 83.3752 | NLL: 33.2380 | KL: 50.1372
Epoch 0730 | Beta: 1.00 | Loss: 78.1213 | NLL: 28.6429 | KL: 49.4784
Epoch 0740 | Beta: 1.00 | Loss: 78.4895 | NLL: 26.7334 | KL: 51.7560
Epoch 0750 | Beta: 1.00 | Loss: 77.6580 | NLL: 26.4983 | KL: 51.1597
Epoch 0760 | Beta: 1.00 | Loss: 78.5508 | NLL: 28.0379 | KL: 50.5129
Epoch 0770 | Beta: 1.00 | Loss: 80.2918 | NLL: 30.7795 | KL: 49.5123
Epoch 0780 | Beta: 1.00 | Loss: 96.1939 | NLL: 46.2490 | KL: 49.9449
Epoch 0790 | Beta: 1.00 | Loss: 76.2977 | NLL: 27.0093 | KL: 49.2883
Epoch 0800 | Beta: 1.00 | Loss: 76.7895 | NLL: 27.3109 | KL: 49.4787
Epoch 0810 | Beta: 1.00 | Loss: 78.2659 | NLL: 28.9844 | KL: 49.2816
Epoch 0820 | Beta: 1.00 | Loss: 80.2995 | NLL: 29.7950 | KL: 50.5044
Epoch 0830 | Beta: 1.00 | Loss: 77.6524 | NLL: 26.7023 | KL: 50.9501
Epoch 0840 | Beta: 1.00 | Loss: 77.6801 | NLL: 26.9385 | KL: 50.7416
Epoch 0850 | Beta: 1.00 | Loss: 77.4883 | NLL: 25.5426 | KL: 51.9457
Epoch 0860 | Beta: 1.00 | Loss: 77.3343 | NLL: 27.5945 | KL: 49.7398
Epoch 0870 | Beta: 1.00 | Loss: 78.6083 | NLL: 26.5021 | KL: 52.1062
Epoch 0880 | Beta: 1.00 | Loss: 74.9432 | NLL: 26.3052 | KL: 48.6379
Epoch 0890 | Beta: 1.00 | Loss: 75.8791 | NLL: 26.1996 | KL: 49.6795
Epoch 0900 | Beta: 1.00 | Loss: 75.9088 | NLL: 25.2697 | KL: 50.6391
Epoch 0910 | Beta: 1.00 | Loss: 75.1294 | NLL: 25.7016 | KL: 49.4278
Epoch 0920 | Beta: 1.00 | Loss: 77.0214 | NLL: 25.5997 | KL: 51.4217
Epoch 0930 | Beta: 1.00 | Loss: 80.9868 | NLL: 30.8550 | KL: 50.1318
Epoch 0940 | Beta: 1.00 | Loss: 75.1911 | NLL: 25.9902 | KL: 49.2009
Epoch 0950 | Beta: 1.00 | Loss: 75.6805 | NLL: 25.2121 | KL: 50.4684
Epoch 0960 | Beta: 1.00 | Loss: 75.0642 | NLL: 25.9926 | KL: 49.0717
Epoch 0970 | Beta: 1.00 | Loss: 73.4790 | NLL: 26.0855 | KL: 47.3936
Epoch 0980 | Beta: 1.00 | Loss: 75.5115 | NLL: 26.9513 | KL: 48.5602
Epoch 0990 | Beta: 1.00 | Loss: 75.1212 | NLL: 25.5767 | KL: 49.5446
Epoch 1000 | Beta: 1.00 | Loss: 75.2340 | NLL: 26.0180 | KL: 49.2160
Correlation Heatmap saved to paper_plots\run_20260103_035145/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1102
Violazioni Attese: 55.1
Violazioni Osservate: 39
Frequenza Osservata: 0.0354 (Target: 0.0500)
LR Statistic: 5.4905 | P-Value: 0.0191
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1026, n01=36, n10=36, n11=3
LR Independence: 1.5596 (p-value: 0.2117)
LR Conditional Coverage (CC): 7.0501 | P-Value CC: 0.0295
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_035145/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_044243
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_044243

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 28
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_044243
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 156.0762 | NLL: 149.6563 | KL: 71.3327
Epoch 0020 | Beta: 0.19 | Loss: 142.6175 | NLL: 128.8321 | KL: 72.5545
Epoch 0030 | Beta: 0.29 | Loss: 144.0105 | NLL: 124.0145 | KL: 68.9519
Epoch 0040 | Beta: 0.39 | Loss: 144.4775 | NLL: 117.0167 | KL: 70.4123
Epoch 0050 | Beta: 0.49 | Loss: 143.6930 | NLL: 107.6685 | KL: 73.5194
Epoch 0060 | Beta: 0.59 | Loss: 143.7012 | NLL: 99.1240 | KL: 75.5545
Epoch 0070 | Beta: 0.69 | Loss: 144.0311 | NLL: 91.3181 | KL: 76.3956
Epoch 0080 | Beta: 0.79 | Loss: 146.2516 | NLL: 85.3763 | KL: 77.0573
Epoch 0090 | Beta: 0.89 | Loss: 148.9258 | NLL: 80.2639 | KL: 77.1482
Epoch 0100 | Beta: 0.99 | Loss: 153.4174 | NLL: 77.6175 | KL: 76.5655
Epoch 0110 | Beta: 1.00 | Loss: 150.1903 | NLL: 73.6857 | KL: 76.5046
Epoch 0120 | Beta: 1.00 | Loss: 146.7040 | NLL: 69.5464 | KL: 77.1576
Epoch 0130 | Beta: 1.00 | Loss: 144.7311 | NLL: 67.7128 | KL: 77.0183
Epoch 0140 | Beta: 1.00 | Loss: 142.4260 | NLL: 64.5462 | KL: 77.8798
Epoch 0150 | Beta: 1.00 | Loss: 140.5496 | NLL: 62.7102 | KL: 77.8394
Epoch 0160 | Beta: 1.00 | Loss: 137.2344 | NLL: 59.6060 | KL: 77.6284
Epoch 0170 | Beta: 1.00 | Loss: 136.0359 | NLL: 58.3856 | KL: 77.6502
Epoch 0180 | Beta: 1.00 | Loss: 132.2185 | NLL: 53.8882 | KL: 78.3303
Epoch 0190 | Beta: 1.00 | Loss: 131.2811 | NLL: 52.9311 | KL: 78.3500
Epoch 0200 | Beta: 1.00 | Loss: 145.7423 | NLL: 67.9514 | KL: 77.7908
Epoch 0210 | Beta: 1.00 | Loss: 126.8337 | NLL: 48.2490 | KL: 78.5847
Epoch 0220 | Beta: 1.00 | Loss: 125.8235 | NLL: 48.0239 | KL: 77.7996
Epoch 0230 | Beta: 1.00 | Loss: 129.5610 | NLL: 52.5889 | KL: 76.9721
Epoch 0240 | Beta: 1.00 | Loss: 122.4384 | NLL: 43.9502 | KL: 78.4882
Epoch 0250 | Beta: 1.00 | Loss: 120.6942 | NLL: 43.0600 | KL: 77.6342
Epoch 0260 | Beta: 1.00 | Loss: 119.9532 | NLL: 42.8069 | KL: 77.1463
Epoch 0270 | Beta: 1.00 | Loss: 120.7799 | NLL: 43.1606 | KL: 77.6194
Epoch 0280 | Beta: 1.00 | Loss: 120.1768 | NLL: 43.0161 | KL: 77.1607
Epoch 0290 | Beta: 1.00 | Loss: 116.5854 | NLL: 40.3081 | KL: 76.2773
Epoch 0300 | Beta: 1.00 | Loss: 116.4358 | NLL: 39.6133 | KL: 76.8225
Epoch 0310 | Beta: 1.00 | Loss: 114.9426 | NLL: 38.9257 | KL: 76.0169
Epoch 0320 | Beta: 1.00 | Loss: 114.8236 | NLL: 39.2511 | KL: 75.5725
Epoch 0330 | Beta: 1.00 | Loss: 114.5847 | NLL: 39.5332 | KL: 75.0515
Epoch 0340 | Beta: 1.00 | Loss: 114.8482 | NLL: 39.2678 | KL: 75.5805
Epoch 0350 | Beta: 1.00 | Loss: 113.1758 | NLL: 38.4636 | KL: 74.7122
Epoch 0360 | Beta: 1.00 | Loss: 114.8063 | NLL: 39.6945 | KL: 75.1118
Epoch 0370 | Beta: 1.00 | Loss: 112.6756 | NLL: 37.5006 | KL: 75.1750
Epoch 0380 | Beta: 1.00 | Loss: 114.8365 | NLL: 39.3223 | KL: 75.5142
Epoch 0390 | Beta: 1.00 | Loss: 111.0172 | NLL: 36.1142 | KL: 74.9031
Epoch 0400 | Beta: 1.00 | Loss: 110.6902 | NLL: 36.0221 | KL: 74.6681
Epoch 0410 | Beta: 1.00 | Loss: 109.4457 | NLL: 34.8261 | KL: 74.6196
Epoch 0420 | Beta: 1.00 | Loss: 108.1400 | NLL: 33.8691 | KL: 74.2709
Epoch 0430 | Beta: 1.00 | Loss: 107.7685 | NLL: 33.7689 | KL: 73.9996
Epoch 0440 | Beta: 1.00 | Loss: 107.6092 | NLL: 33.5097 | KL: 74.0996
Epoch 0450 | Beta: 1.00 | Loss: 107.7164 | NLL: 34.5621 | KL: 73.1543
Epoch 0460 | Beta: 1.00 | Loss: 110.0838 | NLL: 36.2470 | KL: 73.8368
Epoch 0470 | Beta: 1.00 | Loss: 108.8604 | NLL: 35.0703 | KL: 73.7901
Epoch 0480 | Beta: 1.00 | Loss: 107.0178 | NLL: 33.7204 | KL: 73.2973
Epoch 0490 | Beta: 1.00 | Loss: 111.2203 | NLL: 38.2259 | KL: 72.9943
Epoch 0500 | Beta: 1.00 | Loss: 105.2024 | NLL: 31.7651 | KL: 73.4373
Epoch 0510 | Beta: 1.00 | Loss: 104.5740 | NLL: 32.0673 | KL: 72.5067
Epoch 0520 | Beta: 1.00 | Loss: 105.5546 | NLL: 32.0039 | KL: 73.5507
Epoch 0530 | Beta: 1.00 | Loss: 104.7342 | NLL: 32.6128 | KL: 72.1214
Epoch 0540 | Beta: 1.00 | Loss: 104.5567 | NLL: 32.1107 | KL: 72.4460
Epoch 0550 | Beta: 1.00 | Loss: 106.5600 | NLL: 33.3874 | KL: 73.1726
Epoch 0560 | Beta: 1.00 | Loss: 102.8892 | NLL: 31.7042 | KL: 71.1850
Epoch 0570 | Beta: 1.00 | Loss: 104.0629 | NLL: 31.4419 | KL: 72.6210
Epoch 0580 | Beta: 1.00 | Loss: 104.3286 | NLL: 32.5602 | KL: 71.7684
Epoch 0590 | Beta: 1.00 | Loss: 103.7765 | NLL: 32.8246 | KL: 70.9518
Epoch 0600 | Beta: 1.00 | Loss: 102.8839 | NLL: 31.8974 | KL: 70.9865
Epoch 0610 | Beta: 1.00 | Loss: 103.3319 | NLL: 32.4080 | KL: 70.9239
Epoch 0620 | Beta: 1.00 | Loss: 102.0319 | NLL: 30.9475 | KL: 71.0843
Epoch 0630 | Beta: 1.00 | Loss: 101.4481 | NLL: 31.0325 | KL: 70.4156
Epoch 0640 | Beta: 1.00 | Loss: 105.6317 | NLL: 34.5043 | KL: 71.1274
Epoch 0650 | Beta: 1.00 | Loss: 101.0735 | NLL: 29.7642 | KL: 71.3093
Epoch 0660 | Beta: 1.00 | Loss: 99.8492 | NLL: 29.5975 | KL: 70.2517
Epoch 0670 | Beta: 1.00 | Loss: 102.5659 | NLL: 31.7953 | KL: 70.7706
Epoch 0680 | Beta: 1.00 | Loss: 102.4629 | NLL: 31.3153 | KL: 71.1476
Epoch 0690 | Beta: 1.00 | Loss: 102.7671 | NLL: 30.8294 | KL: 71.9377
Epoch 0700 | Beta: 1.00 | Loss: 103.4559 | NLL: 33.3603 | KL: 70.0957
Epoch 0710 | Beta: 1.00 | Loss: 105.3839 | NLL: 34.3740 | KL: 71.0099
Epoch 0720 | Beta: 1.00 | Loss: 100.2136 | NLL: 29.5859 | KL: 70.6277
Epoch 0730 | Beta: 1.00 | Loss: 98.4167 | NLL: 29.2420 | KL: 69.1747
Epoch 0740 | Beta: 1.00 | Loss: 102.2605 | NLL: 32.8270 | KL: 69.4335
Epoch 0750 | Beta: 1.00 | Loss: 98.6375 | NLL: 29.5541 | KL: 69.0834
Epoch 0760 | Beta: 1.00 | Loss: 99.2760 | NLL: 29.6628 | KL: 69.6132
Epoch 0770 | Beta: 1.00 | Loss: 99.1882 | NLL: 29.2715 | KL: 69.9167
Epoch 0780 | Beta: 1.00 | Loss: 99.5542 | NLL: 30.3101 | KL: 69.2441
Epoch 0790 | Beta: 1.00 | Loss: 99.0912 | NLL: 28.9329 | KL: 70.1583
Epoch 0800 | Beta: 1.00 | Loss: 99.6698 | NLL: 30.3464 | KL: 69.3234
Epoch 0810 | Beta: 1.00 | Loss: 98.2830 | NLL: 29.5973 | KL: 68.6857
Epoch 0820 | Beta: 1.00 | Loss: 101.0934 | NLL: 32.0729 | KL: 69.0205
Epoch 0830 | Beta: 1.00 | Loss: 97.8154 | NLL: 28.8292 | KL: 68.9862
Epoch 0840 | Beta: 1.00 | Loss: 97.5597 | NLL: 28.6281 | KL: 68.9316
Epoch 0850 | Beta: 1.00 | Loss: 99.8975 | NLL: 31.9343 | KL: 67.9632
Epoch 0860 | Beta: 1.00 | Loss: 98.5478 | NLL: 28.9318 | KL: 69.6160
Epoch 0870 | Beta: 1.00 | Loss: 97.1668 | NLL: 28.0746 | KL: 69.0923
Epoch 0880 | Beta: 1.00 | Loss: 97.1817 | NLL: 29.3909 | KL: 67.7908
Epoch 0890 | Beta: 1.00 | Loss: 125.0430 | NLL: 55.0773 | KL: 69.9657
Epoch 0900 | Beta: 1.00 | Loss: 101.7609 | NLL: 33.3328 | KL: 68.4281
Epoch 0910 | Beta: 1.00 | Loss: 97.5927 | NLL: 28.3676 | KL: 69.2251
Epoch 0920 | Beta: 1.00 | Loss: 97.4759 | NLL: 28.8243 | KL: 68.6515
Epoch 0930 | Beta: 1.00 | Loss: 99.9903 | NLL: 31.4942 | KL: 68.4961
Epoch 0940 | Beta: 1.00 | Loss: 100.7577 | NLL: 32.6781 | KL: 68.0796
Epoch 0950 | Beta: 1.00 | Loss: 97.9547 | NLL: 28.2629 | KL: 69.6918
Epoch 0960 | Beta: 1.00 | Loss: 106.1566 | NLL: 36.9370 | KL: 69.2196
Epoch 0970 | Beta: 1.00 | Loss: 98.9235 | NLL: 29.1628 | KL: 69.7607
Epoch 0980 | Beta: 1.00 | Loss: 95.7744 | NLL: 27.1298 | KL: 68.6446
Epoch 0990 | Beta: 1.00 | Loss: 96.5947 | NLL: 27.8477 | KL: 68.7470
Epoch 1000 | Beta: 1.00 | Loss: 96.7716 | NLL: 27.9059 | KL: 68.8657
Correlation Heatmap saved to paper_plots\run_20260103_044243/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1101
Violazioni Attese: 55.1
Violazioni Osservate: 26
Frequenza Osservata: 0.0236 (Target: 0.0500)
LR Statistic: 19.8919 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1051, n01=23, n10=23, n11=3
LR Independence: 5.2105 (p-value: 0.0225)
LR Conditional Coverage (CC): 25.1024 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_044243/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_053524
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_053524

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 29
latent_dim: 10
hidden_dim: 16
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_053524
device: cuda
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 174.5871 | NLL: 162.9530 | KL: 129.2680
Epoch 0020 | Beta: 0.19 | Loss: 174.6906 | NLL: 153.4992 | KL: 111.5335
Epoch 0030 | Beta: 0.29 | Loss: 180.6136 | NLL: 150.2451 | KL: 104.7192
Epoch 0040 | Beta: 0.39 | Loss: 178.9087 | NLL: 139.1170 | KL: 102.0300
Epoch 0050 | Beta: 0.49 | Loss: 183.2929 | NLL: 134.7000 | KL: 99.1691
Epoch 0060 | Beta: 0.59 | Loss: 190.6258 | NLL: 133.0190 | KL: 97.6386
Epoch 0070 | Beta: 0.69 | Loss: 197.0209 | NLL: 131.0068 | KL: 95.6726
Epoch 0080 | Beta: 0.79 | Loss: 204.0101 | NLL: 129.4978 | KL: 94.3194
Epoch 0090 | Beta: 0.89 | Loss: 209.9265 | NLL: 127.4169 | KL: 92.7074
Epoch 0100 | Beta: 0.99 | Loss: 217.9527 | NLL: 126.0822 | KL: 92.7984
Epoch 0110 | Beta: 1.00 | Loss: 217.0727 | NLL: 124.4052 | KL: 92.6675
Epoch 0120 | Beta: 1.00 | Loss: 214.8710 | NLL: 122.7344 | KL: 92.1367
Epoch 0130 | Beta: 1.00 | Loss: 213.4031 | NLL: 120.8374 | KL: 92.5657
Epoch 0140 | Beta: 1.00 | Loss: 211.4441 | NLL: 117.8827 | KL: 93.5614
Epoch 0150 | Beta: 1.00 | Loss: 208.5835 | NLL: 114.2667 | KL: 94.3168
Epoch 0160 | Beta: 1.00 | Loss: 205.5148 | NLL: 109.0827 | KL: 96.4320
Epoch 0170 | Beta: 1.00 | Loss: 202.3703 | NLL: 103.7213 | KL: 98.6490
Epoch 0180 | Beta: 1.00 | Loss: 197.8400 | NLL: 96.8070 | KL: 101.0330
Epoch 0190 | Beta: 1.00 | Loss: 194.3404 | NLL: 91.3168 | KL: 103.0236
Epoch 0200 | Beta: 1.00 | Loss: 191.9359 | NLL: 88.3661 | KL: 103.5698
Epoch 0210 | Beta: 1.00 | Loss: 188.2925 | NLL: 83.2850 | KL: 105.0075
Epoch 0220 | Beta: 1.00 | Loss: 184.5013 | NLL: 78.6636 | KL: 105.8377
Epoch 0230 | Beta: 1.00 | Loss: 181.8586 | NLL: 75.0726 | KL: 106.7860
Epoch 0240 | Beta: 1.00 | Loss: 180.7696 | NLL: 72.9142 | KL: 107.8554
Epoch 0250 | Beta: 1.00 | Loss: 177.4952 | NLL: 69.4049 | KL: 108.0902
Epoch 0260 | Beta: 1.00 | Loss: 175.1940 | NLL: 66.2367 | KL: 108.9573
Epoch 0270 | Beta: 1.00 | Loss: 172.7230 | NLL: 63.5756 | KL: 109.1474
Epoch 0280 | Beta: 1.00 | Loss: 171.8665 | NLL: 62.7499 | KL: 109.1166
Epoch 0290 | Beta: 1.00 | Loss: 169.3101 | NLL: 59.0739 | KL: 110.2362
Epoch 0300 | Beta: 1.00 | Loss: 171.0165 | NLL: 60.4789 | KL: 110.5376
Epoch 0310 | Beta: 1.00 | Loss: 164.0768 | NLL: 53.6222 | KL: 110.4546
Epoch 0320 | Beta: 1.00 | Loss: 163.0784 | NLL: 52.9805 | KL: 110.0979
Epoch 0330 | Beta: 1.00 | Loss: 162.7332 | NLL: 51.8032 | KL: 110.9300
Epoch 0340 | Beta: 1.00 | Loss: 160.1838 | NLL: 50.4925 | KL: 109.6912
Epoch 0350 | Beta: 1.00 | Loss: 160.0213 | NLL: 49.2691 | KL: 110.7522
Epoch 0360 | Beta: 1.00 | Loss: 157.8402 | NLL: 47.8337 | KL: 110.0065
Epoch 0370 | Beta: 1.00 | Loss: 155.7794 | NLL: 46.0622 | KL: 109.7172
Epoch 0380 | Beta: 1.00 | Loss: 156.9363 | NLL: 47.2128 | KL: 109.7235
Epoch 0390 | Beta: 1.00 | Loss: 156.0752 | NLL: 45.3977 | KL: 110.6774
Epoch 0400 | Beta: 1.00 | Loss: 154.8438 | NLL: 44.5942 | KL: 110.2497
Epoch 0410 | Beta: 1.00 | Loss: 152.9604 | NLL: 44.6327 | KL: 108.3277
Epoch 0420 | Beta: 1.00 | Loss: 150.3637 | NLL: 41.3045 | KL: 109.0591
Epoch 0430 | Beta: 1.00 | Loss: 151.2178 | NLL: 43.2169 | KL: 108.0010
Epoch 0440 | Beta: 1.00 | Loss: 150.0943 | NLL: 42.3693 | KL: 107.7250
Epoch 0450 | Beta: 1.00 | Loss: 148.4926 | NLL: 41.8542 | KL: 106.6384
Epoch 0460 | Beta: 1.00 | Loss: 147.9628 | NLL: 41.7662 | KL: 106.1966
Epoch 0470 | Beta: 1.00 | Loss: 148.1137 | NLL: 40.6937 | KL: 107.4200
Epoch 0480 | Beta: 1.00 | Loss: 145.7152 | NLL: 40.9320 | KL: 104.7832
Epoch 0490 | Beta: 1.00 | Loss: 147.0079 | NLL: 40.2746 | KL: 106.7332
Epoch 0500 | Beta: 1.00 | Loss: 145.9505 | NLL: 38.1348 | KL: 107.8157
Epoch 0510 | Beta: 1.00 | Loss: 144.3740 | NLL: 39.2951 | KL: 105.0789
Epoch 0520 | Beta: 1.00 | Loss: 143.0320 | NLL: 37.5664 | KL: 105.4656
Epoch 0530 | Beta: 1.00 | Loss: 152.0326 | NLL: 46.4095 | KL: 105.6232
Epoch 0540 | Beta: 1.00 | Loss: 142.4094 | NLL: 35.7304 | KL: 106.6790
Epoch 0550 | Beta: 1.00 | Loss: 142.1476 | NLL: 36.8036 | KL: 105.3439
Epoch 0560 | Beta: 1.00 | Loss: 139.7013 | NLL: 35.1572 | KL: 104.5441
Epoch 0570 | Beta: 1.00 | Loss: 143.3672 | NLL: 36.7862 | KL: 106.5810
Epoch 0580 | Beta: 1.00 | Loss: 140.4656 | NLL: 34.9760 | KL: 105.4897
Epoch 0590 | Beta: 1.00 | Loss: 140.2871 | NLL: 34.4778 | KL: 105.8093
Epoch 0600 | Beta: 1.00 | Loss: 139.2475 | NLL: 35.7614 | KL: 103.4861
Epoch 0610 | Beta: 1.00 | Loss: 140.2632 | NLL: 35.5816 | KL: 104.6816
Epoch 0620 | Beta: 1.00 | Loss: 139.3560 | NLL: 35.2990 | KL: 104.0570
Epoch 0630 | Beta: 1.00 | Loss: 163.2506 | NLL: 60.3242 | KL: 102.9264
Epoch 0640 | Beta: 1.00 | Loss: 138.3781 | NLL: 34.1808 | KL: 104.1973
Epoch 0650 | Beta: 1.00 | Loss: 135.8443 | NLL: 34.1956 | KL: 101.6488
Epoch 0660 | Beta: 1.00 | Loss: 136.7199 | NLL: 32.7560 | KL: 103.9639
Epoch 0670 | Beta: 1.00 | Loss: 138.0562 | NLL: 34.5676 | KL: 103.4886
Epoch 0680 | Beta: 1.00 | Loss: 135.9049 | NLL: 33.5621 | KL: 102.3428
Epoch 0690 | Beta: 1.00 | Loss: 135.3975 | NLL: 33.1170 | KL: 102.2804
Epoch 0700 | Beta: 1.00 | Loss: 136.4752 | NLL: 33.9231 | KL: 102.5520
Epoch 0710 | Beta: 1.00 | Loss: 133.7562 | NLL: 31.9960 | KL: 101.7601
Epoch 0720 | Beta: 1.00 | Loss: 135.9788 | NLL: 34.4736 | KL: 101.5052
Epoch 0730 | Beta: 1.00 | Loss: 136.0294 | NLL: 32.9743 | KL: 103.0551
Epoch 0740 | Beta: 1.00 | Loss: 135.0849 | NLL: 33.3551 | KL: 101.7298
Epoch 0750 | Beta: 1.00 | Loss: 133.9419 | NLL: 32.2161 | KL: 101.7258
Epoch 0760 | Beta: 1.00 | Loss: 133.8706 | NLL: 31.8198 | KL: 102.0508
Epoch 0770 | Beta: 1.00 | Loss: 134.9482 | NLL: 34.0866 | KL: 100.8617
Epoch 0780 | Beta: 1.00 | Loss: 133.9353 | NLL: 31.8115 | KL: 102.1238
Epoch 0790 | Beta: 1.00 | Loss: 133.9003 | NLL: 32.8296 | KL: 101.0708
Epoch 0800 | Beta: 1.00 | Loss: 132.8787 | NLL: 31.1517 | KL: 101.7270
Epoch 0810 | Beta: 1.00 | Loss: 135.3512 | NLL: 32.6099 | KL: 102.7414
Epoch 0820 | Beta: 1.00 | Loss: 132.4096 | NLL: 32.0038 | KL: 100.4058
Epoch 0830 | Beta: 1.00 | Loss: 131.9795 | NLL: 30.2598 | KL: 101.7197
Epoch 0840 | Beta: 1.00 | Loss: 137.3740 | NLL: 36.3400 | KL: 101.0340
Epoch 0850 | Beta: 1.00 | Loss: 133.2230 | NLL: 32.2142 | KL: 101.0088
Epoch 0860 | Beta: 1.00 | Loss: 131.1713 | NLL: 30.7197 | KL: 100.4515
Epoch 0870 | Beta: 1.00 | Loss: 131.1048 | NLL: 31.0050 | KL: 100.0998
Epoch 0880 | Beta: 1.00 | Loss: 136.5726 | NLL: 36.2181 | KL: 100.3545
Epoch 0890 | Beta: 1.00 | Loss: 130.9959 | NLL: 30.5937 | KL: 100.4022
Epoch 0900 | Beta: 1.00 | Loss: 130.5540 | NLL: 29.8988 | KL: 100.6552
Epoch 0910 | Beta: 1.00 | Loss: 130.9348 | NLL: 30.0474 | KL: 100.8874
Epoch 0920 | Beta: 1.00 | Loss: 131.2231 | NLL: 31.0185 | KL: 100.2046
Epoch 0930 | Beta: 1.00 | Loss: 129.6071 | NLL: 30.6409 | KL: 98.9662
Epoch 0940 | Beta: 1.00 | Loss: 130.9730 | NLL: 29.7390 | KL: 101.2340
Epoch 0950 | Beta: 1.00 | Loss: 133.4272 | NLL: 33.5067 | KL: 99.9205
Epoch 0960 | Beta: 1.00 | Loss: 130.6709 | NLL: 30.2646 | KL: 100.4063
Epoch 0970 | Beta: 1.00 | Loss: 130.9103 | NLL: 30.4138 | KL: 100.4966
Epoch 0980 | Beta: 1.00 | Loss: 135.8105 | NLL: 35.3803 | KL: 100.4302
Epoch 0990 | Beta: 1.00 | Loss: 130.4384 | NLL: 30.9373 | KL: 99.5011
Epoch 1000 | Beta: 1.00 | Loss: 131.0112 | NLL: 31.7978 | KL: 99.2133
Correlation Heatmap saved to paper_plots\run_20260103_053524/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1100
Violazioni Attese: 55.0
Violazioni Osservate: 36
Frequenza Osservata: 0.0327 (Target: 0.0500)
LR Statistic: 7.8288 | P-Value: 0.0051
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1030, n01=33, n10=33, n11=3
LR Independence: 2.1579 (p-value: 0.1418)
LR Conditional Coverage (CC): 9.9867 | P-Value CC: 0.0068
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_053524/var_regimes_plot.png'

>>> Analysis Complete.

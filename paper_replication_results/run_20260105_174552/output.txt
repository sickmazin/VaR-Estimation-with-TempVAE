>>> TEMP VAE: PAPER EXACT REPLICATION PIPELINE
>>> Log salvati in: paper_replication_results\run_20260105_174552

CONFIGURAZIONE:
tickers: ['ALV.DE', 'BAS.DE', 'BMW.DE', 'DBK.DE', 'DTE.DE', 'EOAN.DE', 'IFX.DE', 'MUV2.DE', 'RWE.DE', 'SAP.DE', 'SIE.DE']
start_date: 2010-01-01
end_date: 2023-12-31
seq_length: 21
train_split: 0.66
latent_dim: 10
hidden_dim: 16
dropout_rate: 0.1
batch_size: 256
epochs: 1000
learning_rate: 0.001
lr_decay_rate: 0.96
lr_decay_steps: 500
l2_reg: 0.01
annealing_decay_rate: 0.96
annealing_steps: 20
device: cpu
seed: 42
plot_dir: paper_replication_results\run_20260105_174552
--------------------------------------------------

>>> Scaricamento dati da YFinance (11 tickers)...
Ticker rimossi per dati insufficienti: []
First 5 rows of cleaned data:
 Ticker         ALV.DE     BAS.DE     BMW.DE  ...     RWE.DE     SAP.DE     SIE.DE
Date                                         ...                                 
2010-01-04  41.426899  21.354881  16.253132  ...  37.117027  25.522682  32.746876
2010-01-05  41.553219  21.031103  16.384983  ...  36.880203  25.294107  32.766880
2010-01-06  41.876060  21.164423  16.638542  ...  36.810238  25.743504  32.886925
2010-01-07  41.394146  21.023958  16.785603  ...  36.654144  26.425350  33.277065
2010-01-08  41.169540  20.959681  16.559938  ...  36.600319  26.611305  33.487144

[5 rows x 11 columns]
Dataset shape post-cleaning: (3557, 11)
Assets mantenuti (11): ['ALV.DE', 'BAS.DE', 'BMW.DE', 'DBK.DE', 'DTE.DE', 'EOAN.DE', 'IFX.DE', 'MUV2.DE', 'RWE.DE', 'SAP.DE', 'SIE.DE']
Train samples: 2346 | Test samples: 1210

>>> Inizializzazione Training (Paper Config)...
Epoch 0010 | Beta: 0.0182 | Loss: 272.4461 | NLL: 269.8945 | KL: 140.1803 | LR: 0.001000
Epoch 0020 | Beta: 0.0380 | Loss: 256.2452 | NLL: 254.0851 | KL: 56.7859 | LR: 0.001000
Epoch 0030 | Beta: 0.0575 | Loss: 250.5377 | NLL: 247.2183 | KL: 57.7552 | LR: 0.001000
Epoch 0040 | Beta: 0.0765 | Loss: 242.0211 | NLL: 236.7655 | KL: 68.6851 | LR: 0.001000
Epoch 0050 | Beta: 0.0952 | Loss: 234.7465 | NLL: 227.3277 | KL: 77.9489 | LR: 0.001000
Epoch 0060 | Beta: 0.1135 | Loss: 229.2644 | NLL: 219.7466 | KL: 83.8895 | LR: 0.000960
Epoch 0070 | Beta: 0.1314 | Loss: 227.4087 | NLL: 216.4125 | KL: 83.7053 | LR: 0.000960
Epoch 0080 | Beta: 0.1489 | Loss: 226.8584 | NLL: 214.1790 | KL: 85.1438 | LR: 0.000960
Epoch 0090 | Beta: 0.1661 | Loss: 227.0506 | NLL: 212.8434 | KL: 85.5270 | LR: 0.000960
Epoch 0100 | Beta: 0.1830 | Loss: 227.5046 | NLL: 211.9441 | KL: 85.0481 | LR: 0.000960
Epoch 0110 | Beta: 0.1995 | Loss: 228.1475 | NLL: 211.5484 | KL: 83.2167 | LR: 0.000960
Epoch 0120 | Beta: 0.2156 | Loss: 228.9379 | NLL: 211.2082 | KL: 82.2179 | LR: 0.000922
Epoch 0130 | Beta: 0.2315 | Loss: 229.9850 | NLL: 211.3613 | KL: 80.4514 | LR: 0.000922
Epoch 0140 | Beta: 0.2470 | Loss: 230.7140 | NLL: 211.1345 | KL: 79.2637 | LR: 0.000922
Epoch 0150 | Beta: 0.2622 | Loss: 231.8982 | NLL: 211.2390 | KL: 78.7824 | LR: 0.000922
Epoch 0160 | Beta: 0.2771 | Loss: 232.2828 | NLL: 210.8529 | KL: 77.3260 | LR: 0.000922
Epoch 0170 | Beta: 0.2917 | Loss: 233.4358 | NLL: 211.2675 | KL: 75.9859 | LR: 0.000885
Epoch 0180 | Beta: 0.3061 | Loss: 234.4240 | NLL: 211.5004 | KL: 74.9013 | LR: 0.000885
Epoch 0190 | Beta: 0.3201 | Loss: 235.4762 | NLL: 211.7667 | KL: 74.0754 | LR: 0.000885
Epoch 0200 | Beta: 0.3338 | Loss: 236.1320 | NLL: 211.7951 | KL: 72.9067 | LR: 0.000885
Epoch 0210 | Beta: 0.3473 | Loss: 236.8854 | NLL: 211.9586 | KL: 71.7794 | LR: 0.000885
Epoch 0220 | Beta: 0.3605 | Loss: 237.6467 | NLL: 212.2808 | KL: 70.3715 | LR: 0.000885
Epoch 0230 | Beta: 0.3734 | Loss: 238.7026 | NLL: 212.8762 | KL: 69.1696 | LR: 0.000849
Epoch 0240 | Beta: 0.3860 | Loss: 239.6733 | NLL: 213.1370 | KL: 68.7401 | LR: 0.000849
Epoch 0250 | Beta: 0.3984 | Loss: 239.9615 | NLL: 213.0499 | KL: 67.5418 | LR: 0.000849
Epoch 0260 | Beta: 0.4106 | Loss: 240.6976 | NLL: 213.4175 | KL: 66.4401 | LR: 0.000849
Epoch 0270 | Beta: 0.4225 | Loss: 241.6490 | NLL: 213.8731 | KL: 65.7411 | LR: 0.000849
Epoch 0280 | Beta: 0.4342 | Loss: 242.1812 | NLL: 213.9789 | KL: 64.9563 | LR: 0.000815
Epoch 0290 | Beta: 0.4456 | Loss: 242.9142 | NLL: 214.2494 | KL: 64.3277 | LR: 0.000815
Epoch 0300 | Beta: 0.4568 | Loss: 243.6425 | NLL: 214.4759 | KL: 63.8490 | LR: 0.000815
Epoch 0310 | Beta: 0.4678 | Loss: 244.0055 | NLL: 214.8248 | KL: 62.3812 | LR: 0.000815
Epoch 0320 | Beta: 0.4785 | Loss: 244.5617 | NLL: 215.0232 | KL: 61.7271 | LR: 0.000815
Epoch 0330 | Beta: 0.4891 | Loss: 245.1546 | NLL: 215.4200 | KL: 60.7982 | LR: 0.000815
Epoch 0340 | Beta: 0.4994 | Loss: 245.8242 | NLL: 215.9918 | KL: 59.7374 | LR: 0.000783
Epoch 0350 | Beta: 0.5095 | Loss: 246.4469 | NLL: 216.2501 | KL: 59.2667 | LR: 0.000783
Epoch 0360 | Beta: 0.5194 | Loss: 246.7260 | NLL: 216.4550 | KL: 58.2789 | LR: 0.000783
Epoch 0370 | Beta: 0.5291 | Loss: 247.6914 | NLL: 217.2689 | KL: 57.4957 | LR: 0.000783
Epoch 0380 | Beta: 0.5386 | Loss: 248.0117 | NLL: 217.0612 | KL: 57.4604 | LR: 0.000783
Epoch 0390 | Beta: 0.5480 | Loss: 248.6452 | NLL: 217.5380 | KL: 56.7689 | LR: 0.000751
Epoch 0400 | Beta: 0.5571 | Loss: 248.8958 | NLL: 217.6142 | KL: 56.1515 | LR: 0.000751
Epoch 0410 | Beta: 0.5660 | Loss: 249.1884 | NLL: 218.0140 | KL: 55.0743 | LR: 0.000751
Epoch 0420 | Beta: 0.5748 | Loss: 249.7211 | NLL: 218.3143 | KL: 54.6386 | LR: 0.000751
Epoch 0430 | Beta: 0.5834 | Loss: 250.0362 | NLL: 218.6482 | KL: 53.8016 | LR: 0.000751
Epoch 0440 | Beta: 0.5918 | Loss: 250.4900 | NLL: 218.9168 | KL: 53.3496 | LR: 0.000751
Epoch 0450 | Beta: 0.6001 | Loss: 250.7616 | NLL: 219.3471 | KL: 52.3518 | LR: 0.000721
Epoch 0460 | Beta: 0.6081 | Loss: 250.7306 | NLL: 219.6084 | KL: 51.1756 | LR: 0.000721
Epoch 0470 | Beta: 0.6161 | Loss: 251.3405 | NLL: 219.8383 | KL: 51.1347 | LR: 0.000721
Epoch 0480 | Beta: 0.6238 | Loss: 251.5060 | NLL: 220.0144 | KL: 50.4818 | LR: 0.000721
Epoch 0490 | Beta: 0.6314 | Loss: 251.5913 | NLL: 220.2886 | KL: 49.5751 | LR: 0.000721
Epoch 0500 | Beta: 0.6389 | Loss: 251.8799 | NLL: 220.5097 | KL: 49.1029 | LR: 0.000693
Epoch 0510 | Beta: 0.6462 | Loss: 251.8043 | NLL: 220.6592 | KL: 48.2001 | LR: 0.000693
Epoch 0520 | Beta: 0.6533 | Loss: 252.2662 | NLL: 221.0942 | KL: 47.7137 | LR: 0.000693
Epoch 0530 | Beta: 0.6603 | Loss: 252.9951 | NLL: 221.6007 | KL: 47.5444 | LR: 0.000693
Epoch 0540 | Beta: 0.6672 | Loss: 253.0563 | NLL: 221.3483 | KL: 47.5254 | LR: 0.000693
Epoch 0550 | Beta: 0.6739 | Loss: 252.7205 | NLL: 221.6915 | KL: 46.0437 | LR: 0.000693
Epoch 0560 | Beta: 0.6805 | Loss: 253.3902 | NLL: 221.6398 | KL: 46.6579 | LR: 0.000665
Epoch 0570 | Beta: 0.6869 | Loss: 253.6812 | NLL: 221.8277 | KL: 46.3696 | LR: 0.000665
Epoch 0580 | Beta: 0.6933 | Loss: 253.7427 | NLL: 222.0576 | KL: 45.7037 | LR: 0.000665
Epoch 0590 | Beta: 0.6995 | Loss: 253.7161 | NLL: 222.1514 | KL: 45.1266 | LR: 0.000665
Epoch 0600 | Beta: 0.7055 | Loss: 254.1904 | NLL: 222.5137 | KL: 44.8970 | LR: 0.000665
Epoch 0610 | Beta: 0.7115 | Loss: 254.4007 | NLL: 222.8261 | KL: 44.3782 | LR: 0.000665
Epoch 0620 | Beta: 0.7173 | Loss: 254.3301 | NLL: 222.7405 | KL: 44.0383 | LR: 0.000638
Epoch 0630 | Beta: 0.7230 | Loss: 254.3458 | NLL: 222.6775 | KL: 43.7993 | LR: 0.000638
Epoch 0640 | Beta: 0.7286 | Loss: 254.7812 | NLL: 222.9153 | KL: 43.7342 | LR: 0.000638
Epoch 0650 | Beta: 0.7341 | Loss: 255.1166 | NLL: 223.1876 | KL: 43.4935 | LR: 0.000638
Epoch 0660 | Beta: 0.7395 | Loss: 255.0332 | NLL: 223.1757 | KL: 43.0809 | LR: 0.000638
Epoch 0670 | Beta: 0.7447 | Loss: 255.2936 | NLL: 223.4991 | KL: 42.6919 | LR: 0.000613
Epoch 0680 | Beta: 0.7499 | Loss: 255.5665 | NLL: 223.7985 | KL: 42.3629 | LR: 0.000613
Epoch 0690 | Beta: 0.7550 | Loss: 255.6870 | NLL: 223.5464 | KL: 42.5728 | LR: 0.000613
Epoch 0700 | Beta: 0.7599 | Loss: 255.6907 | NLL: 223.7233 | KL: 42.0675 | LR: 0.000613
Epoch 0710 | Beta: 0.7648 | Loss: 255.7512 | NLL: 223.7952 | KL: 41.7857 | LR: 0.000613
Epoch 0720 | Beta: 0.7695 | Loss: 256.3441 | NLL: 224.3522 | KL: 41.5743 | LR: 0.000613
Epoch 0730 | Beta: 0.7742 | Loss: 256.5227 | NLL: 224.3433 | KL: 41.5664 | LR: 0.000588
Epoch 0740 | Beta: 0.7787 | Loss: 256.5022 | NLL: 224.2357 | KL: 41.4347 | LR: 0.000588
Epoch 0750 | Beta: 0.7832 | Loss: 256.4478 | NLL: 224.4059 | KL: 40.9114 | LR: 0.000588
Epoch 0760 | Beta: 0.7876 | Loss: 257.0124 | NLL: 224.6102 | KL: 41.1415 | LR: 0.000588
Epoch 0770 | Beta: 0.7919 | Loss: 256.6386 | NLL: 224.8095 | KL: 40.1948 | LR: 0.000588
Epoch 0780 | Beta: 0.7961 | Loss: 257.1090 | NLL: 224.8393 | KL: 40.5359 | LR: 0.000565
Epoch 0790 | Beta: 0.8002 | Loss: 257.1247 | NLL: 224.9160 | KL: 40.2509 | LR: 0.000565
Epoch 0800 | Beta: 0.8042 | Loss: 257.2735 | NLL: 224.9042 | KL: 40.2486 | LR: 0.000565
Epoch 0810 | Beta: 0.8082 | Loss: 257.7179 | NLL: 225.5154 | KL: 39.8453 | LR: 0.000565
Epoch 0820 | Beta: 0.8121 | Loss: 257.5255 | NLL: 225.1897 | KL: 39.8192 | LR: 0.000565
Epoch 0830 | Beta: 0.8159 | Loss: 258.0080 | NLL: 225.5446 | KL: 39.7903 | LR: 0.000565
Epoch 0840 | Beta: 0.8196 | Loss: 257.7030 | NLL: 225.2098 | KL: 39.6460 | LR: 0.000542
Epoch 0850 | Beta: 0.8232 | Loss: 258.0592 | NLL: 225.7832 | KL: 39.2066 | LR: 0.000542
Epoch 0860 | Beta: 0.8268 | Loss: 258.2133 | NLL: 225.4828 | KL: 39.5870 | LR: 0.000542
Epoch 0870 | Beta: 0.8303 | Loss: 258.1611 | NLL: 225.9783 | KL: 38.7605 | LR: 0.000542
Epoch 0880 | Beta: 0.8337 | Loss: 258.2194 | NLL: 225.7962 | KL: 38.8895 | LR: 0.000542
Epoch 0890 | Beta: 0.8371 | Loss: 258.3006 | NLL: 225.6056 | KL: 39.0581 | LR: 0.000520
Epoch 0900 | Beta: 0.8404 | Loss: 258.5454 | NLL: 225.9529 | KL: 38.7831 | LR: 0.000520
Epoch 0910 | Beta: 0.8436 | Loss: 258.3892 | NLL: 226.0460 | KL: 38.3393 | LR: 0.000520
Epoch 0920 | Beta: 0.8468 | Loss: 258.5768 | NLL: 225.9692 | KL: 38.5085 | LR: 0.000520
Epoch 0930 | Beta: 0.8499 | Loss: 258.5802 | NLL: 226.2533 | KL: 38.0379 | LR: 0.000520
Epoch 0940 | Beta: 0.8529 | Loss: 258.5632 | NLL: 226.1814 | KL: 37.9671 | LR: 0.000520
Epoch 0950 | Beta: 0.8559 | Loss: 259.0751 | NLL: 226.5286 | KL: 38.0276 | LR: 0.000500
Epoch 0960 | Beta: 0.8588 | Loss: 258.9596 | NLL: 226.4569 | KL: 37.8476 | LR: 0.000500
Epoch 0970 | Beta: 0.8616 | Loss: 259.3889 | NLL: 226.8056 | KL: 37.8159 | LR: 0.000500
Epoch 0980 | Beta: 0.8644 | Loss: 258.8332 | NLL: 226.6845 | KL: 37.1908 | LR: 0.000500
Epoch 0990 | Beta: 0.8672 | Loss: 259.5218 | NLL: 227.1606 | KL: 37.3184 | LR: 0.000500
Epoch 1000 | Beta: 0.8698 | Loss: 259.1138 | NLL: 226.6312 | KL: 37.3428 | LR: 0.000480

>>> Avvio Valutazione...

=== RISULTATI TEST STATISTICI ===

--- Kupiec POF Test ---
Totale Giorni: 1190
Violazioni Attese: 59.5
Violazioni Osservate: 299
Frequenza Osservata: 0.2513 (Target: 0.0500)
LR Statistic: inf | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON Ã¨ calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=667, n01=223, n10=223, n11=76
LR Independence: 0.0155 (p-value: 0.9008)
LR Conditional Coverage (CC): 541.2247 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots/var_regimes_plot.png'

>>> REPLICATION COMPLETE.

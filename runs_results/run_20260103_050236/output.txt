Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_050236
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_050236

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 22
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_050236
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 135.1852 | NLL: 125.9805 | KL: 102.2750
Epoch 0020 | Beta: 0.19 | Loss: 124.5946 | NLL: 104.9993 | KL: 103.1332
Epoch 0030 | Beta: 0.29 | Loss: 122.4881 | NLL: 91.0929 | KL: 108.2592
Epoch 0040 | Beta: 0.39 | Loss: 123.4903 | NLL: 79.9842 | KL: 111.5540
Epoch 0050 | Beta: 0.49 | Loss: 127.7675 | NLL: 72.8673 | KL: 112.0413
Epoch 0060 | Beta: 0.59 | Loss: 136.1806 | NLL: 71.3114 | KL: 109.9478
Epoch 0070 | Beta: 0.69 | Loss: 142.8253 | NLL: 67.8900 | KL: 108.6018
Epoch 0080 | Beta: 0.79 | Loss: 154.0179 | NLL: 69.1078 | KL: 107.4811
Epoch 0090 | Beta: 0.89 | Loss: 164.2962 | NLL: 70.2745 | KL: 105.6423
Epoch 0100 | Beta: 0.99 | Loss: 172.4692 | NLL: 70.4290 | KL: 103.0709
Epoch 0110 | Beta: 1.00 | Loss: 170.4349 | NLL: 68.6669 | KL: 101.7680
Epoch 0120 | Beta: 1.00 | Loss: 171.0630 | NLL: 69.0960 | KL: 101.9670
Epoch 0130 | Beta: 1.00 | Loss: 171.0294 | NLL: 68.8015 | KL: 102.2279
Epoch 0140 | Beta: 1.00 | Loss: 169.1456 | NLL: 67.0351 | KL: 102.1105
Epoch 0150 | Beta: 1.00 | Loss: 168.2519 | NLL: 66.4678 | KL: 101.7840
Epoch 0160 | Beta: 1.00 | Loss: 166.6184 | NLL: 65.1023 | KL: 101.5161
Epoch 0170 | Beta: 1.00 | Loss: 167.5529 | NLL: 66.1427 | KL: 101.4102
Epoch 0180 | Beta: 1.00 | Loss: 167.3559 | NLL: 65.5028 | KL: 101.8531
Epoch 0190 | Beta: 1.00 | Loss: 166.2047 | NLL: 64.0166 | KL: 102.1881
Epoch 0200 | Beta: 1.00 | Loss: 167.7669 | NLL: 66.0446 | KL: 101.7224
Epoch 0210 | Beta: 1.00 | Loss: 168.3286 | NLL: 67.0675 | KL: 101.2610
Epoch 0220 | Beta: 1.00 | Loss: 165.9000 | NLL: 64.6205 | KL: 101.2796
Epoch 0230 | Beta: 1.00 | Loss: 166.9328 | NLL: 65.6614 | KL: 101.2714
Epoch 0240 | Beta: 1.00 | Loss: 167.2474 | NLL: 65.5204 | KL: 101.7270
Epoch 0250 | Beta: 1.00 | Loss: 167.1996 | NLL: 66.2170 | KL: 100.9826
Epoch 0260 | Beta: 1.00 | Loss: 165.3983 | NLL: 63.7996 | KL: 101.5987
Epoch 0270 | Beta: 1.00 | Loss: 167.9563 | NLL: 65.8562 | KL: 102.1001
Epoch 0280 | Beta: 1.00 | Loss: 164.7558 | NLL: 62.8723 | KL: 101.8835
Epoch 0290 | Beta: 1.00 | Loss: 166.2668 | NLL: 64.9848 | KL: 101.2820
Epoch 0300 | Beta: 1.00 | Loss: 168.1150 | NLL: 67.4646 | KL: 100.6504
Epoch 0310 | Beta: 1.00 | Loss: 164.3086 | NLL: 62.4612 | KL: 101.8474
Epoch 0320 | Beta: 1.00 | Loss: 165.5685 | NLL: 64.1843 | KL: 101.3843
Epoch 0330 | Beta: 1.00 | Loss: 167.5723 | NLL: 66.5942 | KL: 100.9781
Epoch 0340 | Beta: 1.00 | Loss: 165.7114 | NLL: 64.4777 | KL: 101.2337
Epoch 0350 | Beta: 1.00 | Loss: 165.4304 | NLL: 64.5764 | KL: 100.8541
Epoch 0360 | Beta: 1.00 | Loss: 164.1660 | NLL: 62.6508 | KL: 101.5151
Epoch 0370 | Beta: 1.00 | Loss: 163.8448 | NLL: 61.7780 | KL: 102.0668
Epoch 0380 | Beta: 1.00 | Loss: 166.6340 | NLL: 64.9681 | KL: 101.6659
Epoch 0390 | Beta: 1.00 | Loss: 166.8136 | NLL: 64.9994 | KL: 101.8142
Epoch 0400 | Beta: 1.00 | Loss: 167.8640 | NLL: 66.2237 | KL: 101.6404
Epoch 0410 | Beta: 1.00 | Loss: 164.6726 | NLL: 63.6129 | KL: 101.0597
Epoch 0420 | Beta: 1.00 | Loss: 164.7346 | NLL: 62.7354 | KL: 101.9992
Epoch 0430 | Beta: 1.00 | Loss: 164.9641 | NLL: 63.1604 | KL: 101.8037
Epoch 0440 | Beta: 1.00 | Loss: 165.1451 | NLL: 62.7033 | KL: 102.4418
Epoch 0450 | Beta: 1.00 | Loss: 166.3863 | NLL: 63.8336 | KL: 102.5527
Epoch 0460 | Beta: 1.00 | Loss: 165.9825 | NLL: 62.5999 | KL: 103.3827
Epoch 0470 | Beta: 1.00 | Loss: 166.5230 | NLL: 64.0867 | KL: 102.4363
Epoch 0480 | Beta: 1.00 | Loss: 164.2122 | NLL: 61.7172 | KL: 102.4950
Epoch 0490 | Beta: 1.00 | Loss: 166.6785 | NLL: 64.1586 | KL: 102.5199
Epoch 0500 | Beta: 1.00 | Loss: 164.8438 | NLL: 61.8431 | KL: 103.0007
Epoch 0510 | Beta: 1.00 | Loss: 164.0403 | NLL: 61.8278 | KL: 102.2125
Epoch 0520 | Beta: 1.00 | Loss: 164.6368 | NLL: 61.9995 | KL: 102.6373
Epoch 0530 | Beta: 1.00 | Loss: 164.1631 | NLL: 60.9153 | KL: 103.2479
Epoch 0540 | Beta: 1.00 | Loss: 166.6694 | NLL: 63.4019 | KL: 103.2675
Epoch 0550 | Beta: 1.00 | Loss: 164.8942 | NLL: 62.5429 | KL: 102.3513
Epoch 0560 | Beta: 1.00 | Loss: 164.6404 | NLL: 60.6705 | KL: 103.9699
Epoch 0570 | Beta: 1.00 | Loss: 165.2743 | NLL: 62.3831 | KL: 102.8912
Epoch 0580 | Beta: 1.00 | Loss: 166.5747 | NLL: 64.0580 | KL: 102.5166
Epoch 0590 | Beta: 1.00 | Loss: 165.7229 | NLL: 62.7028 | KL: 103.0200
Epoch 0600 | Beta: 1.00 | Loss: 165.2364 | NLL: 62.2675 | KL: 102.9688
Epoch 0610 | Beta: 1.00 | Loss: 165.8281 | NLL: 63.5627 | KL: 102.2655
Epoch 0620 | Beta: 1.00 | Loss: 164.1642 | NLL: 60.8632 | KL: 103.3010
Epoch 0630 | Beta: 1.00 | Loss: 165.3496 | NLL: 62.4763 | KL: 102.8733
Epoch 0640 | Beta: 1.00 | Loss: 168.1177 | NLL: 65.2446 | KL: 102.8731
Epoch 0650 | Beta: 1.00 | Loss: 167.1395 | NLL: 64.3209 | KL: 102.8186
Epoch 0660 | Beta: 1.00 | Loss: 165.6204 | NLL: 62.0690 | KL: 103.5514
Epoch 0670 | Beta: 1.00 | Loss: 165.5628 | NLL: 62.2082 | KL: 103.3547
Epoch 0680 | Beta: 1.00 | Loss: 165.0462 | NLL: 61.9735 | KL: 103.0727
Epoch 0690 | Beta: 1.00 | Loss: 163.8001 | NLL: 61.4839 | KL: 102.3163
Epoch 0700 | Beta: 1.00 | Loss: 164.7226 | NLL: 61.4018 | KL: 103.3209
Epoch 0710 | Beta: 1.00 | Loss: 162.7736 | NLL: 60.6443 | KL: 102.1293
Epoch 0720 | Beta: 1.00 | Loss: 165.8277 | NLL: 62.0823 | KL: 103.7453
Epoch 0730 | Beta: 1.00 | Loss: 163.7199 | NLL: 61.3847 | KL: 102.3352
Epoch 0740 | Beta: 1.00 | Loss: 165.6908 | NLL: 63.1597 | KL: 102.5311
Epoch 0750 | Beta: 1.00 | Loss: 162.1623 | NLL: 59.1472 | KL: 103.0151
Epoch 0760 | Beta: 1.00 | Loss: 164.7812 | NLL: 62.6516 | KL: 102.1296
Epoch 0770 | Beta: 1.00 | Loss: 165.7175 | NLL: 62.6693 | KL: 103.0482
Epoch 0780 | Beta: 1.00 | Loss: 163.8717 | NLL: 61.1382 | KL: 102.7334
Epoch 0790 | Beta: 1.00 | Loss: 161.4605 | NLL: 58.6753 | KL: 102.7852
Epoch 0800 | Beta: 1.00 | Loss: 165.8221 | NLL: 62.5550 | KL: 103.2671
Epoch 0810 | Beta: 1.00 | Loss: 165.6985 | NLL: 62.6426 | KL: 103.0559
Epoch 0820 | Beta: 1.00 | Loss: 166.5420 | NLL: 63.4472 | KL: 103.0948
Epoch 0830 | Beta: 1.00 | Loss: 163.3475 | NLL: 61.1708 | KL: 102.1768
Epoch 0840 | Beta: 1.00 | Loss: 165.3078 | NLL: 62.2632 | KL: 103.0447
Epoch 0850 | Beta: 1.00 | Loss: 166.5776 | NLL: 63.0325 | KL: 103.5451
Epoch 0860 | Beta: 1.00 | Loss: 164.4392 | NLL: 60.6614 | KL: 103.7778
Epoch 0870 | Beta: 1.00 | Loss: 163.9015 | NLL: 60.5107 | KL: 103.3907
Epoch 0880 | Beta: 1.00 | Loss: 163.3681 | NLL: 60.9483 | KL: 102.4197
Epoch 0890 | Beta: 1.00 | Loss: 162.2405 | NLL: 59.6147 | KL: 102.6258
Epoch 0900 | Beta: 1.00 | Loss: 165.3765 | NLL: 62.5329 | KL: 102.8436
Epoch 0910 | Beta: 1.00 | Loss: 166.2677 | NLL: 62.3427 | KL: 103.9250
Epoch 0920 | Beta: 1.00 | Loss: 163.9771 | NLL: 61.1226 | KL: 102.8545
Epoch 0930 | Beta: 1.00 | Loss: 162.6534 | NLL: 59.6349 | KL: 103.0185
Epoch 0940 | Beta: 1.00 | Loss: 163.3123 | NLL: 60.4303 | KL: 102.8819
Epoch 0950 | Beta: 1.00 | Loss: 165.2436 | NLL: 61.7996 | KL: 103.4440
Epoch 0960 | Beta: 1.00 | Loss: 164.6396 | NLL: 61.7567 | KL: 102.8829
Epoch 0970 | Beta: 1.00 | Loss: 164.5612 | NLL: 61.5175 | KL: 103.0437
Epoch 0980 | Beta: 1.00 | Loss: 161.6589 | NLL: 58.7522 | KL: 102.9067
Epoch 0990 | Beta: 1.00 | Loss: 163.8283 | NLL: 61.0486 | KL: 102.7798
Epoch 1000 | Beta: 1.00 | Loss: 165.0548 | NLL: 61.4732 | KL: 103.5816
Correlation Heatmap saved to paper_plots\run_20260103_050236/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1105
Violazioni Attese: 55.2
Violazioni Osservate: 19
Frequenza Osservata: 0.0172 (Target: 0.0500)
LR Statistic: 33.1753 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1068, n01=17, n10=17, n11=2
LR Independence: 4.2096 (p-value: 0.0402)
LR Conditional Coverage (CC): 37.3849 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_050236/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_053109
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_053109

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 23
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_053109
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 133.2522 | NLL: 127.0549 | KL: 68.8590
Epoch 0020 | Beta: 0.19 | Loss: 126.8615 | NLL: 112.7676 | KL: 74.1785
Epoch 0030 | Beta: 0.29 | Loss: 124.1801 | NLL: 100.9470 | KL: 80.1144
Epoch 0040 | Beta: 0.39 | Loss: 117.3940 | NLL: 82.5262 | KL: 89.4047
Epoch 0050 | Beta: 0.49 | Loss: 116.3174 | NLL: 70.7285 | KL: 93.0386
Epoch 0060 | Beta: 0.59 | Loss: 122.7436 | NLL: 68.6080 | KL: 91.7552
Epoch 0070 | Beta: 0.69 | Loss: 130.8514 | NLL: 67.4475 | KL: 91.8897
Epoch 0080 | Beta: 0.79 | Loss: 139.5736 | NLL: 68.2138 | KL: 90.3288
Epoch 0090 | Beta: 0.89 | Loss: 147.5308 | NLL: 67.9218 | KL: 89.4484
Epoch 0100 | Beta: 0.99 | Loss: 155.9145 | NLL: 68.8334 | KL: 87.9606
Epoch 0110 | Beta: 1.00 | Loss: 157.5391 | NLL: 70.3519 | KL: 87.1872
Epoch 0120 | Beta: 1.00 | Loss: 157.1455 | NLL: 69.5798 | KL: 87.5657
Epoch 0130 | Beta: 1.00 | Loss: 158.5139 | NLL: 69.6556 | KL: 88.8583
Epoch 0140 | Beta: 1.00 | Loss: 156.5447 | NLL: 67.6919 | KL: 88.8529
Epoch 0150 | Beta: 1.00 | Loss: 154.9178 | NLL: 66.1543 | KL: 88.7635
Epoch 0160 | Beta: 1.00 | Loss: 156.8187 | NLL: 68.9161 | KL: 87.9026
Epoch 0170 | Beta: 1.00 | Loss: 155.2544 | NLL: 67.0052 | KL: 88.2492
Epoch 0180 | Beta: 1.00 | Loss: 154.8576 | NLL: 65.9998 | KL: 88.8578
Epoch 0190 | Beta: 1.00 | Loss: 154.6029 | NLL: 65.4637 | KL: 89.1391
Epoch 0200 | Beta: 1.00 | Loss: 154.7997 | NLL: 65.1924 | KL: 89.6073
Epoch 0210 | Beta: 1.00 | Loss: 154.9371 | NLL: 65.3445 | KL: 89.5927
Epoch 0220 | Beta: 1.00 | Loss: 155.4236 | NLL: 66.4390 | KL: 88.9846
Epoch 0230 | Beta: 1.00 | Loss: 156.4808 | NLL: 66.5914 | KL: 89.8894
Epoch 0240 | Beta: 1.00 | Loss: 154.2195 | NLL: 64.1110 | KL: 90.1085
Epoch 0250 | Beta: 1.00 | Loss: 154.7878 | NLL: 66.3729 | KL: 88.4149
Epoch 0260 | Beta: 1.00 | Loss: 155.1805 | NLL: 65.9391 | KL: 89.2414
Epoch 0270 | Beta: 1.00 | Loss: 155.1601 | NLL: 65.3661 | KL: 89.7940
Epoch 0280 | Beta: 1.00 | Loss: 154.5544 | NLL: 63.8375 | KL: 90.7169
Epoch 0290 | Beta: 1.00 | Loss: 154.9784 | NLL: 65.0554 | KL: 89.9230
Epoch 0300 | Beta: 1.00 | Loss: 154.0616 | NLL: 63.6132 | KL: 90.4484
Epoch 0310 | Beta: 1.00 | Loss: 155.9876 | NLL: 66.2925 | KL: 89.6951
Epoch 0320 | Beta: 1.00 | Loss: 155.0251 | NLL: 65.1780 | KL: 89.8471
Epoch 0330 | Beta: 1.00 | Loss: 155.2152 | NLL: 64.3167 | KL: 90.8985
Epoch 0340 | Beta: 1.00 | Loss: 156.0857 | NLL: 66.3806 | KL: 89.7051
Epoch 0350 | Beta: 1.00 | Loss: 156.1368 | NLL: 66.2776 | KL: 89.8593
Epoch 0360 | Beta: 1.00 | Loss: 153.7421 | NLL: 64.3452 | KL: 89.3969
Epoch 0370 | Beta: 1.00 | Loss: 154.7627 | NLL: 65.0301 | KL: 89.7326
Epoch 0380 | Beta: 1.00 | Loss: 154.2371 | NLL: 64.1467 | KL: 90.0904
Epoch 0390 | Beta: 1.00 | Loss: 155.5116 | NLL: 65.4032 | KL: 90.1084
Epoch 0400 | Beta: 1.00 | Loss: 155.3013 | NLL: 64.4018 | KL: 90.8994
Epoch 0410 | Beta: 1.00 | Loss: 153.7908 | NLL: 63.1691 | KL: 90.6217
Epoch 0420 | Beta: 1.00 | Loss: 153.7188 | NLL: 63.4643 | KL: 90.2545
Epoch 0430 | Beta: 1.00 | Loss: 154.8098 | NLL: 64.7987 | KL: 90.0112
Epoch 0440 | Beta: 1.00 | Loss: 154.6975 | NLL: 64.6073 | KL: 90.0902
Epoch 0450 | Beta: 1.00 | Loss: 154.3932 | NLL: 63.0010 | KL: 91.3922
Epoch 0460 | Beta: 1.00 | Loss: 153.7655 | NLL: 62.4651 | KL: 91.3005
Epoch 0470 | Beta: 1.00 | Loss: 152.9391 | NLL: 62.5033 | KL: 90.4357
Epoch 0480 | Beta: 1.00 | Loss: 151.4822 | NLL: 59.8597 | KL: 91.6225
Epoch 0490 | Beta: 1.00 | Loss: 153.6792 | NLL: 62.6926 | KL: 90.9865
Epoch 0500 | Beta: 1.00 | Loss: 151.7972 | NLL: 59.9059 | KL: 91.8913
Epoch 0510 | Beta: 1.00 | Loss: 154.1546 | NLL: 63.1043 | KL: 91.0503
Epoch 0520 | Beta: 1.00 | Loss: 154.5489 | NLL: 62.5919 | KL: 91.9570
Epoch 0530 | Beta: 1.00 | Loss: 154.4710 | NLL: 63.6408 | KL: 90.8302
Epoch 0540 | Beta: 1.00 | Loss: 151.0070 | NLL: 59.4914 | KL: 91.5156
Epoch 0550 | Beta: 1.00 | Loss: 151.5812 | NLL: 59.5917 | KL: 91.9895
Epoch 0560 | Beta: 1.00 | Loss: 151.3308 | NLL: 59.3936 | KL: 91.9372
Epoch 0570 | Beta: 1.00 | Loss: 151.8678 | NLL: 60.2364 | KL: 91.6315
Epoch 0580 | Beta: 1.00 | Loss: 151.2976 | NLL: 58.1372 | KL: 93.1604
Epoch 0590 | Beta: 1.00 | Loss: 151.8045 | NLL: 60.0628 | KL: 91.7416
Epoch 0600 | Beta: 1.00 | Loss: 150.3737 | NLL: 58.0944 | KL: 92.2793
Epoch 0610 | Beta: 1.00 | Loss: 150.2320 | NLL: 58.1985 | KL: 92.0335
Epoch 0620 | Beta: 1.00 | Loss: 150.5385 | NLL: 58.0955 | KL: 92.4431
Epoch 0630 | Beta: 1.00 | Loss: 150.6129 | NLL: 57.7717 | KL: 92.8411
Epoch 0640 | Beta: 1.00 | Loss: 150.1716 | NLL: 57.5633 | KL: 92.6083
Epoch 0650 | Beta: 1.00 | Loss: 149.4907 | NLL: 56.8096 | KL: 92.6811
Epoch 0660 | Beta: 1.00 | Loss: 150.2856 | NLL: 57.1813 | KL: 93.1044
Epoch 0670 | Beta: 1.00 | Loss: 149.6450 | NLL: 57.9488 | KL: 91.6962
Epoch 0680 | Beta: 1.00 | Loss: 151.9885 | NLL: 58.7920 | KL: 93.1965
Epoch 0690 | Beta: 1.00 | Loss: 148.7832 | NLL: 55.8650 | KL: 92.9182
Epoch 0700 | Beta: 1.00 | Loss: 150.0262 | NLL: 56.8473 | KL: 93.1789
Epoch 0710 | Beta: 1.00 | Loss: 150.4658 | NLL: 58.1527 | KL: 92.3131
Epoch 0720 | Beta: 1.00 | Loss: 149.7992 | NLL: 57.0706 | KL: 92.7286
Epoch 0730 | Beta: 1.00 | Loss: 149.8527 | NLL: 55.8792 | KL: 93.9735
Epoch 0740 | Beta: 1.00 | Loss: 150.1697 | NLL: 57.5798 | KL: 92.5899
Epoch 0750 | Beta: 1.00 | Loss: 150.2857 | NLL: 56.7284 | KL: 93.5573
Epoch 0760 | Beta: 1.00 | Loss: 149.9142 | NLL: 56.9409 | KL: 92.9733
Epoch 0770 | Beta: 1.00 | Loss: 151.8247 | NLL: 58.7063 | KL: 93.1184
Epoch 0780 | Beta: 1.00 | Loss: 149.4718 | NLL: 55.2711 | KL: 94.2007
Epoch 0790 | Beta: 1.00 | Loss: 151.7112 | NLL: 59.0617 | KL: 92.6495
Epoch 0800 | Beta: 1.00 | Loss: 148.4343 | NLL: 55.2838 | KL: 93.1506
Epoch 0810 | Beta: 1.00 | Loss: 147.9964 | NLL: 54.3712 | KL: 93.6252
Epoch 0820 | Beta: 1.00 | Loss: 150.8811 | NLL: 57.8163 | KL: 93.0648
Epoch 0830 | Beta: 1.00 | Loss: 150.9473 | NLL: 57.9989 | KL: 92.9485
Epoch 0840 | Beta: 1.00 | Loss: 149.4907 | NLL: 55.4276 | KL: 94.0631
Epoch 0850 | Beta: 1.00 | Loss: 150.9052 | NLL: 57.6764 | KL: 93.2287
Epoch 0860 | Beta: 1.00 | Loss: 151.7429 | NLL: 59.1257 | KL: 92.6172
Epoch 0870 | Beta: 1.00 | Loss: 149.0245 | NLL: 54.8996 | KL: 94.1249
Epoch 0880 | Beta: 1.00 | Loss: 149.4869 | NLL: 55.2074 | KL: 94.2795
Epoch 0890 | Beta: 1.00 | Loss: 149.9673 | NLL: 55.5232 | KL: 94.4441
Epoch 0900 | Beta: 1.00 | Loss: 151.2688 | NLL: 58.2885 | KL: 92.9803
Epoch 0910 | Beta: 1.00 | Loss: 148.1463 | NLL: 54.5665 | KL: 93.5798
Epoch 0920 | Beta: 1.00 | Loss: 151.0666 | NLL: 57.4428 | KL: 93.6239
Epoch 0930 | Beta: 1.00 | Loss: 148.6794 | NLL: 54.1342 | KL: 94.5452
Epoch 0940 | Beta: 1.00 | Loss: 148.4869 | NLL: 55.6149 | KL: 92.8719
Epoch 0950 | Beta: 1.00 | Loss: 149.4429 | NLL: 55.4964 | KL: 93.9465
Epoch 0960 | Beta: 1.00 | Loss: 152.7292 | NLL: 59.5844 | KL: 93.1448
Epoch 0970 | Beta: 1.00 | Loss: 148.8004 | NLL: 55.1754 | KL: 93.6250
Epoch 0980 | Beta: 1.00 | Loss: 149.9372 | NLL: 56.6431 | KL: 93.2941
Epoch 0990 | Beta: 1.00 | Loss: 149.2075 | NLL: 55.2946 | KL: 93.9129
Epoch 1000 | Beta: 1.00 | Loss: 152.5377 | NLL: 59.9240 | KL: 92.6137
Correlation Heatmap saved to paper_plots\run_20260103_053109/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1105
Violazioni Attese: 55.2
Violazioni Osservate: 16
Frequenza Osservata: 0.0145 (Target: 0.0500)
LR Statistic: 40.2926 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1073, n01=15, n10=15, n11=1
LR Independence: 1.4634 (p-value: 0.2264)
LR Conditional Coverage (CC): 41.7561 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_053109/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_060002
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_060002

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 24
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_060002
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 133.1201 | NLL: 126.4312 | KL: 74.3203
Epoch 0020 | Beta: 0.19 | Loss: 126.0363 | NLL: 111.5858 | KL: 76.0554
Epoch 0030 | Beta: 0.29 | Loss: 124.5442 | NLL: 101.3146 | KL: 80.1019
Epoch 0040 | Beta: 0.39 | Loss: 119.2062 | NLL: 84.7244 | KL: 88.4149
Epoch 0050 | Beta: 0.49 | Loss: 117.0269 | NLL: 72.1426 | KL: 91.6006
Epoch 0060 | Beta: 0.59 | Loss: 121.9619 | NLL: 68.5315 | KL: 90.5600
Epoch 0070 | Beta: 0.69 | Loss: 129.3062 | NLL: 67.2566 | KL: 89.9269
Epoch 0080 | Beta: 0.79 | Loss: 135.6462 | NLL: 66.3181 | KL: 87.7570
Epoch 0090 | Beta: 0.89 | Loss: 146.0533 | NLL: 69.6512 | KL: 85.8451
Epoch 0100 | Beta: 0.99 | Loss: 151.8512 | NLL: 68.3793 | KL: 84.3151
Epoch 0110 | Beta: 1.00 | Loss: 152.4659 | NLL: 69.2359 | KL: 83.2300
Epoch 0120 | Beta: 1.00 | Loss: 151.5835 | NLL: 67.3365 | KL: 84.2470
Epoch 0130 | Beta: 1.00 | Loss: 150.6258 | NLL: 66.9379 | KL: 83.6880
Epoch 0140 | Beta: 1.00 | Loss: 148.9531 | NLL: 65.9967 | KL: 82.9564
Epoch 0150 | Beta: 1.00 | Loss: 150.0315 | NLL: 67.1635 | KL: 82.8680
Epoch 0160 | Beta: 1.00 | Loss: 149.2347 | NLL: 65.9654 | KL: 83.2692
Epoch 0170 | Beta: 1.00 | Loss: 150.2129 | NLL: 67.6740 | KL: 82.5389
Epoch 0180 | Beta: 1.00 | Loss: 150.7549 | NLL: 67.0739 | KL: 83.6810
Epoch 0190 | Beta: 1.00 | Loss: 149.6174 | NLL: 65.8911 | KL: 83.7263
Epoch 0200 | Beta: 1.00 | Loss: 148.4971 | NLL: 65.1312 | KL: 83.3659
Epoch 0210 | Beta: 1.00 | Loss: 146.1982 | NLL: 63.0255 | KL: 83.1726
Epoch 0220 | Beta: 1.00 | Loss: 151.0597 | NLL: 68.2986 | KL: 82.7611
Epoch 0230 | Beta: 1.00 | Loss: 148.7587 | NLL: 66.5777 | KL: 82.1810
Epoch 0240 | Beta: 1.00 | Loss: 148.2252 | NLL: 65.4825 | KL: 82.7427
Epoch 0250 | Beta: 1.00 | Loss: 147.8256 | NLL: 65.0884 | KL: 82.7372
Epoch 0260 | Beta: 1.00 | Loss: 149.9852 | NLL: 67.0194 | KL: 82.9657
Epoch 0270 | Beta: 1.00 | Loss: 149.4363 | NLL: 67.5462 | KL: 81.8900
Epoch 0280 | Beta: 1.00 | Loss: 149.7014 | NLL: 67.4026 | KL: 82.2988
Epoch 0290 | Beta: 1.00 | Loss: 149.2527 | NLL: 67.0049 | KL: 82.2478
Epoch 0300 | Beta: 1.00 | Loss: 148.3579 | NLL: 65.9826 | KL: 82.3753
Epoch 0310 | Beta: 1.00 | Loss: 150.2282 | NLL: 67.3887 | KL: 82.8395
Epoch 0320 | Beta: 1.00 | Loss: 149.7871 | NLL: 68.0293 | KL: 81.7578
Epoch 0330 | Beta: 1.00 | Loss: 150.0751 | NLL: 67.8656 | KL: 82.2096
Epoch 0340 | Beta: 1.00 | Loss: 149.0127 | NLL: 66.2998 | KL: 82.7129
Epoch 0350 | Beta: 1.00 | Loss: 147.5022 | NLL: 65.6688 | KL: 81.8334
Epoch 0360 | Beta: 1.00 | Loss: 149.3402 | NLL: 66.6913 | KL: 82.6489
Epoch 0370 | Beta: 1.00 | Loss: 150.5859 | NLL: 68.3148 | KL: 82.2711
Epoch 0380 | Beta: 1.00 | Loss: 147.4761 | NLL: 65.2445 | KL: 82.2316
Epoch 0390 | Beta: 1.00 | Loss: 149.5617 | NLL: 67.2226 | KL: 82.3391
Epoch 0400 | Beta: 1.00 | Loss: 149.8246 | NLL: 68.1893 | KL: 81.6354
Epoch 0410 | Beta: 1.00 | Loss: 147.6061 | NLL: 65.0953 | KL: 82.5107
Epoch 0420 | Beta: 1.00 | Loss: 147.7413 | NLL: 65.6505 | KL: 82.0908
Epoch 0430 | Beta: 1.00 | Loss: 148.5366 | NLL: 66.1778 | KL: 82.3588
Epoch 0440 | Beta: 1.00 | Loss: 149.1994 | NLL: 66.5102 | KL: 82.6893
Epoch 0450 | Beta: 1.00 | Loss: 150.0832 | NLL: 68.2714 | KL: 81.8118
Epoch 0460 | Beta: 1.00 | Loss: 148.8359 | NLL: 65.6859 | KL: 83.1500
Epoch 0470 | Beta: 1.00 | Loss: 147.4813 | NLL: 65.0741 | KL: 82.4072
Epoch 0480 | Beta: 1.00 | Loss: 149.7374 | NLL: 66.6235 | KL: 83.1139
Epoch 0490 | Beta: 1.00 | Loss: 149.6382 | NLL: 67.2148 | KL: 82.4234
Epoch 0500 | Beta: 1.00 | Loss: 149.6545 | NLL: 66.7735 | KL: 82.8811
Epoch 0510 | Beta: 1.00 | Loss: 147.4401 | NLL: 64.7406 | KL: 82.6996
Epoch 0520 | Beta: 1.00 | Loss: 147.8548 | NLL: 65.2573 | KL: 82.5975
Epoch 0530 | Beta: 1.00 | Loss: 150.1490 | NLL: 65.8084 | KL: 84.3406
Epoch 0540 | Beta: 1.00 | Loss: 149.5662 | NLL: 65.9561 | KL: 83.6101
Epoch 0550 | Beta: 1.00 | Loss: 150.8944 | NLL: 67.7292 | KL: 83.1652
Epoch 0560 | Beta: 1.00 | Loss: 148.2143 | NLL: 63.9321 | KL: 84.2822
Epoch 0570 | Beta: 1.00 | Loss: 148.4823 | NLL: 65.5620 | KL: 82.9203
Epoch 0580 | Beta: 1.00 | Loss: 147.9018 | NLL: 63.5632 | KL: 84.3385
Epoch 0590 | Beta: 1.00 | Loss: 148.3346 | NLL: 64.5865 | KL: 83.7481
Epoch 0600 | Beta: 1.00 | Loss: 147.9129 | NLL: 64.5095 | KL: 83.4033
Epoch 0610 | Beta: 1.00 | Loss: 147.8895 | NLL: 64.8611 | KL: 83.0284
Epoch 0620 | Beta: 1.00 | Loss: 145.6937 | NLL: 62.0922 | KL: 83.6015
Epoch 0630 | Beta: 1.00 | Loss: 146.9803 | NLL: 63.0986 | KL: 83.8817
Epoch 0640 | Beta: 1.00 | Loss: 145.6994 | NLL: 62.3098 | KL: 83.3896
Epoch 0650 | Beta: 1.00 | Loss: 146.8086 | NLL: 62.8981 | KL: 83.9105
Epoch 0660 | Beta: 1.00 | Loss: 146.6289 | NLL: 63.7463 | KL: 82.8826
Epoch 0670 | Beta: 1.00 | Loss: 148.0286 | NLL: 63.5059 | KL: 84.5227
Epoch 0680 | Beta: 1.00 | Loss: 147.8027 | NLL: 63.9703 | KL: 83.8324
Epoch 0690 | Beta: 1.00 | Loss: 147.9153 | NLL: 63.2617 | KL: 84.6536
Epoch 0700 | Beta: 1.00 | Loss: 149.2826 | NLL: 65.2643 | KL: 84.0182
Epoch 0710 | Beta: 1.00 | Loss: 149.9069 | NLL: 65.2610 | KL: 84.6459
Epoch 0720 | Beta: 1.00 | Loss: 148.7242 | NLL: 64.2073 | KL: 84.5168
Epoch 0730 | Beta: 1.00 | Loss: 146.5270 | NLL: 61.8909 | KL: 84.6361
Epoch 0740 | Beta: 1.00 | Loss: 146.5475 | NLL: 61.9255 | KL: 84.6219
Epoch 0750 | Beta: 1.00 | Loss: 145.9073 | NLL: 62.0914 | KL: 83.8159
Epoch 0760 | Beta: 1.00 | Loss: 145.7231 | NLL: 61.1769 | KL: 84.5462
Epoch 0770 | Beta: 1.00 | Loss: 149.7878 | NLL: 65.6321 | KL: 84.1557
Epoch 0780 | Beta: 1.00 | Loss: 147.7405 | NLL: 63.4188 | KL: 84.3217
Epoch 0790 | Beta: 1.00 | Loss: 146.8498 | NLL: 62.0830 | KL: 84.7668
Epoch 0800 | Beta: 1.00 | Loss: 148.6341 | NLL: 64.2028 | KL: 84.4313
Epoch 0810 | Beta: 1.00 | Loss: 145.7850 | NLL: 61.0296 | KL: 84.7555
Epoch 0820 | Beta: 1.00 | Loss: 148.2499 | NLL: 63.5435 | KL: 84.7065
Epoch 0830 | Beta: 1.00 | Loss: 146.9280 | NLL: 61.0692 | KL: 85.8588
Epoch 0840 | Beta: 1.00 | Loss: 146.9262 | NLL: 61.6351 | KL: 85.2911
Epoch 0850 | Beta: 1.00 | Loss: 147.6593 | NLL: 61.6491 | KL: 86.0101
Epoch 0860 | Beta: 1.00 | Loss: 147.4329 | NLL: 61.9176 | KL: 85.5153
Epoch 0870 | Beta: 1.00 | Loss: 147.9104 | NLL: 62.6562 | KL: 85.2543
Epoch 0880 | Beta: 1.00 | Loss: 148.3440 | NLL: 62.3422 | KL: 86.0019
Epoch 0890 | Beta: 1.00 | Loss: 147.4840 | NLL: 62.2708 | KL: 85.2133
Epoch 0900 | Beta: 1.00 | Loss: 146.6180 | NLL: 61.2113 | KL: 85.4067
Epoch 0910 | Beta: 1.00 | Loss: 149.8782 | NLL: 63.7967 | KL: 86.0814
Epoch 0920 | Beta: 1.00 | Loss: 146.6144 | NLL: 60.6951 | KL: 85.9194
Epoch 0930 | Beta: 1.00 | Loss: 148.9425 | NLL: 63.3485 | KL: 85.5940
Epoch 0940 | Beta: 1.00 | Loss: 147.8732 | NLL: 63.4531 | KL: 84.4201
Epoch 0950 | Beta: 1.00 | Loss: 146.4418 | NLL: 62.0119 | KL: 84.4299
Epoch 0960 | Beta: 1.00 | Loss: 145.1691 | NLL: 59.9153 | KL: 85.2538
Epoch 0970 | Beta: 1.00 | Loss: 148.1485 | NLL: 63.1065 | KL: 85.0419
Epoch 0980 | Beta: 1.00 | Loss: 146.8141 | NLL: 61.4409 | KL: 85.3732
Epoch 0990 | Beta: 1.00 | Loss: 146.3296 | NLL: 60.5835 | KL: 85.7461
Epoch 1000 | Beta: 1.00 | Loss: 148.1455 | NLL: 61.7061 | KL: 86.4394
Skipping Correlation Analysis: No active units.

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1105
Violazioni Attese: 55.2
Violazioni Osservate: 22
Frequenza Osservata: 0.0199 (Target: 0.0500)
LR Statistic: 27.0259 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1061, n01=21, n10=21, n11=1
LR Independence: 0.5558 (p-value: 0.4559)
LR Conditional Coverage (CC): 27.5817 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_060002/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_062846
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_062846

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 25
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_062846
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 130.4853 | NLL: 126.2489 | KL: 47.0703
Epoch 0020 | Beta: 0.19 | Loss: 120.6819 | NLL: 110.5699 | KL: 53.2210
Epoch 0030 | Beta: 0.29 | Loss: 121.1467 | NLL: 105.7282 | KL: 53.1672
Epoch 0040 | Beta: 0.39 | Loss: 116.2184 | NLL: 92.4847 | KL: 60.8558
Epoch 0050 | Beta: 0.49 | Loss: 112.2502 | NLL: 79.9384 | KL: 65.9425
Epoch 0060 | Beta: 0.59 | Loss: 108.0606 | NLL: 67.9492 | KL: 67.9854
Epoch 0070 | Beta: 0.69 | Loss: 113.9937 | NLL: 67.3599 | KL: 67.5852
Epoch 0080 | Beta: 0.79 | Loss: 117.7513 | NLL: 65.5458 | KL: 66.0829
Epoch 0090 | Beta: 0.89 | Loss: 123.4946 | NLL: 65.9593 | KL: 64.6464
Epoch 0100 | Beta: 0.99 | Loss: 130.5224 | NLL: 67.7216 | KL: 63.4351
Epoch 0110 | Beta: 1.00 | Loss: 131.0999 | NLL: 67.1045 | KL: 63.9954
Epoch 0120 | Beta: 1.00 | Loss: 128.7054 | NLL: 65.7276 | KL: 62.9778
Epoch 0130 | Beta: 1.00 | Loss: 127.7068 | NLL: 63.9013 | KL: 63.8054
Epoch 0140 | Beta: 1.00 | Loss: 128.1019 | NLL: 64.8157 | KL: 63.2862
Epoch 0150 | Beta: 1.00 | Loss: 127.6989 | NLL: 64.8395 | KL: 62.8595
Epoch 0160 | Beta: 1.00 | Loss: 127.1315 | NLL: 64.1521 | KL: 62.9795
Epoch 0170 | Beta: 1.00 | Loss: 127.9832 | NLL: 64.8604 | KL: 63.1227
Epoch 0180 | Beta: 1.00 | Loss: 128.0495 | NLL: 65.1600 | KL: 62.8894
Epoch 0190 | Beta: 1.00 | Loss: 128.2325 | NLL: 64.7959 | KL: 63.4366
Epoch 0200 | Beta: 1.00 | Loss: 125.9913 | NLL: 63.3183 | KL: 62.6730
Epoch 0210 | Beta: 1.00 | Loss: 129.3709 | NLL: 66.3246 | KL: 63.0463
Epoch 0220 | Beta: 1.00 | Loss: 127.6599 | NLL: 64.6467 | KL: 63.0132
Epoch 0230 | Beta: 1.00 | Loss: 128.8852 | NLL: 65.5286 | KL: 63.3565
Epoch 0240 | Beta: 1.00 | Loss: 127.0947 | NLL: 63.6581 | KL: 63.4366
Epoch 0250 | Beta: 1.00 | Loss: 125.9888 | NLL: 63.9263 | KL: 62.0626
Epoch 0260 | Beta: 1.00 | Loss: 128.3103 | NLL: 65.7598 | KL: 62.5505
Epoch 0270 | Beta: 1.00 | Loss: 128.5701 | NLL: 65.4358 | KL: 63.1343
Epoch 0280 | Beta: 1.00 | Loss: 128.1376 | NLL: 64.0542 | KL: 64.0833
Epoch 0290 | Beta: 1.00 | Loss: 129.3139 | NLL: 66.3817 | KL: 62.9323
Epoch 0300 | Beta: 1.00 | Loss: 126.1632 | NLL: 63.2498 | KL: 62.9133
Epoch 0310 | Beta: 1.00 | Loss: 126.5612 | NLL: 63.2530 | KL: 63.3081
Epoch 0320 | Beta: 1.00 | Loss: 125.2136 | NLL: 61.3860 | KL: 63.8276
Epoch 0330 | Beta: 1.00 | Loss: 125.3201 | NLL: 61.8767 | KL: 63.4434
Epoch 0340 | Beta: 1.00 | Loss: 127.1913 | NLL: 63.0371 | KL: 64.1542
Epoch 0350 | Beta: 1.00 | Loss: 124.7396 | NLL: 60.7470 | KL: 63.9926
Epoch 0360 | Beta: 1.00 | Loss: 128.0447 | NLL: 64.6803 | KL: 63.3644
Epoch 0370 | Beta: 1.00 | Loss: 126.1420 | NLL: 62.9506 | KL: 63.1914
Epoch 0380 | Beta: 1.00 | Loss: 130.0239 | NLL: 66.8922 | KL: 63.1317
Epoch 0390 | Beta: 1.00 | Loss: 127.0405 | NLL: 63.7389 | KL: 63.3016
Epoch 0400 | Beta: 1.00 | Loss: 125.9790 | NLL: 62.1222 | KL: 63.8568
Epoch 0410 | Beta: 1.00 | Loss: 125.6906 | NLL: 62.3522 | KL: 63.3384
Epoch 0420 | Beta: 1.00 | Loss: 127.2461 | NLL: 63.3395 | KL: 63.9066
Epoch 0430 | Beta: 1.00 | Loss: 127.2740 | NLL: 64.6257 | KL: 62.6483
Epoch 0440 | Beta: 1.00 | Loss: 126.4307 | NLL: 63.2694 | KL: 63.1612
Epoch 0450 | Beta: 1.00 | Loss: 128.0275 | NLL: 65.3100 | KL: 62.7175
Epoch 0460 | Beta: 1.00 | Loss: 126.6328 | NLL: 63.9425 | KL: 62.6903
Epoch 0470 | Beta: 1.00 | Loss: 129.3002 | NLL: 64.5986 | KL: 64.7016
Epoch 0480 | Beta: 1.00 | Loss: 126.9896 | NLL: 62.9815 | KL: 64.0081
Epoch 0490 | Beta: 1.00 | Loss: 127.8906 | NLL: 63.7760 | KL: 64.1146
Epoch 0500 | Beta: 1.00 | Loss: 130.7091 | NLL: 66.7822 | KL: 63.9270
Epoch 0510 | Beta: 1.00 | Loss: 126.0557 | NLL: 62.5580 | KL: 63.4978
Epoch 0520 | Beta: 1.00 | Loss: 127.3263 | NLL: 63.9352 | KL: 63.3910
Epoch 0530 | Beta: 1.00 | Loss: 125.0846 | NLL: 61.5308 | KL: 63.5538
Epoch 0540 | Beta: 1.00 | Loss: 127.9149 | NLL: 64.3638 | KL: 63.5511
Epoch 0550 | Beta: 1.00 | Loss: 128.8596 | NLL: 64.1776 | KL: 64.6820
Epoch 0560 | Beta: 1.00 | Loss: 126.0988 | NLL: 62.3658 | KL: 63.7330
Epoch 0570 | Beta: 1.00 | Loss: 128.6613 | NLL: 64.2217 | KL: 64.4396
Epoch 0580 | Beta: 1.00 | Loss: 128.6298 | NLL: 64.1801 | KL: 64.4498
Epoch 0590 | Beta: 1.00 | Loss: 128.3004 | NLL: 64.4452 | KL: 63.8553
Epoch 0600 | Beta: 1.00 | Loss: 127.4412 | NLL: 61.9141 | KL: 65.5272
Epoch 0610 | Beta: 1.00 | Loss: 127.7681 | NLL: 64.3272 | KL: 63.4410
Epoch 0620 | Beta: 1.00 | Loss: 130.2906 | NLL: 66.0281 | KL: 64.2624
Epoch 0630 | Beta: 1.00 | Loss: 137.1122 | NLL: 72.0895 | KL: 65.0227
Epoch 0640 | Beta: 1.00 | Loss: 126.4030 | NLL: 61.5160 | KL: 64.8871
Epoch 0650 | Beta: 1.00 | Loss: 126.2190 | NLL: 61.3613 | KL: 64.8577
Epoch 0660 | Beta: 1.00 | Loss: 125.8367 | NLL: 62.0745 | KL: 63.7622
Epoch 0670 | Beta: 1.00 | Loss: 125.4684 | NLL: 60.8062 | KL: 64.6622
Epoch 0680 | Beta: 1.00 | Loss: 125.8724 | NLL: 61.0637 | KL: 64.8087
Epoch 0690 | Beta: 1.00 | Loss: 125.0813 | NLL: 60.9057 | KL: 64.1756
Epoch 0700 | Beta: 1.00 | Loss: 124.8724 | NLL: 61.1058 | KL: 63.7666
Epoch 0710 | Beta: 1.00 | Loss: 125.8806 | NLL: 61.5992 | KL: 64.2814
Epoch 0720 | Beta: 1.00 | Loss: 126.0535 | NLL: 61.7709 | KL: 64.2826
Epoch 0730 | Beta: 1.00 | Loss: 125.1421 | NLL: 61.6709 | KL: 63.4713
Epoch 0740 | Beta: 1.00 | Loss: 127.2274 | NLL: 63.1284 | KL: 64.0990
Epoch 0750 | Beta: 1.00 | Loss: 123.4575 | NLL: 59.0128 | KL: 64.4447
Epoch 0760 | Beta: 1.00 | Loss: 125.9999 | NLL: 62.1047 | KL: 63.8952
Epoch 0770 | Beta: 1.00 | Loss: 124.6469 | NLL: 60.7486 | KL: 63.8982
Epoch 0780 | Beta: 1.00 | Loss: 126.9902 | NLL: 63.2973 | KL: 63.6929
Epoch 0790 | Beta: 1.00 | Loss: 127.1852 | NLL: 62.5818 | KL: 64.6034
Epoch 0800 | Beta: 1.00 | Loss: 125.1552 | NLL: 60.7073 | KL: 64.4479
Epoch 0810 | Beta: 1.00 | Loss: 126.0242 | NLL: 61.1643 | KL: 64.8599
Epoch 0820 | Beta: 1.00 | Loss: 124.2830 | NLL: 60.0697 | KL: 64.2132
Epoch 0830 | Beta: 1.00 | Loss: 125.8759 | NLL: 61.2132 | KL: 64.6627
Epoch 0840 | Beta: 1.00 | Loss: 124.2663 | NLL: 60.1040 | KL: 64.1623
Epoch 0850 | Beta: 1.00 | Loss: 126.0359 | NLL: 61.5116 | KL: 64.5243
Epoch 0860 | Beta: 1.00 | Loss: 126.3848 | NLL: 62.2158 | KL: 64.1689
Epoch 0870 | Beta: 1.00 | Loss: 125.4640 | NLL: 61.3009 | KL: 64.1631
Epoch 0880 | Beta: 1.00 | Loss: 125.5623 | NLL: 60.9793 | KL: 64.5830
Epoch 0890 | Beta: 1.00 | Loss: 125.8454 | NLL: 62.3545 | KL: 63.4909
Epoch 0900 | Beta: 1.00 | Loss: 127.6247 | NLL: 63.2881 | KL: 64.3366
Epoch 0910 | Beta: 1.00 | Loss: 125.7475 | NLL: 61.3526 | KL: 64.3949
Epoch 0920 | Beta: 1.00 | Loss: 124.4932 | NLL: 60.6220 | KL: 63.8712
Epoch 0930 | Beta: 1.00 | Loss: 125.9577 | NLL: 61.0975 | KL: 64.8601
Epoch 0940 | Beta: 1.00 | Loss: 124.3204 | NLL: 59.7138 | KL: 64.6066
Epoch 0950 | Beta: 1.00 | Loss: 124.6276 | NLL: 59.2787 | KL: 65.3489
Epoch 0960 | Beta: 1.00 | Loss: 125.5750 | NLL: 62.0515 | KL: 63.5235
Epoch 0970 | Beta: 1.00 | Loss: 124.3113 | NLL: 59.7037 | KL: 64.6076
Epoch 0980 | Beta: 1.00 | Loss: 123.4304 | NLL: 58.7187 | KL: 64.7117
Epoch 0990 | Beta: 1.00 | Loss: 128.4578 | NLL: 63.1712 | KL: 65.2866
Epoch 1000 | Beta: 1.00 | Loss: 123.8188 | NLL: 59.7677 | KL: 64.0511
Correlation Heatmap saved to paper_plots\run_20260103_062846/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1105
Violazioni Attese: 55.2
Violazioni Osservate: 20
Frequenza Osservata: 0.0181 (Target: 0.0500)
LR Statistic: 31.0252 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1066, n01=18, n10=18, n11=2
LR Independence: 3.8417 (p-value: 0.0500)
LR Conditional Coverage (CC): 34.8669 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_062846/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_065543
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_065543

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 26
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_065543
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 131.7354 | NLL: 125.7826 | KL: 66.1422
Epoch 0020 | Beta: 0.19 | Loss: 119.2082 | NLL: 106.2260 | KL: 68.3277
Epoch 0030 | Beta: 0.29 | Loss: 115.2253 | NLL: 92.8831 | KL: 77.0423
Epoch 0040 | Beta: 0.39 | Loss: 109.1667 | NLL: 76.5142 | KL: 83.7241
Epoch 0050 | Beta: 0.49 | Loss: 109.0032 | NLL: 68.1687 | KL: 83.3357
Epoch 0060 | Beta: 0.59 | Loss: 115.2637 | NLL: 67.2705 | KL: 81.3444
Epoch 0070 | Beta: 0.69 | Loss: 120.1721 | NLL: 65.4080 | KL: 79.3683
Epoch 0080 | Beta: 0.79 | Loss: 128.5849 | NLL: 67.2396 | KL: 77.6522
Epoch 0090 | Beta: 0.89 | Loss: 133.2359 | NLL: 65.8954 | KL: 75.6635
Epoch 0100 | Beta: 0.99 | Loss: 141.2304 | NLL: 68.0045 | KL: 73.9656
Epoch 0110 | Beta: 1.00 | Loss: 139.9599 | NLL: 66.3117 | KL: 73.6482
Epoch 0120 | Beta: 1.00 | Loss: 140.2042 | NLL: 66.6358 | KL: 73.5683
Epoch 0130 | Beta: 1.00 | Loss: 139.6356 | NLL: 66.1672 | KL: 73.4684
Epoch 0140 | Beta: 1.00 | Loss: 140.3505 | NLL: 67.3078 | KL: 73.0427
Epoch 0150 | Beta: 1.00 | Loss: 141.3524 | NLL: 68.1978 | KL: 73.1547
Epoch 0160 | Beta: 1.00 | Loss: 141.1984 | NLL: 68.1151 | KL: 73.0833
Epoch 0170 | Beta: 1.00 | Loss: 139.7559 | NLL: 66.0599 | KL: 73.6961
Epoch 0180 | Beta: 1.00 | Loss: 140.2988 | NLL: 66.0207 | KL: 74.2781
Epoch 0190 | Beta: 1.00 | Loss: 140.1394 | NLL: 66.3648 | KL: 73.7746
Epoch 0200 | Beta: 1.00 | Loss: 140.7450 | NLL: 67.0882 | KL: 73.6568
Epoch 0210 | Beta: 1.00 | Loss: 140.9021 | NLL: 66.3680 | KL: 74.5341
Epoch 0220 | Beta: 1.00 | Loss: 141.7197 | NLL: 67.6974 | KL: 74.0223
Epoch 0230 | Beta: 1.00 | Loss: 138.3792 | NLL: 64.7770 | KL: 73.6021
Epoch 0240 | Beta: 1.00 | Loss: 141.7821 | NLL: 67.2892 | KL: 74.4929
Epoch 0250 | Beta: 1.00 | Loss: 141.1547 | NLL: 67.7640 | KL: 73.3907
Epoch 0260 | Beta: 1.00 | Loss: 141.5876 | NLL: 67.8473 | KL: 73.7403
Epoch 0270 | Beta: 1.00 | Loss: 140.8043 | NLL: 67.6049 | KL: 73.1993
Epoch 0280 | Beta: 1.00 | Loss: 142.5433 | NLL: 69.1633 | KL: 73.3799
Epoch 0290 | Beta: 1.00 | Loss: 138.5148 | NLL: 64.5954 | KL: 73.9194
Epoch 0300 | Beta: 1.00 | Loss: 142.3725 | NLL: 67.9882 | KL: 74.3843
Epoch 0310 | Beta: 1.00 | Loss: 141.1975 | NLL: 67.5031 | KL: 73.6943
Epoch 0320 | Beta: 1.00 | Loss: 139.3583 | NLL: 66.1370 | KL: 73.2213
Epoch 0330 | Beta: 1.00 | Loss: 138.8580 | NLL: 65.2259 | KL: 73.6321
Epoch 0340 | Beta: 1.00 | Loss: 140.2322 | NLL: 65.7480 | KL: 74.4842
Epoch 0350 | Beta: 1.00 | Loss: 141.1010 | NLL: 67.8187 | KL: 73.2822
Epoch 0360 | Beta: 1.00 | Loss: 141.2631 | NLL: 68.7635 | KL: 72.4996
Epoch 0370 | Beta: 1.00 | Loss: 140.9261 | NLL: 67.4041 | KL: 73.5220
Epoch 0380 | Beta: 1.00 | Loss: 139.0482 | NLL: 65.3482 | KL: 73.7000
Epoch 0390 | Beta: 1.00 | Loss: 139.0025 | NLL: 64.8399 | KL: 74.1625
Epoch 0400 | Beta: 1.00 | Loss: 139.7831 | NLL: 65.9294 | KL: 73.8536
Epoch 0410 | Beta: 1.00 | Loss: 138.7132 | NLL: 64.0284 | KL: 74.6847
Epoch 0420 | Beta: 1.00 | Loss: 139.5948 | NLL: 65.6115 | KL: 73.9833
Epoch 0430 | Beta: 1.00 | Loss: 139.5714 | NLL: 64.6452 | KL: 74.9262
Epoch 0440 | Beta: 1.00 | Loss: 139.2133 | NLL: 64.1770 | KL: 75.0363
Epoch 0450 | Beta: 1.00 | Loss: 140.8621 | NLL: 67.7007 | KL: 73.1614
Epoch 0460 | Beta: 1.00 | Loss: 139.1877 | NLL: 65.6997 | KL: 73.4880
Epoch 0470 | Beta: 1.00 | Loss: 141.1341 | NLL: 66.9498 | KL: 74.1843
Epoch 0480 | Beta: 1.00 | Loss: 138.3792 | NLL: 64.9318 | KL: 73.4474
Epoch 0490 | Beta: 1.00 | Loss: 139.7922 | NLL: 65.4790 | KL: 74.3132
Epoch 0500 | Beta: 1.00 | Loss: 138.0506 | NLL: 64.0969 | KL: 73.9537
Epoch 0510 | Beta: 1.00 | Loss: 139.0840 | NLL: 65.2667 | KL: 73.8173
Epoch 0520 | Beta: 1.00 | Loss: 139.0064 | NLL: 64.5866 | KL: 74.4198
Epoch 0530 | Beta: 1.00 | Loss: 138.8135 | NLL: 65.4218 | KL: 73.3916
Epoch 0540 | Beta: 1.00 | Loss: 141.1972 | NLL: 66.6700 | KL: 74.5272
Epoch 0550 | Beta: 1.00 | Loss: 139.6945 | NLL: 65.9498 | KL: 73.7447
Epoch 0560 | Beta: 1.00 | Loss: 139.8349 | NLL: 65.8622 | KL: 73.9726
Epoch 0570 | Beta: 1.00 | Loss: 138.6866 | NLL: 64.9206 | KL: 73.7660
Epoch 0580 | Beta: 1.00 | Loss: 138.1430 | NLL: 64.3668 | KL: 73.7762
Epoch 0590 | Beta: 1.00 | Loss: 137.0522 | NLL: 63.7373 | KL: 73.3148
Epoch 0600 | Beta: 1.00 | Loss: 138.2033 | NLL: 64.0737 | KL: 74.1296
Epoch 0610 | Beta: 1.00 | Loss: 138.5374 | NLL: 63.7231 | KL: 74.8143
Epoch 0620 | Beta: 1.00 | Loss: 138.6167 | NLL: 64.6478 | KL: 73.9690
Epoch 0630 | Beta: 1.00 | Loss: 136.6779 | NLL: 62.2693 | KL: 74.4086
Epoch 0640 | Beta: 1.00 | Loss: 139.3552 | NLL: 64.6706 | KL: 74.6846
Epoch 0650 | Beta: 1.00 | Loss: 135.8039 | NLL: 60.7179 | KL: 75.0860
Epoch 0660 | Beta: 1.00 | Loss: 140.4838 | NLL: 65.4595 | KL: 75.0244
Epoch 0670 | Beta: 1.00 | Loss: 138.2354 | NLL: 63.3130 | KL: 74.9224
Epoch 0680 | Beta: 1.00 | Loss: 137.7818 | NLL: 62.1262 | KL: 75.6556
Epoch 0690 | Beta: 1.00 | Loss: 136.2290 | NLL: 61.2218 | KL: 75.0072
Epoch 0700 | Beta: 1.00 | Loss: 138.4373 | NLL: 65.2396 | KL: 73.1977
Epoch 0710 | Beta: 1.00 | Loss: 137.7224 | NLL: 63.3055 | KL: 74.4168
Epoch 0720 | Beta: 1.00 | Loss: 139.9588 | NLL: 64.8704 | KL: 75.0883
Epoch 0730 | Beta: 1.00 | Loss: 137.2631 | NLL: 63.2135 | KL: 74.0497
Epoch 0740 | Beta: 1.00 | Loss: 137.7905 | NLL: 63.8988 | KL: 73.8917
Epoch 0750 | Beta: 1.00 | Loss: 138.5974 | NLL: 64.1628 | KL: 74.4346
Epoch 0760 | Beta: 1.00 | Loss: 138.0731 | NLL: 64.0594 | KL: 74.0137
Epoch 0770 | Beta: 1.00 | Loss: 137.5801 | NLL: 62.7789 | KL: 74.8013
Epoch 0780 | Beta: 1.00 | Loss: 137.6157 | NLL: 62.6097 | KL: 75.0060
Epoch 0790 | Beta: 1.00 | Loss: 140.2668 | NLL: 65.6047 | KL: 74.6621
Epoch 0800 | Beta: 1.00 | Loss: 138.9436 | NLL: 64.4540 | KL: 74.4896
Epoch 0810 | Beta: 1.00 | Loss: 142.8577 | NLL: 68.6893 | KL: 74.1684
Epoch 0820 | Beta: 1.00 | Loss: 137.1195 | NLL: 62.7085 | KL: 74.4110
Epoch 0830 | Beta: 1.00 | Loss: 134.3624 | NLL: 60.0568 | KL: 74.3055
Epoch 0840 | Beta: 1.00 | Loss: 139.4674 | NLL: 64.4910 | KL: 74.9764
Epoch 0850 | Beta: 1.00 | Loss: 139.8522 | NLL: 65.2758 | KL: 74.5763
Epoch 0860 | Beta: 1.00 | Loss: 136.0095 | NLL: 61.5874 | KL: 74.4221
Epoch 0870 | Beta: 1.00 | Loss: 136.9899 | NLL: 62.0918 | KL: 74.8981
Epoch 0880 | Beta: 1.00 | Loss: 137.0633 | NLL: 62.2885 | KL: 74.7747
Epoch 0890 | Beta: 1.00 | Loss: 138.1676 | NLL: 64.1774 | KL: 73.9902
Epoch 0900 | Beta: 1.00 | Loss: 147.0803 | NLL: 72.9447 | KL: 74.1356
Epoch 0910 | Beta: 1.00 | Loss: 139.6911 | NLL: 65.8332 | KL: 73.8578
Epoch 0920 | Beta: 1.00 | Loss: 135.9253 | NLL: 62.5059 | KL: 73.4194
Epoch 0930 | Beta: 1.00 | Loss: 137.8448 | NLL: 62.4229 | KL: 75.4219
Epoch 0940 | Beta: 1.00 | Loss: 140.0006 | NLL: 65.6044 | KL: 74.3962
Epoch 0950 | Beta: 1.00 | Loss: 139.9645 | NLL: 65.1636 | KL: 74.8010
Epoch 0960 | Beta: 1.00 | Loss: 136.0767 | NLL: 61.8325 | KL: 74.2442
Epoch 0970 | Beta: 1.00 | Loss: 140.3683 | NLL: 65.7866 | KL: 74.5817
Epoch 0980 | Beta: 1.00 | Loss: 137.4302 | NLL: 63.4816 | KL: 73.9485
Epoch 0990 | Beta: 1.00 | Loss: 138.7117 | NLL: 64.7137 | KL: 73.9980
Epoch 1000 | Beta: 1.00 | Loss: 136.3012 | NLL: 61.8575 | KL: 74.4437
Correlation Heatmap saved to paper_plots\run_20260103_065543/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1105
Violazioni Attese: 55.2
Violazioni Osservate: 22
Frequenza Osservata: 0.0199 (Target: 0.0500)
LR Statistic: 27.0259 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1062, n01=20, n10=20, n11=2
LR Independence: 3.1820 (p-value: 0.0745)
LR Conditional Coverage (CC): 30.2079 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_065543/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_092323
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_092323

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 24
latent_dim: 10
hidden_dim: 27
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_092323
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 132.8377 | NLL: 127.2201 | KL: 62.4174
Epoch 0020 | Beta: 0.19 | Loss: 125.9852 | NLL: 114.3929 | KL: 61.0122
Epoch 0030 | Beta: 0.29 | Loss: 124.3616 | NLL: 105.7706 | KL: 64.1069
Epoch 0040 | Beta: 0.39 | Loss: 120.2525 | NLL: 92.6260 | KL: 70.8374
Epoch 0050 | Beta: 0.49 | Loss: 112.7891 | NLL: 75.4569 | KL: 76.1882
Epoch 0060 | Beta: 0.59 | Loss: 113.8169 | NLL: 68.4806 | KL: 76.8412
Epoch 0070 | Beta: 0.69 | Loss: 118.7639 | NLL: 66.3970 | KL: 75.8941
Epoch 0080 | Beta: 0.79 | Loss: 126.7019 | NLL: 67.7968 | KL: 74.5634
Epoch 0090 | Beta: 0.89 | Loss: 132.5804 | NLL: 67.1646 | KL: 73.5009
Epoch 0100 | Beta: 0.99 | Loss: 139.0687 | NLL: 68.2285 | KL: 71.5557
Epoch 0110 | Beta: 1.00 | Loss: 139.8862 | NLL: 68.1327 | KL: 71.7534
Epoch 0120 | Beta: 1.00 | Loss: 137.2779 | NLL: 66.4877 | KL: 70.7902
Epoch 0130 | Beta: 1.00 | Loss: 138.5038 | NLL: 68.1804 | KL: 70.3234
Epoch 0140 | Beta: 1.00 | Loss: 137.6807 | NLL: 66.9839 | KL: 70.6968
Epoch 0150 | Beta: 1.00 | Loss: 137.7867 | NLL: 66.8477 | KL: 70.9390
Epoch 0160 | Beta: 1.00 | Loss: 136.6119 | NLL: 64.5618 | KL: 72.0500
Epoch 0170 | Beta: 1.00 | Loss: 136.3559 | NLL: 64.9072 | KL: 71.4486
Epoch 0180 | Beta: 1.00 | Loss: 138.3077 | NLL: 67.2933 | KL: 71.0145
Epoch 0190 | Beta: 1.00 | Loss: 136.9599 | NLL: 65.5489 | KL: 71.4110
Epoch 0200 | Beta: 1.00 | Loss: 138.0910 | NLL: 66.4783 | KL: 71.6127
Epoch 0210 | Beta: 1.00 | Loss: 139.2564 | NLL: 67.3792 | KL: 71.8772
Epoch 0220 | Beta: 1.00 | Loss: 139.1702 | NLL: 67.2132 | KL: 71.9570
Epoch 0230 | Beta: 1.00 | Loss: 137.2297 | NLL: 65.2138 | KL: 72.0159
Epoch 0240 | Beta: 1.00 | Loss: 136.9793 | NLL: 63.7172 | KL: 73.2621
Epoch 0250 | Beta: 1.00 | Loss: 138.1860 | NLL: 66.6199 | KL: 71.5661
Epoch 0260 | Beta: 1.00 | Loss: 136.2675 | NLL: 64.3576 | KL: 71.9099
Epoch 0270 | Beta: 1.00 | Loss: 137.5912 | NLL: 65.8921 | KL: 71.6991
Epoch 0280 | Beta: 1.00 | Loss: 139.2433 | NLL: 65.9583 | KL: 73.2850
Epoch 0290 | Beta: 1.00 | Loss: 138.0641 | NLL: 65.5051 | KL: 72.5590

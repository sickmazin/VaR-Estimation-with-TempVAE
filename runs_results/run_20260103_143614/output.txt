Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_143614
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_143614

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 29
latent_dim: 10
hidden_dim: 16
batch_size: 140
epochs: 1000
annealing_epochs: 100
learning_rate: 0.0005
l2_reg: 0.01
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_143614
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
annealing_decay_rate: 0.96
annealing_steps: 20
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.02 | Loss: 158.4494 | NLL: 156.4299 | KL: 110.9478
Epoch 0020 | Beta: 0.04 | Loss: 155.8432 | NLL: 153.6222 | KL: 58.3877
Epoch 0030 | Beta: 0.06 | Loss: 145.2362 | NLL: 140.7293 | KL: 78.4168
Epoch 0040 | Beta: 0.08 | Loss: 132.7300 | NLL: 125.9395 | KL: 88.7443
Epoch 0050 | Beta: 0.10 | Loss: 120.7317 | NLL: 110.6817 | KL: 105.5942
Epoch 0060 | Beta: 0.11 | Loss: 108.3982 | NLL: 95.5553 | KL: 113.1971
Epoch 0070 | Beta: 0.13 | Loss: 101.4849 | NLL: 86.1719 | KL: 116.5661
Epoch 0080 | Beta: 0.15 | Loss: 97.6281 | NLL: 80.1211 | KL: 117.5607
Epoch 0090 | Beta: 0.17 | Loss: 97.7826 | NLL: 78.3678 | KL: 116.8770
Epoch 0100 | Beta: 0.18 | Loss: 96.4517 | NLL: 75.3243 | KL: 115.4749
Epoch 0110 | Beta: 0.20 | Loss: 97.2127 | NLL: 74.1901 | KL: 115.4192
Epoch 0120 | Beta: 0.22 | Loss: 98.8359 | NLL: 74.4950 | KL: 112.8757
Epoch 0130 | Beta: 0.23 | Loss: 99.4240 | NLL: 73.2156 | KL: 113.2160
Epoch 0140 | Beta: 0.25 | Loss: 99.9251 | NLL: 72.0401 | KL: 112.8868
Epoch 0150 | Beta: 0.26 | Loss: 101.6627 | NLL: 72.5879 | KL: 110.8749
Epoch 0160 | Beta: 0.28 | Loss: 102.5953 | NLL: 72.0379 | KL: 110.2612
Epoch 0170 | Beta: 0.29 | Loss: 103.6150 | NLL: 71.6164 | KL: 109.6814
Epoch 0180 | Beta: 0.31 | Loss: 104.5737 | NLL: 71.1087 | KL: 109.3444
Epoch 0190 | Beta: 0.32 | Loss: 104.3811 | NLL: 69.4045 | KL: 109.2773
Epoch 0200 | Beta: 0.33 | Loss: 108.2847 | NLL: 72.2683 | KL: 107.8952
Epoch 0210 | Beta: 0.35 | Loss: 107.5545 | NLL: 70.1144 | KL: 107.8128
Epoch 0220 | Beta: 0.36 | Loss: 109.9328 | NLL: 71.2693 | KL: 107.2626
Epoch 0230 | Beta: 0.37 | Loss: 109.7496 | NLL: 69.8075 | KL: 106.9748
Epoch 0240 | Beta: 0.39 | Loss: 109.5404 | NLL: 68.4826 | KL: 106.3567
Epoch 0250 | Beta: 0.40 | Loss: 110.6317 | NLL: 68.3894 | KL: 106.0185
Epoch 0260 | Beta: 0.41 | Loss: 114.2283 | NLL: 71.2997 | KL: 104.5519
Epoch 0270 | Beta: 0.42 | Loss: 114.3251 | NLL: 70.2528 | KL: 104.3117
Epoch 0280 | Beta: 0.43 | Loss: 114.8645 | NLL: 69.4046 | KL: 104.7046
Epoch 0290 | Beta: 0.45 | Loss: 114.6216 | NLL: 68.2300 | KL: 104.1093
Epoch 0300 | Beta: 0.46 | Loss: 114.6582 | NLL: 67.0847 | KL: 104.1437
Epoch 0310 | Beta: 0.47 | Loss: 115.6328 | NLL: 66.9385 | KL: 104.0963
Epoch 0320 | Beta: 0.48 | Loss: 116.0533 | NLL: 66.8186 | KL: 102.8866
Epoch 0330 | Beta: 0.49 | Loss: 117.3976 | NLL: 67.2639 | KL: 102.5084
Epoch 0340 | Beta: 0.50 | Loss: 117.9090 | NLL: 66.6266 | KL: 102.6896
Epoch 0350 | Beta: 0.51 | Loss: 119.6846 | NLL: 67.9461 | KL: 101.5464
Epoch 0360 | Beta: 0.52 | Loss: 121.7960 | NLL: 68.6227 | KL: 102.3713
Epoch 0370 | Beta: 0.53 | Loss: 121.5504 | NLL: 68.1674 | KL: 100.8890
Epoch 0380 | Beta: 0.54 | Loss: 122.3685 | NLL: 67.7210 | KL: 101.4545
Epoch 0390 | Beta: 0.55 | Loss: 121.3074 | NLL: 65.7992 | KL: 101.2996
Epoch 0400 | Beta: 0.56 | Loss: 122.1578 | NLL: 66.5259 | KL: 99.8609
Epoch 0410 | Beta: 0.57 | Loss: 122.4891 | NLL: 65.4762 | KL: 100.7219
Epoch 0420 | Beta: 0.57 | Loss: 123.3271 | NLL: 66.0800 | KL: 99.5929
Epoch 0430 | Beta: 0.58 | Loss: 124.5332 | NLL: 66.3375 | KL: 99.7524
Epoch 0440 | Beta: 0.59 | Loss: 124.7969 | NLL: 65.3829 | KL: 100.3923
Epoch 0450 | Beta: 0.60 | Loss: 123.7443 | NLL: 64.0229 | KL: 99.5248
Epoch 0460 | Beta: 0.61 | Loss: 127.0307 | NLL: 67.3286 | KL: 98.1707
Epoch 0470 | Beta: 0.62 | Loss: 126.3071 | NLL: 65.4348 | KL: 98.8086
Epoch 0480 | Beta: 0.62 | Loss: 126.2746 | NLL: 65.0319 | KL: 98.1737
Epoch 0490 | Beta: 0.63 | Loss: 127.0839 | NLL: 64.7245 | KL: 98.7606
Epoch 0500 | Beta: 0.64 | Loss: 127.8697 | NLL: 64.9514 | KL: 98.4841
Epoch 0510 | Beta: 0.65 | Loss: 129.4552 | NLL: 66.8501 | KL: 96.8874
Epoch 0520 | Beta: 0.65 | Loss: 129.2493 | NLL: 64.8477 | KL: 98.5770
Epoch 0530 | Beta: 0.66 | Loss: 129.7807 | NLL: 65.5582 | KL: 97.2601
Epoch 0540 | Beta: 0.67 | Loss: 129.0500 | NLL: 64.6293 | KL: 96.5567
Epoch 0550 | Beta: 0.67 | Loss: 131.9216 | NLL: 66.3747 | KL: 97.2644
Epoch 0560 | Beta: 0.68 | Loss: 131.4903 | NLL: 65.1897 | KL: 97.4303
Epoch 0570 | Beta: 0.69 | Loss: 132.8702 | NLL: 67.1104 | KL: 95.7275
Epoch 0580 | Beta: 0.69 | Loss: 131.2847 | NLL: 64.4863 | KL: 96.3522
Epoch 0590 | Beta: 0.70 | Loss: 132.9131 | NLL: 65.4186 | KL: 96.4937
Epoch 0600 | Beta: 0.71 | Loss: 133.9050 | NLL: 65.6331 | KL: 96.7652
Epoch 0610 | Beta: 0.71 | Loss: 132.0264 | NLL: 62.7054 | KL: 97.4305
Epoch 0620 | Beta: 0.72 | Loss: 132.0649 | NLL: 62.7518 | KL: 96.6278
Epoch 0630 | Beta: 0.72 | Loss: 132.8227 | NLL: 63.1367 | KL: 96.3802
Epoch 0640 | Beta: 0.73 | Loss: 132.4588 | NLL: 62.4838 | KL: 96.0368
Epoch 0650 | Beta: 0.73 | Loss: 134.2277 | NLL: 63.4934 | KL: 96.3538
Epoch 0660 | Beta: 0.74 | Loss: 135.3171 | NLL: 64.8041 | KL: 95.3544
Epoch 0670 | Beta: 0.74 | Loss: 133.6122 | NLL: 62.1999 | KL: 95.8881
Epoch 0680 | Beta: 0.75 | Loss: 136.2945 | NLL: 63.9983 | KL: 96.4074
Epoch 0690 | Beta: 0.75 | Loss: 137.3278 | NLL: 65.2423 | KL: 95.4830
Epoch 0700 | Beta: 0.76 | Loss: 135.8554 | NLL: 63.4939 | KL: 95.2242
Epoch 0710 | Beta: 0.76 | Loss: 134.1128 | NLL: 61.1274 | KL: 95.4360
Epoch 0720 | Beta: 0.77 | Loss: 136.2015 | NLL: 63.5326 | KL: 94.4352
Epoch 0730 | Beta: 0.77 | Loss: 137.1335 | NLL: 64.8618 | KL: 93.3540
Epoch 0740 | Beta: 0.78 | Loss: 136.8974 | NLL: 63.2937 | KL: 94.5175
Epoch 0750 | Beta: 0.78 | Loss: 137.2555 | NLL: 62.6277 | KL: 95.2857
Epoch 0760 | Beta: 0.79 | Loss: 137.2403 | NLL: 62.4429 | KL: 94.9711
Epoch 0770 | Beta: 0.79 | Loss: 138.7184 | NLL: 64.6097 | KL: 93.5866
Epoch 0780 | Beta: 0.80 | Loss: 137.7087 | NLL: 62.6646 | KL: 94.2674
Epoch 0790 | Beta: 0.80 | Loss: 138.2194 | NLL: 63.0156 | KL: 93.9815
Epoch 0800 | Beta: 0.80 | Loss: 139.5207 | NLL: 64.1339 | KL: 93.7373
Epoch 0810 | Beta: 0.81 | Loss: 140.3871 | NLL: 64.1889 | KL: 94.2825
Epoch 0820 | Beta: 0.81 | Loss: 137.8542 | NLL: 61.7566 | KL: 93.7087
Epoch 0830 | Beta: 0.82 | Loss: 141.1891 | NLL: 64.5587 | KL: 93.9256
Epoch 0840 | Beta: 0.82 | Loss: 143.5792 | NLL: 67.9626 | KL: 92.2623
Epoch 0850 | Beta: 0.82 | Loss: 140.7089 | NLL: 63.8746 | KL: 93.3329
Epoch 0860 | Beta: 0.83 | Loss: 140.6115 | NLL: 64.5152 | KL: 92.0372
Epoch 0870 | Beta: 0.83 | Loss: 139.6940 | NLL: 61.6229 | KL: 94.0277
Epoch 0880 | Beta: 0.83 | Loss: 138.3559 | NLL: 59.6139 | KL: 94.4457
Epoch 0890 | Beta: 0.84 | Loss: 146.9509 | NLL: 69.0589 | KL: 93.0513
Epoch 0900 | Beta: 0.84 | Loss: 141.9676 | NLL: 63.2772 | KL: 93.6369
Epoch 0910 | Beta: 0.84 | Loss: 142.5746 | NLL: 64.7706 | KL: 92.2282
Epoch 0920 | Beta: 0.85 | Loss: 142.2621 | NLL: 63.4069 | KL: 93.1254
Epoch 0930 | Beta: 0.85 | Loss: 143.5356 | NLL: 65.2525 | KL: 92.1131
Epoch 0940 | Beta: 0.85 | Loss: 142.4970 | NLL: 63.4047 | KL: 92.7343
Epoch 0950 | Beta: 0.86 | Loss: 143.1578 | NLL: 64.2421 | KL: 92.2058
Epoch 0960 | Beta: 0.86 | Loss: 143.0109 | NLL: 63.7105 | KL: 92.3410
Epoch 0970 | Beta: 0.86 | Loss: 142.0630 | NLL: 62.2133 | KL: 92.6728
Epoch 0980 | Beta: 0.86 | Loss: 142.3408 | NLL: 62.1776 | KL: 92.7357
Epoch 0990 | Beta: 0.87 | Loss: 141.8030 | NLL: 61.9207 | KL: 92.1189
Epoch 1000 | Beta: 0.87 | Loss: 142.6769 | NLL: 61.7669 | KL: 93.0162
Correlation Heatmap saved to paper_plots\run_20260103_143614/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1100
Violazioni Attese: 55.0
Violazioni Osservate: 17
Frequenza Osservata: 0.0155 (Target: 0.0500)
LR Statistic: 37.4453 | P-Value: 0.0000
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1066, n01=16, n10=16, n11=1
LR Independence: 1.2638 (p-value: 0.2609)
LR Conditional Coverage (CC): 38.7091 | P-Value CC: 0.0000
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_143614/var_regimes_plot.png'

>>> Analysis Complete.

Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_150606
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_150606

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 19
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_150606
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 171.4437 | NLL: 159.3360 | KL: 134.5301
Epoch 0020 | Beta: 0.19 | Loss: 172.9616 | NLL: 148.0480 | KL: 131.1241
Epoch 0030 | Beta: 0.29 | Loss: 169.5018 | NLL: 131.6920 | KL: 130.3787
Epoch 0040 | Beta: 0.39 | Loss: 160.5225 | NLL: 105.1714 | KL: 141.9258
Epoch 0050 | Beta: 0.49 | Loss: 154.5740 | NLL: 83.5837 | KL: 144.8780
Epoch 0060 | Beta: 0.59 | Loss: 156.6921 | NLL: 71.8047 | KL: 143.8770
Epoch 0070 | Beta: 0.69 | Loss: 163.5594 | NLL: 64.2119 | KL: 143.9818
Epoch 0080 | Beta: 0.79 | Loss: 172.7056 | NLL: 60.5556 | KL: 141.9621
Epoch 0090 | Beta: 0.89 | Loss: 181.6795 | NLL: 56.8284 | KL: 140.2821
Epoch 0100 | Beta: 0.99 | Loss: 192.1060 | NLL: 53.2317 | KL: 140.2770
Epoch 0110 | Beta: 1.00 | Loss: 196.6601 | NLL: 57.7964 | KL: 138.8637
Epoch 0120 | Beta: 1.00 | Loss: 191.3640 | NLL: 53.5096 | KL: 137.8544
Epoch 0130 | Beta: 1.00 | Loss: 184.5603 | NLL: 47.0675 | KL: 137.4928
Epoch 0140 | Beta: 1.00 | Loss: 183.9779 | NLL: 47.2752 | KL: 136.7026
Epoch 0150 | Beta: 1.00 | Loss: 180.3021 | NLL: 43.5332 | KL: 136.7689
Epoch 0160 | Beta: 1.00 | Loss: 180.3342 | NLL: 43.0333 | KL: 137.3009
Epoch 0170 | Beta: 1.00 | Loss: 175.0912 | NLL: 39.5256 | KL: 135.5656
Epoch 0180 | Beta: 1.00 | Loss: 173.7394 | NLL: 40.0116 | KL: 133.7278
Epoch 0190 | Beta: 1.00 | Loss: 175.2488 | NLL: 39.4985 | KL: 135.7504
Epoch 0200 | Beta: 1.00 | Loss: 173.7884 | NLL: 41.0764 | KL: 132.7120
Epoch 0210 | Beta: 1.00 | Loss: 174.0541 | NLL: 38.8353 | KL: 135.2188
Epoch 0220 | Beta: 1.00 | Loss: 168.8497 | NLL: 36.3058 | KL: 132.5439
Epoch 0230 | Beta: 1.00 | Loss: 171.7297 | NLL: 38.2414 | KL: 133.4884
Epoch 0240 | Beta: 1.00 | Loss: 170.1091 | NLL: 37.6577 | KL: 132.4514
Epoch 0250 | Beta: 1.00 | Loss: 166.7802 | NLL: 35.1085 | KL: 131.6717
Epoch 0260 | Beta: 1.00 | Loss: 170.9836 | NLL: 37.4117 | KL: 133.5719
Epoch 0270 | Beta: 1.00 | Loss: 168.9642 | NLL: 38.5979 | KL: 130.3663
Epoch 0280 | Beta: 1.00 | Loss: 164.7489 | NLL: 33.8900 | KL: 130.8589
Epoch 0290 | Beta: 1.00 | Loss: 164.6749 | NLL: 34.9469 | KL: 129.7280
Epoch 0300 | Beta: 1.00 | Loss: 162.0263 | NLL: 33.5575 | KL: 128.4688
Epoch 0310 | Beta: 1.00 | Loss: 164.1509 | NLL: 29.6809 | KL: 134.4700
Epoch 0320 | Beta: 1.00 | Loss: 161.4553 | NLL: 31.1105 | KL: 130.3448
Epoch 0330 | Beta: 1.00 | Loss: 162.8098 | NLL: 34.3951 | KL: 128.4147
Epoch 0340 | Beta: 1.00 | Loss: 161.3535 | NLL: 32.2900 | KL: 129.0635
Epoch 0350 | Beta: 1.00 | Loss: 161.1020 | NLL: 33.4133 | KL: 127.6887
Epoch 0360 | Beta: 1.00 | Loss: 159.0599 | NLL: 30.8111 | KL: 128.2488
Epoch 0370 | Beta: 1.00 | Loss: 157.7966 | NLL: 29.4284 | KL: 128.3681
Epoch 0380 | Beta: 1.00 | Loss: 156.1889 | NLL: 28.6924 | KL: 127.4965
Epoch 0390 | Beta: 1.00 | Loss: 158.7629 | NLL: 31.4314 | KL: 127.3315
Epoch 0400 | Beta: 1.00 | Loss: 158.6391 | NLL: 30.2672 | KL: 128.3719
Epoch 0410 | Beta: 1.00 | Loss: 158.0299 | NLL: 31.5626 | KL: 126.4673
Epoch 0420 | Beta: 1.00 | Loss: 159.9445 | NLL: 33.3156 | KL: 126.6289
Epoch 0430 | Beta: 1.00 | Loss: 156.3557 | NLL: 29.6380 | KL: 126.7177
Epoch 0440 | Beta: 1.00 | Loss: 172.0047 | NLL: 45.0396 | KL: 126.9651
Epoch 0450 | Beta: 1.00 | Loss: 154.4947 | NLL: 29.2886 | KL: 125.2062
Epoch 0460 | Beta: 1.00 | Loss: 158.9442 | NLL: 32.7758 | KL: 126.1684
Epoch 0470 | Beta: 1.00 | Loss: 155.6593 | NLL: 29.7045 | KL: 125.9547
Epoch 0480 | Beta: 1.00 | Loss: 154.9095 | NLL: 29.5633 | KL: 125.3461
Epoch 0490 | Beta: 1.00 | Loss: 155.4602 | NLL: 27.6925 | KL: 127.7676
Epoch 0500 | Beta: 1.00 | Loss: 154.0267 | NLL: 27.5847 | KL: 126.4420
Epoch 0510 | Beta: 1.00 | Loss: 153.7012 | NLL: 26.0893 | KL: 127.6119
Epoch 0520 | Beta: 1.00 | Loss: 153.4891 | NLL: 28.9925 | KL: 124.4965
Epoch 0530 | Beta: 1.00 | Loss: 155.8072 | NLL: 27.7440 | KL: 128.0632
Epoch 0540 | Beta: 1.00 | Loss: 151.4139 | NLL: 27.3798 | KL: 124.0341
Epoch 0550 | Beta: 1.00 | Loss: 151.7765 | NLL: 28.2897 | KL: 123.4868
Epoch 0560 | Beta: 1.00 | Loss: 153.8540 | NLL: 26.3887 | KL: 127.4653
Epoch 0570 | Beta: 1.00 | Loss: 157.9213 | NLL: 35.2734 | KL: 122.6479
Epoch 0580 | Beta: 1.00 | Loss: 149.7012 | NLL: 27.5556 | KL: 122.1457
Epoch 0590 | Beta: 1.00 | Loss: 153.3904 | NLL: 27.4846 | KL: 125.9058
Epoch 0600 | Beta: 1.00 | Loss: 154.2415 | NLL: 29.6231 | KL: 124.6184
Epoch 0610 | Beta: 1.00 | Loss: 150.5719 | NLL: 25.8435 | KL: 124.7284
Epoch 0620 | Beta: 1.00 | Loss: 150.6652 | NLL: 27.2693 | KL: 123.3958
Epoch 0630 | Beta: 1.00 | Loss: 149.8148 | NLL: 26.0851 | KL: 123.7297
Epoch 0640 | Beta: 1.00 | Loss: 151.4746 | NLL: 28.2029 | KL: 123.2717
Epoch 0650 | Beta: 1.00 | Loss: 150.5955 | NLL: 26.8177 | KL: 123.7778
Epoch 0660 | Beta: 1.00 | Loss: 153.2207 | NLL: 28.7597 | KL: 124.4611
Epoch 0670 | Beta: 1.00 | Loss: 147.9680 | NLL: 25.9263 | KL: 122.0417
Epoch 0680 | Beta: 1.00 | Loss: 149.0898 | NLL: 25.9487 | KL: 123.1411
Epoch 0690 | Beta: 1.00 | Loss: 150.2666 | NLL: 27.8146 | KL: 122.4520
Epoch 0700 | Beta: 1.00 | Loss: 150.1241 | NLL: 27.4505 | KL: 122.6736
Epoch 0710 | Beta: 1.00 | Loss: 148.7217 | NLL: 27.8461 | KL: 120.8756
Epoch 0720 | Beta: 1.00 | Loss: 152.5079 | NLL: 30.2255 | KL: 122.2824
Epoch 0730 | Beta: 1.00 | Loss: 149.4631 | NLL: 27.8543 | KL: 121.6087
Epoch 0740 | Beta: 1.00 | Loss: 152.6605 | NLL: 30.2101 | KL: 122.4504
Epoch 0750 | Beta: 1.00 | Loss: 152.6414 | NLL: 28.4811 | KL: 124.1603
Epoch 0760 | Beta: 1.00 | Loss: 149.2904 | NLL: 25.7192 | KL: 123.5711
Epoch 0770 | Beta: 1.00 | Loss: 148.2249 | NLL: 26.3866 | KL: 121.8383
Epoch 0780 | Beta: 1.00 | Loss: 146.3064 | NLL: 25.7961 | KL: 120.5103
Epoch 0790 | Beta: 1.00 | Loss: 148.5701 | NLL: 26.3725 | KL: 122.1975
Epoch 0800 | Beta: 1.00 | Loss: 148.8111 | NLL: 28.2632 | KL: 120.5479
Epoch 0810 | Beta: 1.00 | Loss: 150.8108 | NLL: 25.8338 | KL: 124.9769
Epoch 0820 | Beta: 1.00 | Loss: 147.7632 | NLL: 25.7238 | KL: 122.0394
Epoch 0830 | Beta: 1.00 | Loss: 150.9451 | NLL: 30.4210 | KL: 120.5240
Epoch 0840 | Beta: 1.00 | Loss: 162.1629 | NLL: 43.1183 | KL: 119.0446
Epoch 0850 | Beta: 1.00 | Loss: 147.7513 | NLL: 27.0947 | KL: 120.6566
Epoch 0860 | Beta: 1.00 | Loss: 146.6569 | NLL: 25.8092 | KL: 120.8478
Epoch 0870 | Beta: 1.00 | Loss: 148.2658 | NLL: 26.2047 | KL: 122.0611
Epoch 0880 | Beta: 1.00 | Loss: 146.4381 | NLL: 25.2661 | KL: 121.1720
Epoch 0890 | Beta: 1.00 | Loss: 143.7882 | NLL: 25.2032 | KL: 118.5850
Epoch 0900 | Beta: 1.00 | Loss: 147.4482 | NLL: 25.9211 | KL: 121.5270
Epoch 0910 | Beta: 1.00 | Loss: 157.4122 | NLL: 34.7320 | KL: 122.6802
Epoch 0920 | Beta: 1.00 | Loss: 145.8824 | NLL: 27.4205 | KL: 118.4619
Epoch 0930 | Beta: 1.00 | Loss: 147.8114 | NLL: 26.9939 | KL: 120.8174
Epoch 0940 | Beta: 1.00 | Loss: 148.8841 | NLL: 25.3437 | KL: 123.5404
Epoch 0950 | Beta: 1.00 | Loss: 145.6668 | NLL: 26.2819 | KL: 119.3849
Epoch 0960 | Beta: 1.00 | Loss: 146.2950 | NLL: 26.1811 | KL: 120.1140
Epoch 0970 | Beta: 1.00 | Loss: 148.3153 | NLL: 27.6647 | KL: 120.6506
Epoch 0980 | Beta: 1.00 | Loss: 143.9428 | NLL: 23.4754 | KL: 120.4674
Epoch 0990 | Beta: 1.00 | Loss: 143.8050 | NLL: 25.1058 | KL: 118.6993
Epoch 1000 | Beta: 1.00 | Loss: 147.0201 | NLL: 28.4562 | KL: 118.5639
Correlation Heatmap saved to paper_plots\run_20260103_150606/latent_heatmap.png

>>> Generating 1000 Monte Carlo Scenarios for VaR...

--- Kupiec POF Test ---
Totale Giorni: 1099
Violazioni Attese: 55.0
Violazioni Osservate: 33
Frequenza Osservata: 0.0300 (Target: 0.0500)
LR Statistic: 10.7038 | P-Value: 0.0011
RISULTATO: RIGETTO H0. Il modello NON è calibrato correttamente.

--- Christoffersen Conditional Coverage Test ---
Transizioni: n00=1035, n01=30, n10=30, n11=3
LR Independence: 2.8860 (p-value: 0.0894)
LR Conditional Coverage (CC): 13.5898 | P-Value CC: 0.0011
RISULTATO: RIGETTO H0. Il modello fallisce il test condizionale.
Grafico regimi salvato in 'paper_plots\run_20260103_150606/var_regimes_plot.png'

>>> Analysis Complete.
Risolto il problema di nidificazione delle directory.
Attualmente la directory per i plot è: paper_plots\run_20260103_154523
>>> Risultati di questa esecuzione salvati in: paper_plots\run_20260103_154523

==================================================
CONFIGURAZIONE ESPERIMENTO
==================================================
seq_length: 30
latent_dim: 10
hidden_dim: 20
batch_size: 150
epochs: 1000
annealing_epochs: 100
learning_rate: 0.001
l2_reg: 0.0
data_path: dataset/log_returns.csv
plot_dir: paper_plots\run_20260103_154523
device: cpu
seed: 42
train_split: 0.7
dropout_rate: 0.1
free_bits: 2.0
gradient_clip: 2.5
==================================================

>>> 1. Loading Dataset...
--------------------------------------------------
Data Analysis Start Date: 2014-09-18
Data Analysis End Date:   2024-12-31
--------------------------------------------------
>>> 2. Starting Training Loop...
Epoch 0010 | Beta: 0.09 | Loss: 159.2600 | NLL: 148.6173 | KL: 118.2523
